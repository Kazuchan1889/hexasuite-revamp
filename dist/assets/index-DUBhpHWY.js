import{r as d,a as oa,u as lt,R as dt,b as At,L as Nt,O as la,c as da,d as fe,N as br,B as ca}from"./react-vendor-BAzt4owN.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();var yr={exports:{}},ct={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ma=d,ga=Symbol.for("react.element"),xa=Symbol.for("react.fragment"),ua=Object.prototype.hasOwnProperty,ha=ma.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,pa={key:!0,ref:!0,__self:!0,__source:!0};function fr(t,r,s){var i,n={},a=null,l=null;s!==void 0&&(a=""+s),r.key!==void 0&&(a=""+r.key),r.ref!==void 0&&(l=r.ref);for(i in r)ua.call(r,i)&&!pa.hasOwnProperty(i)&&(n[i]=r[i]);if(t&&t.defaultProps)for(i in r=t.defaultProps,r)n[i]===void 0&&(n[i]=r[i]);return{$$typeof:ga,type:t,key:a,ref:l,props:n,_owner:ha.current}}ct.Fragment=xa;ct.jsx=fr;ct.jsxs=fr;yr.exports=ct;var e=yr.exports,kr,Xt=oa;kr=Xt.createRoot,Xt.hydrateRoot;function jr(t,r){return function(){return t.apply(r,arguments)}}const{toString:ba}=Object.prototype,{getPrototypeOf:Pt}=Object,{iterator:mt,toStringTag:vr}=Symbol,gt=(t=>r=>{const s=ba.call(r);return t[s]||(t[s]=s.slice(8,-1).toLowerCase())})(Object.create(null)),Pe=t=>(t=t.toLowerCase(),r=>gt(r)===t),xt=t=>r=>typeof r===t,{isArray:Fe}=Array,Be=xt("undefined");function qe(t){return t!==null&&!Be(t)&&t.constructor!==null&&!Be(t.constructor)&&Ce(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const wr=Pe("ArrayBuffer");function ya(t){let r;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?r=ArrayBuffer.isView(t):r=t&&t.buffer&&wr(t.buffer),r}const fa=xt("string"),Ce=xt("function"),Nr=xt("number"),We=t=>t!==null&&typeof t=="object",ka=t=>t===!0||t===!1,Ze=t=>{if(gt(t)!=="object")return!1;const r=Pt(t);return(r===null||r===Object.prototype||Object.getPrototypeOf(r)===null)&&!(vr in t)&&!(mt in t)},ja=t=>{if(!We(t)||qe(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},va=Pe("Date"),wa=Pe("File"),Na=Pe("Blob"),$a=Pe("FileList"),Sa=t=>We(t)&&Ce(t.pipe),Ia=t=>{let r;return t&&(typeof FormData=="function"&&t instanceof FormData||Ce(t.append)&&((r=gt(t))==="formdata"||r==="object"&&Ce(t.toString)&&t.toString()==="[object FormData]"))},Ca=Pe("URLSearchParams"),[La,Aa,Pa,Da]=["ReadableStream","Request","Response","Headers"].map(Pe),Ta=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _e(t,r,{allOwnKeys:s=!1}={}){if(t===null||typeof t>"u")return;let i,n;if(typeof t!="object"&&(t=[t]),Fe(t))for(i=0,n=t.length;i<n;i++)r.call(null,t[i],i,t);else{if(qe(t))return;const a=s?Object.getOwnPropertyNames(t):Object.keys(t),l=a.length;let m;for(i=0;i<l;i++)m=a[i],r.call(null,t[m],m,t)}}function $r(t,r){if(qe(t))return null;r=r.toLowerCase();const s=Object.keys(t);let i=s.length,n;for(;i-- >0;)if(n=s[i],r===n.toLowerCase())return n;return null}const Te=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Sr=t=>!Be(t)&&t!==Te;function $t(){const{caseless:t,skipUndefined:r}=Sr(this)&&this||{},s={},i=(n,a)=>{const l=t&&$r(s,a)||a;Ze(s[l])&&Ze(n)?s[l]=$t(s[l],n):Ze(n)?s[l]=$t({},n):Fe(n)?s[l]=n.slice():(!r||!Be(n))&&(s[l]=n)};for(let n=0,a=arguments.length;n<a;n++)arguments[n]&&_e(arguments[n],i);return s}const Ra=(t,r,s,{allOwnKeys:i}={})=>(_e(r,(n,a)=>{s&&Ce(n)?t[a]=jr(n,s):t[a]=n},{allOwnKeys:i}),t),Ea=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Ma=(t,r,s,i)=>{t.prototype=Object.create(r.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:r.prototype}),s&&Object.assign(t.prototype,s)},Ba=(t,r,s,i)=>{let n,a,l;const m={};if(r=r||{},t==null)return r;do{for(n=Object.getOwnPropertyNames(t),a=n.length;a-- >0;)l=n[a],(!i||i(l,t,r))&&!m[l]&&(r[l]=t[l],m[l]=!0);t=s!==!1&&Pt(t)}while(t&&(!s||s(t,r))&&t!==Object.prototype);return r},Fa=(t,r,s)=>{t=String(t),(s===void 0||s>t.length)&&(s=t.length),s-=r.length;const i=t.indexOf(r,s);return i!==-1&&i===s},Oa=t=>{if(!t)return null;if(Fe(t))return t;let r=t.length;if(!Nr(r))return null;const s=new Array(r);for(;r-- >0;)s[r]=t[r];return s},Ua=(t=>r=>t&&r instanceof t)(typeof Uint8Array<"u"&&Pt(Uint8Array)),za=(t,r)=>{const i=(t&&t[mt]).call(t);let n;for(;(n=i.next())&&!n.done;){const a=n.value;r.call(t,a[0],a[1])}},Ka=(t,r)=>{let s;const i=[];for(;(s=t.exec(r))!==null;)i.push(s);return i},Ha=Pe("HTMLFormElement"),qa=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(s,i,n){return i.toUpperCase()+n}),Zt=(({hasOwnProperty:t})=>(r,s)=>t.call(r,s))(Object.prototype),Wa=Pe("RegExp"),Ir=(t,r)=>{const s=Object.getOwnPropertyDescriptors(t),i={};_e(s,(n,a)=>{let l;(l=r(n,a,t))!==!1&&(i[a]=l||n)}),Object.defineProperties(t,i)},_a=t=>{Ir(t,(r,s)=>{if(Ce(t)&&["arguments","caller","callee"].indexOf(s)!==-1)return!1;const i=t[s];if(Ce(i)){if(r.enumerable=!1,"writable"in r){r.writable=!1;return}r.set||(r.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")})}})},Va=(t,r)=>{const s={},i=n=>{n.forEach(a=>{s[a]=!0})};return Fe(t)?i(t):i(String(t).split(r)),s},Ja=()=>{},Ga=(t,r)=>t!=null&&Number.isFinite(t=+t)?t:r;function Qa(t){return!!(t&&Ce(t.append)&&t[vr]==="FormData"&&t[mt])}const Ya=t=>{const r=new Array(10),s=(i,n)=>{if(We(i)){if(r.indexOf(i)>=0)return;if(qe(i))return i;if(!("toJSON"in i)){r[n]=i;const a=Fe(i)?[]:{};return _e(i,(l,m)=>{const C=s(l,n+1);!Be(C)&&(a[m]=C)}),r[n]=void 0,a}}return i};return s(t,0)},Xa=Pe("AsyncFunction"),Za=t=>t&&(We(t)||Ce(t))&&Ce(t.then)&&Ce(t.catch),Cr=((t,r)=>t?setImmediate:r?((s,i)=>(Te.addEventListener("message",({source:n,data:a})=>{n===Te&&a===s&&i.length&&i.shift()()},!1),n=>{i.push(n),Te.postMessage(s,"*")}))(`axios@${Math.random()}`,[]):s=>setTimeout(s))(typeof setImmediate=="function",Ce(Te.postMessage)),es=typeof queueMicrotask<"u"?queueMicrotask.bind(Te):typeof process<"u"&&process.nextTick||Cr,ts=t=>t!=null&&Ce(t[mt]),P={isArray:Fe,isArrayBuffer:wr,isBuffer:qe,isFormData:Ia,isArrayBufferView:ya,isString:fa,isNumber:Nr,isBoolean:ka,isObject:We,isPlainObject:Ze,isEmptyObject:ja,isReadableStream:La,isRequest:Aa,isResponse:Pa,isHeaders:Da,isUndefined:Be,isDate:va,isFile:wa,isBlob:Na,isRegExp:Wa,isFunction:Ce,isStream:Sa,isURLSearchParams:Ca,isTypedArray:Ua,isFileList:$a,forEach:_e,merge:$t,extend:Ra,trim:Ta,stripBOM:Ea,inherits:Ma,toFlatObject:Ba,kindOf:gt,kindOfTest:Pe,endsWith:Fa,toArray:Oa,forEachEntry:za,matchAll:Ka,isHTMLForm:Ha,hasOwnProperty:Zt,hasOwnProp:Zt,reduceDescriptors:Ir,freezeMethods:_a,toObjectSet:Va,toCamelCase:qa,noop:Ja,toFiniteNumber:Ga,findKey:$r,global:Te,isContextDefined:Sr,isSpecCompliantForm:Qa,toJSONObject:Ya,isAsyncFn:Xa,isThenable:Za,setImmediate:Cr,asap:es,isIterable:ts};function xe(t,r,s,i,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",r&&(this.code=r),s&&(this.config=s),i&&(this.request=i),n&&(this.response=n,this.status=n.status?n.status:null)}P.inherits(xe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:P.toJSONObject(this.config),code:this.code,status:this.status}}});const Lr=xe.prototype,Ar={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Ar[t]={value:t}});Object.defineProperties(xe,Ar);Object.defineProperty(Lr,"isAxiosError",{value:!0});xe.from=(t,r,s,i,n,a)=>{const l=Object.create(Lr);P.toFlatObject(t,l,function(y){return y!==Error.prototype},b=>b!=="isAxiosError");const m=t&&t.message?t.message:"Error",C=r==null&&t?t.code:r;return xe.call(l,m,C,s,i,n),t&&l.cause==null&&Object.defineProperty(l,"cause",{value:t,configurable:!0}),l.name=t&&t.name||"Error",a&&Object.assign(l,a),l};const rs=null;function St(t){return P.isPlainObject(t)||P.isArray(t)}function Pr(t){return P.endsWith(t,"[]")?t.slice(0,-2):t}function er(t,r,s){return t?t.concat(r).map(function(n,a){return n=Pr(n),!s&&a?"["+n+"]":n}).join(s?".":""):r}function as(t){return P.isArray(t)&&!t.some(St)}const ss=P.toFlatObject(P,{},null,function(r){return/^is[A-Z]/.test(r)});function ut(t,r,s){if(!P.isObject(t))throw new TypeError("target must be an object");r=r||new FormData,s=P.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(L,v){return!P.isUndefined(v[L])});const i=s.metaTokens,n=s.visitor||y,a=s.dots,l=s.indexes,C=(s.Blob||typeof Blob<"u"&&Blob)&&P.isSpecCompliantForm(r);if(!P.isFunction(n))throw new TypeError("visitor must be a function");function b(c){if(c===null)return"";if(P.isDate(c))return c.toISOString();if(P.isBoolean(c))return c.toString();if(!C&&P.isBlob(c))throw new xe("Blob is not supported. Use a Buffer instead.");return P.isArrayBuffer(c)||P.isTypedArray(c)?C&&typeof Blob=="function"?new Blob([c]):Buffer.from(c):c}function y(c,L,v){let w=c;if(c&&!v&&typeof c=="object"){if(P.endsWith(L,"{}"))L=i?L:L.slice(0,-2),c=JSON.stringify(c);else if(P.isArray(c)&&as(c)||(P.isFileList(c)||P.endsWith(L,"[]"))&&(w=P.toArray(c)))return L=Pr(L),w.forEach(function(W,Q){!(P.isUndefined(W)||W===null)&&r.append(l===!0?er([L],Q,a):l===null?L:L+"[]",b(W))}),!1}return St(c)?!0:(r.append(er(v,L,a),b(c)),!1)}const j=[],S=Object.assign(ss,{defaultVisitor:y,convertValue:b,isVisitable:St});function D(c,L){if(!P.isUndefined(c)){if(j.indexOf(c)!==-1)throw Error("Circular reference detected in "+L.join("."));j.push(c),P.forEach(c,function(w,I){(!(P.isUndefined(w)||w===null)&&n.call(r,w,P.isString(I)?I.trim():I,L,S))===!0&&D(w,L?L.concat(I):[I])}),j.pop()}}if(!P.isObject(t))throw new TypeError("data must be an object");return D(t),r}function tr(t){const r={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return r[i]})}function Dt(t,r){this._pairs=[],t&&ut(t,this,r)}const Dr=Dt.prototype;Dr.append=function(r,s){this._pairs.push([r,s])};Dr.toString=function(r){const s=r?function(i){return r.call(this,i,tr)}:tr;return this._pairs.map(function(n){return s(n[0])+"="+s(n[1])},"").join("&")};function ns(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Tr(t,r,s){if(!r)return t;const i=s&&s.encode||ns;P.isFunction(s)&&(s={serialize:s});const n=s&&s.serialize;let a;if(n?a=n(r,s):a=P.isURLSearchParams(r)?r.toString():new Dt(r,s).toString(i),a){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class rr{constructor(){this.handlers=[]}use(r,s,i){return this.handlers.push({fulfilled:r,rejected:s,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(r){this.handlers[r]&&(this.handlers[r]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(r){P.forEach(this.handlers,function(i){i!==null&&r(i)})}}const Rr={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},is=typeof URLSearchParams<"u"?URLSearchParams:Dt,os=typeof FormData<"u"?FormData:null,ls=typeof Blob<"u"?Blob:null,ds={isBrowser:!0,classes:{URLSearchParams:is,FormData:os,Blob:ls},protocols:["http","https","file","blob","url","data"]},Tt=typeof window<"u"&&typeof document<"u",It=typeof navigator=="object"&&navigator||void 0,cs=Tt&&(!It||["ReactNative","NativeScript","NS"].indexOf(It.product)<0),ms=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",gs=Tt&&window.location.href||"http://localhost",xs=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Tt,hasStandardBrowserEnv:cs,hasStandardBrowserWebWorkerEnv:ms,navigator:It,origin:gs},Symbol.toStringTag,{value:"Module"})),Ie={...xs,...ds};function us(t,r){return ut(t,new Ie.classes.URLSearchParams,{visitor:function(s,i,n,a){return Ie.isNode&&P.isBuffer(s)?(this.append(i,s.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...r})}function hs(t){return P.matchAll(/\w+|\[(\w*)]/g,t).map(r=>r[0]==="[]"?"":r[1]||r[0])}function ps(t){const r={},s=Object.keys(t);let i;const n=s.length;let a;for(i=0;i<n;i++)a=s[i],r[a]=t[a];return r}function Er(t){function r(s,i,n,a){let l=s[a++];if(l==="__proto__")return!0;const m=Number.isFinite(+l),C=a>=s.length;return l=!l&&P.isArray(n)?n.length:l,C?(P.hasOwnProp(n,l)?n[l]=[n[l],i]:n[l]=i,!m):((!n[l]||!P.isObject(n[l]))&&(n[l]=[]),r(s,i,n[l],a)&&P.isArray(n[l])&&(n[l]=ps(n[l])),!m)}if(P.isFormData(t)&&P.isFunction(t.entries)){const s={};return P.forEachEntry(t,(i,n)=>{r(hs(i),n,s,0)}),s}return null}function bs(t,r,s){if(P.isString(t))try{return(r||JSON.parse)(t),P.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(s||JSON.stringify)(t)}const Ve={transitional:Rr,adapter:["xhr","http","fetch"],transformRequest:[function(r,s){const i=s.getContentType()||"",n=i.indexOf("application/json")>-1,a=P.isObject(r);if(a&&P.isHTMLForm(r)&&(r=new FormData(r)),P.isFormData(r))return n?JSON.stringify(Er(r)):r;if(P.isArrayBuffer(r)||P.isBuffer(r)||P.isStream(r)||P.isFile(r)||P.isBlob(r)||P.isReadableStream(r))return r;if(P.isArrayBufferView(r))return r.buffer;if(P.isURLSearchParams(r))return s.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),r.toString();let m;if(a){if(i.indexOf("application/x-www-form-urlencoded")>-1)return us(r,this.formSerializer).toString();if((m=P.isFileList(r))||i.indexOf("multipart/form-data")>-1){const C=this.env&&this.env.FormData;return ut(m?{"files[]":r}:r,C&&new C,this.formSerializer)}}return a||n?(s.setContentType("application/json",!1),bs(r)):r}],transformResponse:[function(r){const s=this.transitional||Ve.transitional,i=s&&s.forcedJSONParsing,n=this.responseType==="json";if(P.isResponse(r)||P.isReadableStream(r))return r;if(r&&P.isString(r)&&(i&&!this.responseType||n)){const l=!(s&&s.silentJSONParsing)&&n;try{return JSON.parse(r,this.parseReviver)}catch(m){if(l)throw m.name==="SyntaxError"?xe.from(m,xe.ERR_BAD_RESPONSE,this,null,this.response):m}}return r}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ie.classes.FormData,Blob:Ie.classes.Blob},validateStatus:function(r){return r>=200&&r<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};P.forEach(["delete","get","head","post","put","patch"],t=>{Ve.headers[t]={}});const ys=P.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),fs=t=>{const r={};let s,i,n;return t&&t.split(`
`).forEach(function(l){n=l.indexOf(":"),s=l.substring(0,n).trim().toLowerCase(),i=l.substring(n+1).trim(),!(!s||r[s]&&ys[s])&&(s==="set-cookie"?r[s]?r[s].push(i):r[s]=[i]:r[s]=r[s]?r[s]+", "+i:i)}),r},ar=Symbol("internals");function Ke(t){return t&&String(t).trim().toLowerCase()}function et(t){return t===!1||t==null?t:P.isArray(t)?t.map(et):String(t)}function ks(t){const r=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=s.exec(t);)r[i[1]]=i[2];return r}const js=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function ft(t,r,s,i,n){if(P.isFunction(i))return i.call(this,r,s);if(n&&(r=s),!!P.isString(r)){if(P.isString(i))return r.indexOf(i)!==-1;if(P.isRegExp(i))return i.test(r)}}function vs(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(r,s,i)=>s.toUpperCase()+i)}function ws(t,r){const s=P.toCamelCase(" "+r);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+s,{value:function(n,a,l){return this[i].call(this,r,n,a,l)},configurable:!0})})}let Le=class{constructor(r){r&&this.set(r)}set(r,s,i){const n=this;function a(m,C,b){const y=Ke(C);if(!y)throw new Error("header name must be a non-empty string");const j=P.findKey(n,y);(!j||n[j]===void 0||b===!0||b===void 0&&n[j]!==!1)&&(n[j||C]=et(m))}const l=(m,C)=>P.forEach(m,(b,y)=>a(b,y,C));if(P.isPlainObject(r)||r instanceof this.constructor)l(r,s);else if(P.isString(r)&&(r=r.trim())&&!js(r))l(fs(r),s);else if(P.isObject(r)&&P.isIterable(r)){let m={},C,b;for(const y of r){if(!P.isArray(y))throw TypeError("Object iterator must return a key-value pair");m[b=y[0]]=(C=m[b])?P.isArray(C)?[...C,y[1]]:[C,y[1]]:y[1]}l(m,s)}else r!=null&&a(s,r,i);return this}get(r,s){if(r=Ke(r),r){const i=P.findKey(this,r);if(i){const n=this[i];if(!s)return n;if(s===!0)return ks(n);if(P.isFunction(s))return s.call(this,n,i);if(P.isRegExp(s))return s.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(r,s){if(r=Ke(r),r){const i=P.findKey(this,r);return!!(i&&this[i]!==void 0&&(!s||ft(this,this[i],i,s)))}return!1}delete(r,s){const i=this;let n=!1;function a(l){if(l=Ke(l),l){const m=P.findKey(i,l);m&&(!s||ft(i,i[m],m,s))&&(delete i[m],n=!0)}}return P.isArray(r)?r.forEach(a):a(r),n}clear(r){const s=Object.keys(this);let i=s.length,n=!1;for(;i--;){const a=s[i];(!r||ft(this,this[a],a,r,!0))&&(delete this[a],n=!0)}return n}normalize(r){const s=this,i={};return P.forEach(this,(n,a)=>{const l=P.findKey(i,a);if(l){s[l]=et(n),delete s[a];return}const m=r?vs(a):String(a).trim();m!==a&&delete s[a],s[m]=et(n),i[m]=!0}),this}concat(...r){return this.constructor.concat(this,...r)}toJSON(r){const s=Object.create(null);return P.forEach(this,(i,n)=>{i!=null&&i!==!1&&(s[n]=r&&P.isArray(i)?i.join(", "):i)}),s}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([r,s])=>r+": "+s).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(r){return r instanceof this?r:new this(r)}static concat(r,...s){const i=new this(r);return s.forEach(n=>i.set(n)),i}static accessor(r){const i=(this[ar]=this[ar]={accessors:{}}).accessors,n=this.prototype;function a(l){const m=Ke(l);i[m]||(ws(n,l),i[m]=!0)}return P.isArray(r)?r.forEach(a):a(r),this}};Le.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);P.reduceDescriptors(Le.prototype,({value:t},r)=>{let s=r[0].toUpperCase()+r.slice(1);return{get:()=>t,set(i){this[s]=i}}});P.freezeMethods(Le);function kt(t,r){const s=this||Ve,i=r||s,n=Le.from(i.headers);let a=i.data;return P.forEach(t,function(m){a=m.call(s,a,n.normalize(),r?r.status:void 0)}),n.normalize(),a}function Mr(t){return!!(t&&t.__CANCEL__)}function Oe(t,r,s){xe.call(this,t??"canceled",xe.ERR_CANCELED,r,s),this.name="CanceledError"}P.inherits(Oe,xe,{__CANCEL__:!0});function Br(t,r,s){const i=s.config.validateStatus;!s.status||!i||i(s.status)?t(s):r(new xe("Request failed with status code "+s.status,[xe.ERR_BAD_REQUEST,xe.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s))}function Ns(t){const r=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return r&&r[1]||""}function $s(t,r){t=t||10;const s=new Array(t),i=new Array(t);let n=0,a=0,l;return r=r!==void 0?r:1e3,function(C){const b=Date.now(),y=i[a];l||(l=b),s[n]=C,i[n]=b;let j=a,S=0;for(;j!==n;)S+=s[j++],j=j%t;if(n=(n+1)%t,n===a&&(a=(a+1)%t),b-l<r)return;const D=y&&b-y;return D?Math.round(S*1e3/D):void 0}}function Ss(t,r){let s=0,i=1e3/r,n,a;const l=(b,y=Date.now())=>{s=y,n=null,a&&(clearTimeout(a),a=null),t(...b)};return[(...b)=>{const y=Date.now(),j=y-s;j>=i?l(b,y):(n=b,a||(a=setTimeout(()=>{a=null,l(n)},i-j)))},()=>n&&l(n)]}const rt=(t,r,s=3)=>{let i=0;const n=$s(50,250);return Ss(a=>{const l=a.loaded,m=a.lengthComputable?a.total:void 0,C=l-i,b=n(C),y=l<=m;i=l;const j={loaded:l,total:m,progress:m?l/m:void 0,bytes:C,rate:b||void 0,estimated:b&&m&&y?(m-l)/b:void 0,event:a,lengthComputable:m!=null,[r?"download":"upload"]:!0};t(j)},s)},sr=(t,r)=>{const s=t!=null;return[i=>r[0]({lengthComputable:s,total:t,loaded:i}),r[1]]},nr=t=>(...r)=>P.asap(()=>t(...r)),Is=Ie.hasStandardBrowserEnv?((t,r)=>s=>(s=new URL(s,Ie.origin),t.protocol===s.protocol&&t.host===s.host&&(r||t.port===s.port)))(new URL(Ie.origin),Ie.navigator&&/(msie|trident)/i.test(Ie.navigator.userAgent)):()=>!0,Cs=Ie.hasStandardBrowserEnv?{write(t,r,s,i,n,a,l){if(typeof document>"u")return;const m=[`${t}=${encodeURIComponent(r)}`];P.isNumber(s)&&m.push(`expires=${new Date(s).toUTCString()}`),P.isString(i)&&m.push(`path=${i}`),P.isString(n)&&m.push(`domain=${n}`),a===!0&&m.push("secure"),P.isString(l)&&m.push(`SameSite=${l}`),document.cookie=m.join("; ")},read(t){if(typeof document>"u")return null;const r=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return r?decodeURIComponent(r[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Ls(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function As(t,r){return r?t.replace(/\/?\/$/,"")+"/"+r.replace(/^\/+/,""):t}function Fr(t,r,s){let i=!Ls(r);return t&&(i||s==!1)?As(t,r):r}const ir=t=>t instanceof Le?{...t}:t;function Ee(t,r){r=r||{};const s={};function i(b,y,j,S){return P.isPlainObject(b)&&P.isPlainObject(y)?P.merge.call({caseless:S},b,y):P.isPlainObject(y)?P.merge({},y):P.isArray(y)?y.slice():y}function n(b,y,j,S){if(P.isUndefined(y)){if(!P.isUndefined(b))return i(void 0,b,j,S)}else return i(b,y,j,S)}function a(b,y){if(!P.isUndefined(y))return i(void 0,y)}function l(b,y){if(P.isUndefined(y)){if(!P.isUndefined(b))return i(void 0,b)}else return i(void 0,y)}function m(b,y,j){if(j in r)return i(b,y);if(j in t)return i(void 0,b)}const C={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:m,headers:(b,y,j)=>n(ir(b),ir(y),j,!0)};return P.forEach(Object.keys({...t,...r}),function(y){const j=C[y]||n,S=j(t[y],r[y],y);P.isUndefined(S)&&j!==m||(s[y]=S)}),s}const Or=t=>{const r=Ee({},t);let{data:s,withXSRFToken:i,xsrfHeaderName:n,xsrfCookieName:a,headers:l,auth:m}=r;if(r.headers=l=Le.from(l),r.url=Tr(Fr(r.baseURL,r.url,r.allowAbsoluteUrls),t.params,t.paramsSerializer),m&&l.set("Authorization","Basic "+btoa((m.username||"")+":"+(m.password?unescape(encodeURIComponent(m.password)):""))),P.isFormData(s)){if(Ie.hasStandardBrowserEnv||Ie.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if(P.isFunction(s.getHeaders)){const C=s.getHeaders(),b=["content-type","content-length"];Object.entries(C).forEach(([y,j])=>{b.includes(y.toLowerCase())&&l.set(y,j)})}}if(Ie.hasStandardBrowserEnv&&(i&&P.isFunction(i)&&(i=i(r)),i||i!==!1&&Is(r.url))){const C=n&&a&&Cs.read(a);C&&l.set(n,C)}return r},Ps=typeof XMLHttpRequest<"u",Ds=Ps&&function(t){return new Promise(function(s,i){const n=Or(t);let a=n.data;const l=Le.from(n.headers).normalize();let{responseType:m,onUploadProgress:C,onDownloadProgress:b}=n,y,j,S,D,c;function L(){D&&D(),c&&c(),n.cancelToken&&n.cancelToken.unsubscribe(y),n.signal&&n.signal.removeEventListener("abort",y)}let v=new XMLHttpRequest;v.open(n.method.toUpperCase(),n.url,!0),v.timeout=n.timeout;function w(){if(!v)return;const W=Le.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),N={data:!m||m==="text"||m==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:W,config:t,request:v};Br(function(g){s(g),L()},function(g){i(g),L()},N),v=null}"onloadend"in v?v.onloadend=w:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(w)},v.onabort=function(){v&&(i(new xe("Request aborted",xe.ECONNABORTED,t,v)),v=null)},v.onerror=function(Q){const N=Q&&Q.message?Q.message:"Network Error",k=new xe(N,xe.ERR_NETWORK,t,v);k.event=Q||null,i(k),v=null},v.ontimeout=function(){let Q=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const N=n.transitional||Rr;n.timeoutErrorMessage&&(Q=n.timeoutErrorMessage),i(new xe(Q,N.clarifyTimeoutError?xe.ETIMEDOUT:xe.ECONNABORTED,t,v)),v=null},a===void 0&&l.setContentType(null),"setRequestHeader"in v&&P.forEach(l.toJSON(),function(Q,N){v.setRequestHeader(N,Q)}),P.isUndefined(n.withCredentials)||(v.withCredentials=!!n.withCredentials),m&&m!=="json"&&(v.responseType=n.responseType),b&&([S,c]=rt(b,!0),v.addEventListener("progress",S)),C&&v.upload&&([j,D]=rt(C),v.upload.addEventListener("progress",j),v.upload.addEventListener("loadend",D)),(n.cancelToken||n.signal)&&(y=W=>{v&&(i(!W||W.type?new Oe(null,t,v):W),v.abort(),v=null)},n.cancelToken&&n.cancelToken.subscribe(y),n.signal&&(n.signal.aborted?y():n.signal.addEventListener("abort",y)));const I=Ns(n.url);if(I&&Ie.protocols.indexOf(I)===-1){i(new xe("Unsupported protocol "+I+":",xe.ERR_BAD_REQUEST,t));return}v.send(a||null)})},Ts=(t,r)=>{const{length:s}=t=t?t.filter(Boolean):[];if(r||s){let i=new AbortController,n;const a=function(b){if(!n){n=!0,m();const y=b instanceof Error?b:this.reason;i.abort(y instanceof xe?y:new Oe(y instanceof Error?y.message:y))}};let l=r&&setTimeout(()=>{l=null,a(new xe(`timeout ${r} of ms exceeded`,xe.ETIMEDOUT))},r);const m=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(b=>{b.unsubscribe?b.unsubscribe(a):b.removeEventListener("abort",a)}),t=null)};t.forEach(b=>b.addEventListener("abort",a));const{signal:C}=i;return C.unsubscribe=()=>P.asap(m),C}},Rs=function*(t,r){let s=t.byteLength;if(s<r){yield t;return}let i=0,n;for(;i<s;)n=i+r,yield t.slice(i,n),i=n},Es=async function*(t,r){for await(const s of Ms(t))yield*Rs(s,r)},Ms=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const r=t.getReader();try{for(;;){const{done:s,value:i}=await r.read();if(s)break;yield i}}finally{await r.cancel()}},or=(t,r,s,i)=>{const n=Es(t,r);let a=0,l,m=C=>{l||(l=!0,i&&i(C))};return new ReadableStream({async pull(C){try{const{done:b,value:y}=await n.next();if(b){m(),C.close();return}let j=y.byteLength;if(s){let S=a+=j;s(S)}C.enqueue(new Uint8Array(y))}catch(b){throw m(b),b}},cancel(C){return m(C),n.return()}},{highWaterMark:2})},lr=64*1024,{isFunction:Ye}=P,Bs=(({Request:t,Response:r})=>({Request:t,Response:r}))(P.global),{ReadableStream:dr,TextEncoder:cr}=P.global,mr=(t,...r)=>{try{return!!t(...r)}catch{return!1}},Fs=t=>{t=P.merge.call({skipUndefined:!0},Bs,t);const{fetch:r,Request:s,Response:i}=t,n=r?Ye(r):typeof fetch=="function",a=Ye(s),l=Ye(i);if(!n)return!1;const m=n&&Ye(dr),C=n&&(typeof cr=="function"?(c=>L=>c.encode(L))(new cr):async c=>new Uint8Array(await new s(c).arrayBuffer())),b=a&&m&&mr(()=>{let c=!1;const L=new s(Ie.origin,{body:new dr,method:"POST",get duplex(){return c=!0,"half"}}).headers.has("Content-Type");return c&&!L}),y=l&&m&&mr(()=>P.isReadableStream(new i("").body)),j={stream:y&&(c=>c.body)};n&&["text","arrayBuffer","blob","formData","stream"].forEach(c=>{!j[c]&&(j[c]=(L,v)=>{let w=L&&L[c];if(w)return w.call(L);throw new xe(`Response type '${c}' is not supported`,xe.ERR_NOT_SUPPORT,v)})});const S=async c=>{if(c==null)return 0;if(P.isBlob(c))return c.size;if(P.isSpecCompliantForm(c))return(await new s(Ie.origin,{method:"POST",body:c}).arrayBuffer()).byteLength;if(P.isArrayBufferView(c)||P.isArrayBuffer(c))return c.byteLength;if(P.isURLSearchParams(c)&&(c=c+""),P.isString(c))return(await C(c)).byteLength},D=async(c,L)=>{const v=P.toFiniteNumber(c.getContentLength());return v??S(L)};return async c=>{let{url:L,method:v,data:w,signal:I,cancelToken:W,timeout:Q,onDownloadProgress:N,onUploadProgress:k,responseType:g,headers:u,withCredentials:H="same-origin",fetchOptions:f}=Or(c),o=r||fetch;g=g?(g+"").toLowerCase():"text";let B=Ts([I,W&&W.toAbortSignal()],Q),ee=null;const M=B&&B.unsubscribe&&(()=>{B.unsubscribe()});let _;try{if(k&&b&&v!=="get"&&v!=="head"&&(_=await D(u,w))!==0){let p=new s(L,{method:"POST",body:w,duplex:"half"}),F;if(P.isFormData(w)&&(F=p.headers.get("content-type"))&&u.setContentType(F),p.body){const[h,E]=sr(_,rt(nr(k)));w=or(p.body,lr,h,E)}}P.isString(H)||(H=H?"include":"omit");const T=a&&"credentials"in s.prototype,Y={...f,signal:B,method:v.toUpperCase(),headers:u.normalize().toJSON(),body:w,duplex:"half",credentials:T?H:void 0};ee=a&&new s(L,Y);let oe=await(a?o(ee,f):o(L,Y));const $=y&&(g==="stream"||g==="response");if(y&&(N||$&&M)){const p={};["status","statusText","headers"].forEach(z=>{p[z]=oe[z]});const F=P.toFiniteNumber(oe.headers.get("content-length")),[h,E]=N&&sr(F,rt(nr(N),!0))||[];oe=new i(or(oe.body,lr,h,()=>{E&&E(),M&&M()}),p)}g=g||"text";let X=await j[P.findKey(j,g)||"text"](oe,c);return!$&&M&&M(),await new Promise((p,F)=>{Br(p,F,{data:X,headers:Le.from(oe.headers),status:oe.status,statusText:oe.statusText,config:c,request:ee})})}catch(T){throw M&&M(),T&&T.name==="TypeError"&&/Load failed|fetch/i.test(T.message)?Object.assign(new xe("Network Error",xe.ERR_NETWORK,c,ee),{cause:T.cause||T}):xe.from(T,T&&T.code,c,ee)}}},Os=new Map,Ur=t=>{let r=t&&t.env||{};const{fetch:s,Request:i,Response:n}=r,a=[i,n,s];let l=a.length,m=l,C,b,y=Os;for(;m--;)C=a[m],b=y.get(C),b===void 0&&y.set(C,b=m?new Map:Fs(r)),y=b;return b};Ur();const Rt={http:rs,xhr:Ds,fetch:{get:Ur}};P.forEach(Rt,(t,r)=>{if(t){try{Object.defineProperty(t,"name",{value:r})}catch{}Object.defineProperty(t,"adapterName",{value:r})}});const gr=t=>`- ${t}`,Us=t=>P.isFunction(t)||t===null||t===!1;function zs(t,r){t=P.isArray(t)?t:[t];const{length:s}=t;let i,n;const a={};for(let l=0;l<s;l++){i=t[l];let m;if(n=i,!Us(i)&&(n=Rt[(m=String(i)).toLowerCase()],n===void 0))throw new xe(`Unknown adapter '${m}'`);if(n&&(P.isFunction(n)||(n=n.get(r))))break;a[m||"#"+l]=n}if(!n){const l=Object.entries(a).map(([C,b])=>`adapter ${C} `+(b===!1?"is not supported by the environment":"is not available in the build"));let m=s?l.length>1?`since :
`+l.map(gr).join(`
`):" "+gr(l[0]):"as no adapter specified";throw new xe("There is no suitable adapter to dispatch the request "+m,"ERR_NOT_SUPPORT")}return n}const zr={getAdapter:zs,adapters:Rt};function jt(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Oe(null,t)}function xr(t){return jt(t),t.headers=Le.from(t.headers),t.data=kt.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),zr.getAdapter(t.adapter||Ve.adapter,t)(t).then(function(i){return jt(t),i.data=kt.call(t,t.transformResponse,i),i.headers=Le.from(i.headers),i},function(i){return Mr(i)||(jt(t),i&&i.response&&(i.response.data=kt.call(t,t.transformResponse,i.response),i.response.headers=Le.from(i.response.headers))),Promise.reject(i)})}const Kr="1.13.2",ht={};["object","boolean","number","function","string","symbol"].forEach((t,r)=>{ht[t]=function(i){return typeof i===t||"a"+(r<1?"n ":" ")+t}});const ur={};ht.transitional=function(r,s,i){function n(a,l){return"[Axios v"+Kr+"] Transitional option '"+a+"'"+l+(i?". "+i:"")}return(a,l,m)=>{if(r===!1)throw new xe(n(l," has been removed"+(s?" in "+s:"")),xe.ERR_DEPRECATED);return s&&!ur[l]&&(ur[l]=!0,console.warn(n(l," has been deprecated since v"+s+" and will be removed in the near future"))),r?r(a,l,m):!0}};ht.spelling=function(r){return(s,i)=>(console.warn(`${i} is likely a misspelling of ${r}`),!0)};function Ks(t,r,s){if(typeof t!="object")throw new xe("options must be an object",xe.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let n=i.length;for(;n-- >0;){const a=i[n],l=r[a];if(l){const m=t[a],C=m===void 0||l(m,a,t);if(C!==!0)throw new xe("option "+a+" must be "+C,xe.ERR_BAD_OPTION_VALUE);continue}if(s!==!0)throw new xe("Unknown option "+a,xe.ERR_BAD_OPTION)}}const tt={assertOptions:Ks,validators:ht},De=tt.validators;let Re=class{constructor(r){this.defaults=r||{},this.interceptors={request:new rr,response:new rr}}async request(r,s){try{return await this._request(r,s)}catch(i){if(i instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const a=n.stack?n.stack.replace(/^.+\n/,""):"";try{i.stack?a&&!String(i.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+a):i.stack=a}catch{}}throw i}}_request(r,s){typeof r=="string"?(s=s||{},s.url=r):s=r||{},s=Ee(this.defaults,s);const{transitional:i,paramsSerializer:n,headers:a}=s;i!==void 0&&tt.assertOptions(i,{silentJSONParsing:De.transitional(De.boolean),forcedJSONParsing:De.transitional(De.boolean),clarifyTimeoutError:De.transitional(De.boolean)},!1),n!=null&&(P.isFunction(n)?s.paramsSerializer={serialize:n}:tt.assertOptions(n,{encode:De.function,serialize:De.function},!0)),s.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?s.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:s.allowAbsoluteUrls=!0),tt.assertOptions(s,{baseUrl:De.spelling("baseURL"),withXsrfToken:De.spelling("withXSRFToken")},!0),s.method=(s.method||this.defaults.method||"get").toLowerCase();let l=a&&P.merge(a.common,a[s.method]);a&&P.forEach(["delete","get","head","post","put","patch","common"],c=>{delete a[c]}),s.headers=Le.concat(l,a);const m=[];let C=!0;this.interceptors.request.forEach(function(L){typeof L.runWhen=="function"&&L.runWhen(s)===!1||(C=C&&L.synchronous,m.unshift(L.fulfilled,L.rejected))});const b=[];this.interceptors.response.forEach(function(L){b.push(L.fulfilled,L.rejected)});let y,j=0,S;if(!C){const c=[xr.bind(this),void 0];for(c.unshift(...m),c.push(...b),S=c.length,y=Promise.resolve(s);j<S;)y=y.then(c[j++],c[j++]);return y}S=m.length;let D=s;for(;j<S;){const c=m[j++],L=m[j++];try{D=c(D)}catch(v){L.call(this,v);break}}try{y=xr.call(this,D)}catch(c){return Promise.reject(c)}for(j=0,S=b.length;j<S;)y=y.then(b[j++],b[j++]);return y}getUri(r){r=Ee(this.defaults,r);const s=Fr(r.baseURL,r.url,r.allowAbsoluteUrls);return Tr(s,r.params,r.paramsSerializer)}};P.forEach(["delete","get","head","options"],function(r){Re.prototype[r]=function(s,i){return this.request(Ee(i||{},{method:r,url:s,data:(i||{}).data}))}});P.forEach(["post","put","patch"],function(r){function s(i){return function(a,l,m){return this.request(Ee(m||{},{method:r,headers:i?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Re.prototype[r]=s(),Re.prototype[r+"Form"]=s(!0)});let Hs=class Hr{constructor(r){if(typeof r!="function")throw new TypeError("executor must be a function.");let s;this.promise=new Promise(function(a){s=a});const i=this;this.promise.then(n=>{if(!i._listeners)return;let a=i._listeners.length;for(;a-- >0;)i._listeners[a](n);i._listeners=null}),this.promise.then=n=>{let a;const l=new Promise(m=>{i.subscribe(m),a=m}).then(n);return l.cancel=function(){i.unsubscribe(a)},l},r(function(a,l,m){i.reason||(i.reason=new Oe(a,l,m),s(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]}unsubscribe(r){if(!this._listeners)return;const s=this._listeners.indexOf(r);s!==-1&&this._listeners.splice(s,1)}toAbortSignal(){const r=new AbortController,s=i=>{r.abort(i)};return this.subscribe(s),r.signal.unsubscribe=()=>this.unsubscribe(s),r.signal}static source(){let r;return{token:new Hr(function(n){r=n}),cancel:r}}};function qs(t){return function(s){return t.apply(null,s)}}function Ws(t){return P.isObject(t)&&t.isAxiosError===!0}const Ct={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Ct).forEach(([t,r])=>{Ct[r]=t});function qr(t){const r=new Re(t),s=jr(Re.prototype.request,r);return P.extend(s,Re.prototype,r,{allOwnKeys:!0}),P.extend(s,r,null,{allOwnKeys:!0}),s.create=function(n){return qr(Ee(t,n))},s}const R=qr(Ve);R.Axios=Re;R.CanceledError=Oe;R.CancelToken=Hs;R.isCancel=Mr;R.VERSION=Kr;R.toFormData=ut;R.AxiosError=xe;R.Cancel=R.CanceledError;R.all=function(r){return Promise.all(r)};R.spread=qs;R.isAxiosError=Ws;R.mergeConfig=Ee;R.AxiosHeaders=Le;R.formToJSON=t=>Er(P.isHTMLForm(t)?new FormData(t):t);R.getAdapter=zr.getAdapter;R.HttpStatusCode=Ct;R.default=R;const{Axios:mi,AxiosError:gi,CanceledError:xi,isCancel:ui,CancelToken:hi,VERSION:pi,all:bi,Cancel:yi,isAxiosError:fi,spread:ki,toFormData:ji,AxiosHeaders:vi,HttpStatusCode:wi,formToJSON:Ni,getAdapter:$i,mergeConfig:Si}=R,Wr=d.createContext();function _s({children:t}){const[r,s]=d.useState(()=>localStorage.getItem("theme")||"light");d.useEffect(()=>{const n=document.documentElement;r==="dark"?n.classList.add("dark"):n.classList.remove("dark"),localStorage.setItem("theme",r)},[r]);function i(){s(n=>n==="light"?"dark":"light")}return e.jsx(Wr.Provider,{value:{theme:r,toggleTheme:i,setTheme:s},children:t})}function Ne(){const t=d.useContext(Wr);if(!t)throw new Error("useTheme must be used within ThemeProvider");return t}const U="http://localhost:4000",ke=(t="")=>{if(!t)return"";if(t.startsWith("http://")||t.startsWith("https://"))return t;const r=U.endsWith("/")?U.slice(0,-1):U,s=t.startsWith("/")?t:`/${t}`;return`${r}${s}`},_r="/assets/IconP-BIabAmhf.png",Vs=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),Js=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),Gs=()=>e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),Qs=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.29 3.29m13.42 13.42l-3.29-3.29M3 3l18 18"})});function Ys(){const[t,r]=d.useState(""),[s,i]=d.useState(""),[n,a]=d.useState(!1),[l,m]=d.useState(""),[C,b]=d.useState(!1),[y,j]=d.useState(0),S=lt(),D=["https://media.istockphoto.com/id/1352594706/photo/empty-open-plan-office-at-night-with-neon-lights.jpg?s=612x612&w=0&k=20&c=h2DCiR6b64wFNqehFN4o9jCnkdH16ulTKRdX72xI_xY=","https://media.istockphoto.com/id/2072805054/photo/futuristic-office-with-asian-mature-businesswoman-using-digital-tablet-in-office.jpg?s=612x612&w=0&k=20&c=jExStLwhnjq2z9MTSlaHxpboRTceE2B2f2HRB8wklOA=","https://images.stockcake.com/public/5/e/e/5ee6ad54-6795-46bc-b041-da0c8d04a917_large/future-office-meeting-stockcake.jpg"],c=[{title:"Maximizing Productivity,",subtitle:"Optimizing Performance",description:"Kelola Kehadiran dengan Efisiensi Maksimal"},{title:"Innovative Solutions,",subtitle:"Digital Transformation",description:"Teknologi HR Terdepan untuk Masa Depan"},{title:"Building Teams,",subtitle:"Creating Success",description:"Kolaborasi yang Membangun Keberhasilan Bersama"}];d.useEffect(()=>{const v=setInterval(()=>{j(w=>(w+1)%D.length)},5e3);return()=>clearInterval(v)},[D.length]),d.useEffect(()=>{async function v(){const w=localStorage.getItem("token");if(w)try{const I=await R.get(`${U}/api/users/me`,{headers:{Authorization:`Bearer ${w}`}});I.data?(localStorage.setItem("user",JSON.stringify(I.data)),S("/")):(localStorage.removeItem("token"),localStorage.removeItem("user"))}catch(I){console.error("Token validation failed:",I),localStorage.removeItem("token"),localStorage.removeItem("user")}}v()},[S]);const L=async v=>{var w,I;v.preventDefault(),m(""),b(!0);try{const W=await R.post(`${U}/api/auth/login`,{username:t,password:s});localStorage.setItem("token",W.data.token),localStorage.setItem("user",JSON.stringify(W.data.user)),S("/")}catch(W){m(((I=(w=W.response)==null?void 0:w.data)==null?void 0:I.message)||"Login gagal. Periksa kembali username dan password Anda.")}finally{b(!1)}};return e.jsxs("div",{className:"min-h-screen flex",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-1/2 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0",children:D.map((v,w)=>e.jsx("div",{className:`absolute inset-0 transition-opacity duration-1000 ease-in-out ${w===y?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${v})`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:e.jsx("div",{className:"absolute inset-0",style:{background:"linear-gradient(135deg, rgba(38, 53, 93, 0.7) 0%, rgba(26, 36, 64, 0.6) 50%, rgba(175, 71, 210, 0.7) 100%)"}})},w))}),e.jsx("div",{className:"absolute top-8 left-8 z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shadow-lg overflow-hidden",style:{background:"rgba(255, 255, 255, 0.2)",backdropFilter:"blur(10px)"},children:e.jsx("img",{src:_r,alt:"Logo",className:"w-full h-full object-contain"})}),e.jsx("span",{className:"text-white text-2xl font-bold",children:"Hexa Suite"})]})}),e.jsxs("div",{className:"absolute bottom-16 left-8 z-10 transition-all duration-1000 ease-in-out",children:[e.jsxs("h2",{className:"text-white text-4xl font-bold mb-2 leading-tight",children:[e.jsx("span",{className:"inline-block",children:c[y].title}),e.jsx("br",{}),e.jsx("span",{className:"inline-block",children:c[y].subtitle})]}),e.jsx("p",{className:"text-white/80 text-lg mt-4",children:c[y].description})]}),e.jsx("div",{className:"absolute bottom-8 left-8 z-10 flex gap-2",children:D.map((v,w)=>e.jsx("button",{onClick:()=>j(w),className:`w-2 h-2 rounded-full transition-all duration-300 ${w===y?"bg-white w-6":"bg-white/40 hover:bg-white/60"}`,"aria-label":`Go to slide ${w+1}`},w))})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",style:{background:"#26355D"},children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-3",children:"Login"}),e.jsxs("p",{className:"text-white/70",children:["Belum punya akun?"," ",e.jsx("span",{className:"text-white underline cursor-pointer hover:opacity-80",children:"Hubungi admin"})]})]}),l&&e.jsx("div",{className:"mb-6 p-4 rounded-xl border-2 animate-fade-in",style:{background:"rgba(239, 68, 68, 0.1)",borderColor:"rgba(239, 68, 68, 0.3)"},children:e.jsx("p",{className:"text-sm text-red-300 font-medium",children:l})}),e.jsxs("form",{onSubmit:L,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white/90 mb-2",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",style:{color:"#AF47D2"},children:e.jsx(Vs,{})}),e.jsx("input",{type:"text",value:t,onChange:v=>r(v.target.value),placeholder:"Masukkan username",className:"w-full pl-12 pr-4 py-3.5 rounded-xl border-2 transition-all duration-200 text-white placeholder:text-white/50",style:{background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(175, 71, 210, 0.3)",outline:"none"},onFocus:v=>v.target.style.borderColor="#AF47D2",onBlur:v=>v.target.style.borderColor="rgba(175, 71, 210, 0.3)",required:!0,autoComplete:"username"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white/90 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",style:{color:"#AF47D2"},children:e.jsx(Js,{})}),e.jsx("input",{type:n?"text":"password",value:s,onChange:v=>i(v.target.value),placeholder:"Masukkan password",className:"w-full pl-12 pr-12 py-3.5 rounded-xl border-2 transition-all duration-200 text-white placeholder:text-white/50",style:{background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(175, 71, 210, 0.3)",outline:"none"},onFocus:v=>v.target.style.borderColor="#AF47D2",onBlur:v=>v.target.style.borderColor="rgba(175, 71, 210, 0.3)",required:!0,autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>a(!n),className:"absolute inset-y-0 right-0 pr-4 flex items-center cursor-pointer",style:{color:"#AF47D2"},children:n?e.jsx(Qs,{}):e.jsx(Gs,{})})]})]}),e.jsx("button",{type:"submit",disabled:C,className:"w-full py-4 text-base font-bold text-white rounded-xl shadow-lg hover:shadow-xl transform hover:scale-[1.02] transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",style:{background:"#AF47D2"},children:C?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Memproses..."]}):"Masuk ke Sistem"})]})]})}),e.jsx("style",{children:`
        @keyframes fade-in {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in {
          animation: fade-in 0.3s ease-out;
        }
      `})]})}const Xs=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),Zs=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),en=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),tn=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),rn=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),an=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})}),sn=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})});function He({icon:t,title:r,value:s,iconBg:i,onClick:n,theme:a}){return e.jsx("div",{className:`rounded-xl p-3 sm:p-4 lg:p-6 shadow-sm border hover:shadow-md transition-all ${n?"cursor-pointer":""} ${a==="dark"?"bg-gray-800 border-gray-700 hover:border-gray-600":"bg-white border-gray-100 hover:border-gray-200"}`,onClick:n,children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 lg:gap-4",children:[e.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 lg:w-12 lg:h-12 rounded-full flex items-center justify-center flex-shrink-0 ${i}`,children:e.jsx(t,{className:"w-4 h-4 sm:w-5 sm:h-5 lg:w-6 lg:h-6 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs sm:text-sm mb-1 transition-colors truncate ${a==="dark"?"text-gray-400":"text-gray-600"}`,children:r}),e.jsx("p",{className:`text-lg sm:text-xl lg:text-2xl font-bold transition-colors truncate ${a==="dark"?"text-white":""}`,style:a==="light"?{color:"#26355D"}:{},children:s.toLocaleString()})]})]})})}function nn(){const t=lt(),{theme:r}=Ne(),[s,i]=d.useState({hadir:0,izin:0,sakit:0,alfa:0}),[n,a]=d.useState([]),[l,m]=d.useState([]),[C,b]=d.useState(0),[y,j]=d.useState(0),[S,D]=d.useState(0),[c,L]=d.useState(0),[v,w]=d.useState([]),[I,W]=d.useState([]),[Q,N]=d.useState([]),[k,g]=d.useState(null),[u,H]=d.useState(0),[f,o]=d.useState([]),[B,ee]=d.useState([]),[M,_]=d.useState("monthly"),[T,Y]=d.useState(!0),[oe,$]=d.useState(!1),[X,p]=d.useState(null),F=dt.useRef(null),[h,E]=d.useState(null);d.useEffect(()=>{z()},[]),d.useEffect(()=>{T||A()},[M]),d.useEffect(()=>(F.current&&h&&(F.current.srcObject&&F.current.srcObject.getTracks().forEach(se=>se.stop()),F.current.srcObject=h,F.current.play().catch(O=>{console.error("Error playing video:",O)})),()=>{F.current&&F.current.srcObject&&(F.current.srcObject.getTracks().forEach(se=>se.stop()),F.current.srcObject=null)}),[h,oe]);async function z(){Y(!0);try{await Promise.all([Z(),ne(),re(),V(),me(),J(),A()])}catch(O){console.error("Error loading data:",O)}finally{Y(!1)}}async function Z(){try{const O=localStorage.getItem("token"),ie=(await R.get(`${U}/api/attendances`,{headers:{Authorization:`Bearer ${O}`}})).data;i({hadir:ie.filter(he=>he.status==="Hadir").length,izin:ie.filter(he=>he.status==="Izin").length,sakit:ie.filter(he=>he.status==="Sakit").length,alfa:ie.filter(he=>he.status==="Alfa").length}),j(ie.length),N(ie.slice(-6).reverse())}catch(O){console.error("Error loading attendance:",O)}}async function ne(){try{const O=localStorage.getItem("token"),ie=(await R.get(`${U}/api/users`,{headers:{Authorization:`Bearer ${O}`}})).data.filter(he=>he.role==="user");m(ie),a(ie.slice(0,4)),b(ie.length)}catch(O){console.error("Error loading users:",O)}}async function re(){try{const O=localStorage.getItem("token"),se=await R.get(`${U}/api/daily-reports`,{headers:{Authorization:`Bearer ${O}`}});D(se.data.length),W(se.data.slice(0,5).reverse())}catch(O){console.error("Error loading daily reports:",O)}}async function V(){try{const O=localStorage.getItem("token"),se=await R.get(`${U}/api/payroll`,{headers:{Authorization:`Bearer ${O}`}});L(se.data.length||0)}catch(O){console.error("Error loading payrolls:",O),L(0)}}async function me(){try{const O=localStorage.getItem("token"),[se,ie,he]=await Promise.all([R.get(`${U}/api/leaverequests/pending`,{headers:{Authorization:`Bearer ${O}`}}).catch(()=>({data:[]})),R.get(`${U}/api/attendance-status-requests/pending`,{headers:{Authorization:`Bearer ${O}`}}).catch(()=>({data:[]})),R.get(`${U}/api/daily-report-edit-requests/pending`,{headers:{Authorization:`Bearer ${O}`}}).catch(()=>({data:[]}))]),pe=[...(se.data||[]).map(ve=>({...ve,type:"Leave",title:ve.type==="Cuti"?"Cuti Request":"Izin Request"})),...(ie.data||[]).map(ve=>({...ve,type:"Attendance",title:"Attendance Status Request"})),...(he.data||[]).map(ve=>({...ve,type:"DailyReport",title:"Daily Report Edit Request"}))];w(pe.slice(0,3))}catch(O){console.error("Error loading pending requests:",O)}}async function A(){var O,se;try{const ie=localStorage.getItem("token"),he=new Date;let pe=[];if(M==="monthly"){const ve=`${he.getFullYear()}-${String(he.getMonth()+1).padStart(2,"0")}`,$e=await R.get(`${U}/api/performance?mode=monthly&month=${ve}`,{headers:{Authorization:`Bearer ${ie}`}});if($e.data&&$e.data.users){H($e.data.averageKPI||0);const Se=$e.data.users.slice(0,4).map(we=>({name:we.name,tasks:Math.round(we.kpiScore),userId:we.userId}));o(Se)}for(let Se=5;Se>=0;Se--){const we=new Date(he.getFullYear(),he.getMonth()-Se,1),Me=`${we.getFullYear()}-${String(we.getMonth()+1).padStart(2,"0")}`;try{const Je=await R.get(`${U}/api/performance?mode=monthly&month=${Me}`,{headers:{Authorization:`Bearer ${ie}`}});pe.push({label:we.toLocaleDateString("en-US",{month:"short"}),value:((O=Je.data)==null?void 0:O.averageKPI)||0})}catch{pe.push({label:we.toLocaleDateString("en-US",{month:"short"}),value:0})}}}else{const ve=he.getFullYear(),$e=await R.get(`${U}/api/performance?mode=yearly&year=${ve}`,{headers:{Authorization:`Bearer ${ie}`}});if($e.data&&$e.data.users){H($e.data.averageKPI||0);const Se=$e.data.users.slice(0,4).map(we=>({name:we.name,tasks:Math.round(we.kpiScore),userId:we.userId}));o(Se)}for(let Se=5;Se>=0;Se--){const we=ve-Se;try{const Me=await R.get(`${U}/api/performance?mode=yearly&year=${we}`,{headers:{Authorization:`Bearer ${ie}`}});pe.push({label:we.toString(),value:((se=Me.data)==null?void 0:se.averageKPI)||0})}catch{pe.push({label:we.toString(),value:0})}}}ee(pe)}catch(ie){console.error("Error loading KPI:",ie)}}async function J(){try{const O=localStorage.getItem("token"),ie=(await R.get(`${U}/api/attendances/me`,{headers:{Authorization:`Bearer ${O}`}})).data||[],he=new Date().toISOString().slice(0,10),pe=ie.find(ve=>ve.date===he);g(pe||null)}catch(O){console.error("Error loading my attendance:",O)}}async function K(O,se){var ie,he;try{const pe=localStorage.getItem("token"),ve={action:O};se&&(ve.photo=se),await R.post(`${U}/api/attendances/action`,ve,{headers:{Authorization:`Bearer ${pe}`}}),await J(),$(!1),h&&(h.getTracks().forEach($e=>$e.stop()),E(null)),p(null)}catch(pe){alert(((he=(ie=pe.response)==null?void 0:ie.data)==null?void 0:he.message)||"Action failed"),console.error(pe)}}async function ae(O){const se=document.createElement("canvas");se.width=O.videoWidth||640,se.height=O.videoHeight||480,se.getContext("2d").drawImage(O,0,0,se.width,se.height);const he=se.toDataURL("image/jpeg",.8);await K(X,X==="checkin"||X==="checkout"?he:null)}const G=s.hadir+s.izin+s.sakit+s.alfa;G>0&&(s.hadir/G*100).toFixed(2);const ce=s.hadir+s.izin+s.sakit+s.alfa,de=s.hadir,ge=s.izin,ue=s.sakit+s.alfa,Ae=O=>{const se=f.find(ie=>ie.userId===O);return se?se.tasks:0};return T?e.jsx("div",{className:`flex items-center justify-center min-h-screen transition-colors ${r==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#AF47D2"}}),e.jsx("p",{className:`transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("div",{children:e.jsx("h1",{className:`text-2xl sm:text-3xl font-bold transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Dashboard"})}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-5 gap-3 sm:gap-4",children:[e.jsx(He,{icon:Xs,title:"Total Users",value:C,iconBg:"bg-gray-200",onClick:()=>t("/admin/users"),theme:r}),e.jsx(He,{icon:Zs,title:"Total Attendance",value:y,iconBg:"bg-gray-200",onClick:()=>t("/admin/attendance"),theme:r}),e.jsx(He,{icon:en,title:"Pending Requests",value:v.length,iconBg:"bg-gray-200",onClick:()=>t("/admin/leave"),theme:r}),e.jsx(He,{icon:tn,title:"Daily Reports",value:S,iconBg:"bg-gray-200",onClick:()=>t("/admin/daily-report"),theme:r}),e.jsx(He,{icon:rn,title:"Payroll Records",value:c,iconBg:"bg-gray-200",onClick:()=>t("/admin/payroll"),theme:r})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:`rounded-xl p-4 sm:p-6 shadow-sm border transition-colors ${r==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-100"}`,children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-0 mb-4 sm:mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-lg sm:text-xl font-bold transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Average KPI Score"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:`text-2xl sm:text-3xl font-bold transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:u.toFixed(2)}),e.jsx("span",{className:`text-xs sm:text-sm ml-2 transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:"/ 100"})]})]}),e.jsxs("div",{className:"relative w-full sm:w-auto",children:[e.jsxs("select",{value:M,onChange:O=>_(O.target.value),className:`w-full sm:w-auto px-3 sm:px-4 py-2 rounded-lg border text-xs sm:text-sm font-medium appearance-none cursor-pointer focus:outline-none focus:ring-2 focus:ring-purple-200 transition-colors ${r==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-200"}`,style:r==="light"?{color:"#26355D"}:{},children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"yearly",children:"Yearly"})]}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none",children:e.jsx(sn,{className:"w-3 h-3 sm:w-4 sm:h-4 transition-colors text-gray-400"})})]})]}),e.jsx("div",{className:"flex items-end justify-between gap-1 sm:gap-2 h-32 sm:h-48 mt-4 sm:mt-6 overflow-x-auto pb-2",children:B.length>0?B.map((O,se)=>{const ie=Math.max(...B.map(pe=>pe.value),100),he=ie>0?Math.max(10,O.value/ie*100):10;return e.jsxs("div",{className:"flex-1 flex flex-col items-center min-w-[40px] sm:min-w-0",children:[e.jsx("div",{className:"w-full flex items-end justify-center",style:{height:"100%",minHeight:"100px"},children:e.jsx("div",{className:"w-full rounded-t-lg transition-all hover:opacity-80 cursor-pointer",style:{height:`${he}%`,background:"linear-gradient(180deg, #AF47D2 0%, #8B3DB8 100%)",minHeight:"20px"},title:`${O.label}: ${O.value.toFixed(2)}`})}),e.jsx("span",{className:`text-[10px] sm:text-xs mt-2 transition-colors text-center ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:O.label})]},se)}):e.jsx("div",{className:`w-full text-center py-8 transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:"No KPI data available"})}),e.jsxs("div",{className:`mt-6 sm:mt-8 pt-4 sm:pt-6 border-t transition-colors ${r==="dark"?"border-gray-700":"border-gray-100"}`,children:[e.jsx("h3",{className:`text-base sm:text-lg font-semibold mb-3 sm:mb-4 transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Top Performance"}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:f.length>0?f.map((O,se)=>e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center text-white text-xs sm:text-sm font-semibold flex-shrink-0",style:{background:"#AF47D2"},children:O.name.slice(0,1).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`font-medium text-sm sm:text-base truncate transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:O.name}),e.jsxs("p",{className:`text-xs sm:text-sm transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:["KPI Score: ",O.tasks]})]})]},se)):e.jsx("p",{className:`text-xs sm:text-sm transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:"No performance data available"})})]})]}),e.jsxs("div",{className:`rounded-xl p-4 sm:p-6 shadow-sm border transition-colors ${r==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[e.jsx("h2",{className:`text-lg sm:text-xl font-bold transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Employees"}),e.jsx("button",{className:"text-xs sm:text-sm font-medium hover:opacity-80 transition-opacity",style:{color:"#AF47D2"},onClick:()=>t("/admin/users"),children:"See all"})]}),e.jsx("div",{className:"overflow-x-auto -mx-4 sm:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle px-4 sm:px-0",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b transition-colors ${r==="dark"?"border-gray-700":"border-gray-100"}`,children:[e.jsx("th",{className:`text-left py-2 sm:py-3 px-2 sm:px-4 text-xs sm:text-sm font-semibold transition-colors ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:"ID"}),e.jsx("th",{className:`text-left py-2 sm:py-3 px-2 sm:px-4 text-xs sm:text-sm font-semibold transition-colors ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:"Name"}),e.jsx("th",{className:`text-left py-2 sm:py-3 px-2 sm:px-4 text-xs sm:text-sm font-semibold transition-colors hidden sm:table-cell ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:"Role"}),e.jsx("th",{className:`text-left py-2 sm:py-3 px-2 sm:px-4 text-xs sm:text-sm font-semibold transition-colors ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:"Performance"})]})}),e.jsx("tbody",{children:n.length>0?n.map(O=>{const se=Ae(O.id)||0;return e.jsxs("tr",{className:`border-b transition-colors ${r==="dark"?"border-gray-700 hover:bg-gray-700/50":"border-gray-50 hover:bg-gray-50"}`,children:[e.jsx("td",{className:`py-2 sm:py-3 px-2 sm:px-4 text-xs sm:text-sm transition-colors ${r==="dark"?"text-gray-300":""}`,style:r==="light"?{color:"#26355D"}:{},children:e.jsx("span",{className:"truncate block",children:O.employeeId||`EMP${String(O.id).padStart(6,"0")}`})}),e.jsxs("td",{className:"py-2 sm:py-3 px-2 sm:px-4",children:[e.jsx("div",{className:`font-medium text-xs sm:text-sm transition-colors truncate ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:O.name}),e.jsx("div",{className:`text-xs sm:hidden transition-colors ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:O.position||"Employee"})]}),e.jsx("td",{className:`py-2 sm:py-3 px-2 sm:px-4 text-xs sm:text-sm transition-colors hidden sm:table-cell ${r==="dark"?"text-gray-400":"text-gray-600"}`,children:O.position||"Employee"}),e.jsx("td",{className:"py-2 sm:py-3 px-2 sm:px-4",children:e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("div",{className:`flex-1 h-1.5 sm:h-2 rounded-full overflow-hidden transition-colors ${r==="dark"?"bg-gray-700":"bg-gray-100"}`,children:e.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${Math.min(se,100)}%`,background:"#AF47D2"}})}),e.jsxs("span",{className:`text-[10px] sm:text-xs w-8 sm:w-10 text-right transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[se,"%"]}),e.jsx(an,{className:`w-3 h-3 sm:w-4 sm:h-4 transition-colors hidden sm:block ${r==="dark"?"text-gray-500":"text-gray-400"}`})]})})]},O.id)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:`py-8 text-center transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:"No employees found"})})})]})})})]})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"rounded-xl p-4 sm:p-6 shadow-lg",style:{background:"#26355D"},children:[e.jsx("h2",{className:"text-lg sm:text-xl font-bold text-white mb-4 sm:mb-6",children:"Pending Requests"}),e.jsx("div",{className:"space-y-3 sm:space-y-4",children:v.length>0?v.map((O,se)=>{var ie,he,pe;return e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>{O.type==="Leave"?t("/admin/leave"):O.type==="Attendance"?t("/admin/attendance-requests"):O.type==="DailyReport"&&t("/admin/daily-report-edit-requests")},children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-white mt-2 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-white font-medium text-xs sm:text-sm truncate",children:O.title||O.type}),e.jsx("p",{className:"text-xs sm:text-sm text-white/70 mt-1 truncate",children:((ie=O.User)==null?void 0:ie.name)||`User ID: ${O.userId}`}),e.jsx("p",{className:"text-[10px] sm:text-xs text-white/50 mt-1",children:O.startDate?new Date(O.startDate).toLocaleDateString("id-ID"):(he=O.Attendance)!=null&&he.date?new Date(O.Attendance.date).toLocaleDateString("id-ID"):(pe=O.DailyReport)!=null&&pe.date?new Date(O.DailyReport.date).toLocaleDateString("id-ID"):"Today"})]})]},se)}):e.jsx("p",{className:"text-white/70 text-xs sm:text-sm",children:"No pending requests"})}),v.length>0&&e.jsx("button",{className:"mt-4 w-full text-xs sm:text-sm text-white/80 hover:text-white transition-colors text-center",onClick:()=>t("/admin/leave"),children:"See all "})]}),e.jsxs("div",{className:`rounded-xl p-4 sm:p-6 shadow-sm border transition-colors ${r==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-100"}`,children:[e.jsx("h2",{className:`text-lg sm:text-xl font-bold mb-4 sm:mb-6 transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Attendance Status"}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`font-semibold text-sm sm:text-base transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Hadir"}),e.jsxs("span",{className:`text-xs sm:text-sm transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[ce>0?(de/ce*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:`h-1.5 sm:h-2 rounded-full overflow-hidden transition-colors ${r==="dark"?"bg-gray-700":"bg-gray-100"}`,children:e.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${ce>0?de/ce*100:0}%`,background:"#AF47D2"}})}),e.jsxs("p",{className:`text-xs sm:text-sm mt-1 transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[de.toLocaleString()," records"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`font-semibold text-sm sm:text-base transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Izin"}),e.jsxs("span",{className:`text-xs sm:text-sm transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[ce>0?(ge/ce*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:`h-1.5 sm:h-2 rounded-full overflow-hidden transition-colors ${r==="dark"?"bg-gray-700":"bg-gray-100"}`,children:e.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${ce>0?ge/ce*100:0}%`,background:"linear-gradient(90deg, #AF47D2 0%, #8B3DB8 100%)"}})}),e.jsxs("p",{className:`text-xs sm:text-sm mt-1 transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[ge.toLocaleString()," records"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`font-semibold text-sm sm:text-base transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Sakit & Alfa"}),e.jsxs("span",{className:`text-xs sm:text-sm transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[ce>0?(ue/ce*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:`h-1.5 sm:h-2 rounded-full overflow-hidden transition-colors ${r==="dark"?"bg-gray-700":"bg-gray-100"}`,children:e.jsx("div",{className:"h-full rounded-full transition-all",style:{width:`${ce>0?ue/ce*100:0}%`,background:"linear-gradient(90deg, #26355D 0%, #1a2440 100%)"}})}),e.jsxs("p",{className:`text-xs sm:text-sm mt-1 transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[ue.toLocaleString()," records"]})]})]})]}),I.length>0&&e.jsxs("div",{className:`rounded-xl p-4 sm:p-6 shadow-sm border transition-colors ${r==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-100"}`,children:[e.jsx("h2",{className:`text-lg sm:text-xl font-bold mb-4 sm:mb-6 transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:"Recent Reports"}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:I.slice(0,3).map(O=>{var se,ie,he,pe;return e.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",style:{background:"#AF47D2"},children:((ie=(se=O.User)==null?void 0:se.name)==null?void 0:ie.slice(0,1).toUpperCase())||"R"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs sm:text-sm font-medium truncate transition-colors ${r==="dark"?"text-white":""}`,style:r==="light"?{color:"#26355D"}:{},children:((he=O.User)==null?void 0:he.name)||"User"}),e.jsxs("p",{className:`text-[10px] sm:text-xs truncate transition-colors ${r==="dark"?"text-gray-400":"text-gray-500"}`,children:[(pe=O.content)==null?void 0:pe.substring(0,50),"..."]}),e.jsx("p",{className:`text-[10px] sm:text-xs mt-1 transition-colors ${r==="dark"?"text-gray-500":"text-gray-400"}`,children:new Date(O.date).toLocaleDateString("id-ID")})]})]},O.id)})}),e.jsx("button",{className:"mt-4 w-full text-xs sm:text-sm font-medium hover:opacity-80 transition-opacity text-center",style:{color:"#AF47D2"},onClick:()=>t("/admin/daily-report"),children:"See all "})]})]})]}),oe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-3 sm:p-4",children:e.jsxs("div",{className:`rounded-2xl shadow-2xl w-full max-w-md overflow-hidden border transition-colors ${r==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"p-3 sm:p-4",style:{background:"linear-gradient(135deg, #26355D 0%, #AF47D2 100%)"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-white font-bold text-base sm:text-lg",children:X==="checkin"?" Check In":X==="checkout"?" Check Out":" Istirahat"}),e.jsx("button",{onClick:()=>{$(!1),h&&(h.getTracks().forEach(O=>O.stop()),E(null)),p(null)},className:"text-white hover:bg-white/20 rounded-lg p-1.5 sm:p-2 transition-colors",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:`p-3 sm:p-4 transition-colors ${r==="dark"?"bg-gray-800":"bg-white"}`,children:[e.jsx("div",{className:`mb-3 sm:mb-4 rounded-xl overflow-hidden bg-black border-2 sm:border-4 shadow-inner aspect-video transition-colors ${r==="dark"?"border-gray-700":"border-gray-800"}`,children:h?e.jsx("video",{ref:F,autoPlay:!0,playsInline:!0,muted:!0,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"},className:"w-full h-full"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-white",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e.jsx("p",{children:"Memuat kamera..."})]})})}),e.jsxs("div",{className:"flex gap-2 sm:gap-3",children:[e.jsx("button",{onClick:async()=>{const O=F.current||document.querySelector("video");await ae(O)},className:"flex-1 btn btn-primary text-white rounded-xl py-2.5 sm:py-3 text-sm sm:text-base",style:{background:"#AF47D2"},children:X==="checkin"?"Check In":X==="checkout"?"Check Out":"Istirahat"}),e.jsx("button",{onClick:()=>{h&&(h.getTracks().forEach(O=>O.stop()),E(null)),$(!1),p(null)},className:"btn btn-ghost text-sm sm:text-base px-3 sm:px-4",children:"Batal"})]})]})]})})]})}function on(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState({hadir:0,izin:0,sakit:0,alfa:0}),[a,l]=d.useState(null),[m,C]=d.useState(!1),[b,y]=d.useState(null),j=dt.useRef(null),[S,D]=d.useState(null);d.useEffect(()=>{c()},[]);async function c(){try{const I=localStorage.getItem("token"),Q=(await R.get(`${U}/api/attendances/me`,{headers:{Authorization:`Bearer ${I}`}})).data;s(Q.reverse()),n({hadir:Q.filter(g=>g.status==="Hadir").length,izin:Q.filter(g=>g.status==="Izin").length,sakit:Q.filter(g=>g.status==="Sakit").length,alfa:Q.filter(g=>g.status==="Alfa").length});const N=new Date().toISOString().slice(0,10),k=Q.find(g=>g.date===N);l(k||null)}catch(I){console.error(I)}}async function L(I){y(I);try{const W=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1});D(W),C(!0)}catch(W){alert("Camera access denied or not available"),console.error(W)}}async function v(I,W){var Q,N;try{const k=localStorage.getItem("token"),g={action:I};W&&(g.photo=W);const u=await R.post(`${U}/api/attendances/action`,g,{headers:{Authorization:`Bearer ${k}`}});return await c(),C(!1),S&&(S.getTracks().forEach(H=>H.stop()),D(null)),y(null),window.dispatchEvent(new Event("refreshAttendanceStatus")),u.data}catch(k){alert(((N=(Q=k.response)==null?void 0:Q.data)==null?void 0:N.message)||"Action failed"),console.error(k)}}async function w(I){const W=document.createElement("canvas");W.width=I.videoWidth||640,W.height=I.videoHeight||480,W.getContext("2d").drawImage(I,0,0,W.width,W.height);const N=W.toDataURL("image/jpeg",.8);await v(b,b==="checkin"||b==="checkout"?N:null)}return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":""}`,children:["Hi, ",e.jsx("span",{style:{background:"linear-gradient(135deg, #26355D 0%, #AF47D2 100%)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:JSON.parse(localStorage.getItem("user")||"{}").name||"User"})," "]}),e.jsx("p",{className:"transition-colors",style:{color:"#AF47D2"},children:"Ringkasan absensi pribadi Anda"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:`card-strong group cursor-pointer hover:scale-105 transition-all duration-300 ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-green-400 to-emerald-500 flex items-center justify-center shadow-lg shadow-green-500/30",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:i.hadir}),e.jsx("div",{className:"text-sm font-semibold text-green-600",children:"Hadir"})]})]}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Total kehadiran bulan ini"})]}),e.jsxs("div",{className:`card-strong group cursor-pointer hover:scale-105 transition-all duration-300 ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-yellow-400 to-amber-500 flex items-center justify-center shadow-lg shadow-yellow-500/30",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:i.izin}),e.jsx("div",{className:"text-sm font-semibold text-yellow-600",children:"Izin"})]})]}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Total izin bulan ini"})]}),e.jsxs("div",{className:`card-strong group cursor-pointer hover:scale-105 transition-all duration-300 ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-rose-400 to-pink-500 flex items-center justify-center shadow-lg shadow-rose-500/30",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:i.sakit}),e.jsx("div",{className:"text-sm font-semibold text-rose-600",children:"Sakit"})]})]}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Total sakit bulan ini"})]}),e.jsxs("div",{className:`card-strong group cursor-pointer hover:scale-105 transition-all duration-300 ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-slate-500 to-slate-600 flex items-center justify-center shadow-lg shadow-slate-500/30",children:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:i.alfa}),e.jsx("div",{className:"text-sm font-semibold text-slate-600",children:"Alfa"})]})]}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Total alfa bulan ini"})]})]}),e.jsx("div",{className:`card-strong mb-6 border-2 shadow-lg transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":""}`,style:t==="light"?{background:"linear-gradient(135deg, rgba(38, 53, 93, 0.1) 0%, rgba(175, 71, 210, 0.1) 100%)",borderColor:"rgba(175, 71, 210, 0.3)"}:{borderColor:"rgba(175, 71, 210, 0.3)"},children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:`text-xl font-bold mb-1 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Absensi Hari Ini"}),e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:a?e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{children:["CheckIn: ",a.checkIn||"-"]}),a.breakStart&&e.jsx("span",{children:""}),e.jsxs("span",{children:["Break: ",a.breakStart||"-"," - ",a.breakEnd||"-"]}),a.checkOut&&e.jsx("span",{children:""}),e.jsxs("span",{children:["CheckOut: ",a.checkOut||"-"]})]}),!a.checkIn&&a.status!=="Izin"&&a.status!=="Sakit"&&a.status!=="Alfa"&&e.jsx("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800 border border-gray-300",children:"Belum Absen"})}),a.status==="Izin"&&e.jsx("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800 border border-yellow-400",children:"Izin"})}),a.status==="Sakit"&&e.jsx("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-800 border border-red-400",children:"Sakit"})}),a.status==="Alfa"&&e.jsx("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800 border border-gray-400",children:"Alfa"})}),a.status==="Hadir"&&a.checkIn&&a.checkInStatus&&e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-2",children:[e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold ${a.checkInStatus==="early"?"bg-blue-100 text-blue-800 border border-blue-400":a.checkInStatus==="onTime"?"bg-green-100 text-green-800 border border-green-400":a.checkInStatus==="almostLate"?"bg-yellow-100 text-yellow-800 border border-yellow-400":"bg-red-100 text-red-800 border border-red-400"}`,children:a.checkInStatus==="early"?" Come Early":a.checkInStatus==="onTime"?" On Time":a.checkInStatus==="almostLate"?" Almost Late":" Late"}),a.breakLate&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-orange-100 text-orange-800 border border-orange-300",children:" Break Late"}),a.earlyLeave&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 border border-blue-300",children:" Early Leave"})]})]}):e.jsx("span",{children:"Belum melakukan absensi hari ini"})})]}),e.jsx("div",{className:"flex flex-wrap gap-3 justify-center lg:justify-end lg:flex-shrink-0",children:!a||a&&!a.checkIn?e.jsxs("button",{onClick:()=>L("checkin"),className:"text-lg font-bold px-8 py-4 lg:text-base lg:px-6 lg:py-3 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 animate-pulse text-white rounded-xl w-full lg:w-auto",style:{background:"linear-gradient(135deg, #26355D 0%, #AF47D2 100%)"},children:[e.jsxs("svg",{className:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Check In"]}):a&&a.checkIn&&!a.breakStart?e.jsxs("button",{onClick:async()=>{await v("break")},className:"btn btn-primary text-lg font-semibold px-7 py-3 lg:text-base lg:px-5 lg:py-2.5 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 w-full lg:w-auto",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Mulai Istirahat"]}):a&&a.checkIn&&a.breakStart&&!a.breakEnd?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:async()=>{await v("break")},className:"btn btn-primary text-lg font-semibold px-7 py-3 lg:text-base lg:px-5 lg:py-2.5 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 w-full lg:w-auto",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Selesai Istirahat"]}),!a.checkOut&&e.jsxs("button",{onClick:()=>L("checkout"),className:"btn btn-primary text-lg font-semibold px-7 py-3 lg:text-base lg:px-5 lg:py-2.5 shadow-md hover:shadow-lg transform hover:scale-105 transition-all duration-200 opacity-50 cursor-not-allowed w-full lg:w-auto",disabled:!0,children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Check Out (Selesaikan Istirahat Dulu)"]})]}):a&&a.checkIn&&a.breakStart&&a.breakEnd&&!a.checkOut?e.jsxs("button",{onClick:()=>L("checkout"),className:"text-lg font-bold px-8 py-4 lg:text-base lg:px-6 lg:py-3 shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 text-white rounded-xl w-full lg:w-auto",style:{background:"linear-gradient(135deg, #AF47D2 0%, #8B3DB8 100%)"},children:[e.jsx("svg",{className:"w-6 h-6 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Check Out"]}):e.jsxs("button",{disabled:!0,className:"btn btn-ghost opacity-50 cursor-not-allowed text-lg font-semibold px-7 py-3 lg:text-base lg:px-5 lg:py-2.5 w-full lg:w-auto",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Selesai"]})})]})}),m&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/90":"bg-black/80"}`,children:e.jsxs("div",{className:`rounded-2xl shadow-2xl w-full max-w-md overflow-hidden border transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"p-4",style:{background:"linear-gradient(135deg, #26355D 0%, #AF47D2 100%)"},children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-white font-bold text-lg",children:b==="checkin"?" Check In":b==="checkout"?" Check Out":" Istirahat"}),e.jsx("button",{onClick:()=>{C(!1),S&&(S.getTracks().forEach(I=>I.stop()),D(null)),y(null)},className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),e.jsxs("div",{className:`p-4 transition-colors ${t==="dark"?"bg-gray-800":"bg-white"}`,children:[e.jsx("div",{className:`mb-4 rounded-xl overflow-hidden bg-black border-4 shadow-inner transition-colors ${t==="dark"?"border-gray-700":"border-gray-800"}`,children:e.jsx("video",{autoPlay:!0,playsInline:!0,muted:!0,ref:I=>{j.current=I,I&&S&&(I.srcObject=S)},className:"w-full h-auto"})}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:async()=>{const I=j.current||document.querySelector("video");await w(I)},className:"flex-1 btn btn-primary",children:b==="checkin"?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Check In"]}):b==="checkout"?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Check Out"]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Istirahat"]})}),e.jsx("button",{onClick:()=>{S&&(S.getTracks().forEach(I=>I.stop()),D(null)),C(!1),y(null)},className:"btn btn-ghost",children:"Batal"})]})]})]})}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Riwayat Absensi"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[r.length," catatan"]})]}),e.jsxs("div",{className:"space-y-3",children:[r.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Belum ada catatan absensi"})]}),r.map(I=>e.jsx("div",{className:`card transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 hover:border-gray-500":"bg-white border-gray-200 hover:border-indigo-300"}`,children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("div",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:I.date}),I.status==="Izin"&&e.jsx("span",{className:"status-chip status-warning",children:"Izin"}),I.status==="Sakit"&&e.jsx("span",{className:"status-chip status-danger",children:"Sakit"}),I.status==="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Alfa"}),I.status==="Hadir"&&I.checkIn&&I.checkInStatus&&e.jsx("span",{className:`status-chip font-semibold ${I.checkInStatus==="onTime"?"bg-green-100 text-green-800 border-2 border-green-400":I.checkInStatus==="almostLate"?"bg-yellow-100 text-yellow-800 border-2 border-yellow-400":"bg-red-100 text-red-800 border-2 border-red-400"}`,children:I.checkInStatus==="onTime"?" On Time":I.checkInStatus==="almostLate"?" Almost Late":" Late"}),I.status==="Hadir"&&I.checkIn&&!I.checkInStatus&&e.jsx("span",{className:"status-chip status-success",children:"Hadir"}),I.breakLate&&e.jsx("span",{className:"status-chip bg-orange-100 text-orange-800 border border-orange-300 font-medium",children:" Break Late"}),I.earlyLeave&&e.jsx("span",{className:"status-chip bg-blue-100 text-blue-800 border border-blue-300 font-medium",children:" Early Leave"}),!I.checkIn&&I.status!=="Izin"&&I.status!=="Sakit"&&I.status!=="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Belum Absen"})]}),e.jsx("div",{className:`text-sm mb-3 transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"CheckIn: ",I.checkIn||"-"]}),(I.breakStart||I.breakEnd)&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Break: ",I.breakStart||"-"," - ",I.breakEnd||"-"]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"CheckOut: ",I.checkOut||"-"]})]})}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[I.checkInPhotoPath&&e.jsx("a",{href:ke(I.checkInPhotoPath),target:"_blank",rel:"noreferrer",className:"group",children:e.jsx("img",{src:ke(I.checkInPhotoPath),alt:"checkin",className:`w-20 h-20 object-cover rounded-lg border-2 transition-colors shadow-sm ${t==="dark"?"border-gray-600 group-hover:border-purple-500":"border-gray-200 group-hover:border-indigo-400"}`})}),I.breakPhotoPath&&e.jsx("a",{href:ke(I.breakPhotoPath),target:"_blank",rel:"noreferrer",className:"group",children:e.jsx("img",{src:ke(I.breakPhotoPath),alt:"break",className:`w-20 h-20 object-cover rounded-lg border-2 transition-colors shadow-sm ${t==="dark"?"border-gray-600 group-hover:border-purple-500":"border-gray-200 group-hover:border-indigo-400"}`})}),I.checkOutPhotoPath&&e.jsx("a",{href:ke(I.checkOutPhotoPath),target:"_blank",rel:"noreferrer",className:"group",children:e.jsx("img",{src:ke(I.checkOutPhotoPath),alt:"checkout",className:`w-20 h-20 object-cover rounded-lg border-2 transition-colors shadow-sm ${t==="dark"?"border-gray-600 group-hover:border-purple-500":"border-gray-200 group-hover:border-indigo-400"}`})})]}),I.note&&e.jsx("div",{className:`mt-3 text-sm rounded-lg p-2 border transition-colors ${t==="dark"?"text-gray-300 bg-gray-700 border-gray-600":"text-gray-600 bg-gray-50 border-gray-200"}`,children:I.note})]})})},I.id))]})]})]})}function ln(){const t=At(),[r,s]=d.useState(()=>localStorage.getItem("adminUserViewMode")==="true"),[i,n]=d.useState(()=>JSON.parse(localStorage.getItem("user")||"null"));return d.useEffect(()=>{const a=localStorage.getItem("adminUserViewMode")==="true",l=JSON.parse(localStorage.getItem("user")||"null");s(a),n(l)},[t.pathname]),d.useEffect(()=>{const a=()=>{const l=localStorage.getItem("adminUserViewMode")==="true";s(l)};return window.addEventListener("viewModeChanged",a),()=>{window.removeEventListener("viewModeChanged",a)}},[]),i?i.role==="admin"&&!r?e.jsx(nn,{}):e.jsx(on,{}):e.jsx("div",{className:"text-gray-500",children:"Loading..."})}function dn(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState(!1),[a,l]=d.useState(null),[m,C]=d.useState({currentStatus:"",requestedStatus:"",description:""}),[b,y]=d.useState(!1),[j,S]=d.useState(!1),[D,c]=d.useState(null),[L,v]=d.useState("desc"),[w,I]=d.useState("all"),[W,Q]=d.useState([]);d.useEffect(()=>{g(),N()},[]);async function N(){try{const f=localStorage.getItem("token"),o=await R.get(`${U}/api/attendance-status-requests`,{headers:{Authorization:`Bearer ${f}`}});Q(o.data||[])}catch(f){console.error("Error loading user requests:",f)}}function k(f){return W.some(o=>{var ee,M;return o.status!=="Pending"?!1:(((ee=o.Attendance)==null?void 0:ee.date)||((M=o.attendance)==null?void 0:M.date))===f})}async function g(){try{const f=localStorage.getItem("token"),o=await R.get(`${U}/api/attendances/me`,{headers:{Authorization:`Bearer ${f}`}});s(o.data.reverse())}catch(f){console.error(f)}}function u(f){var M;const o=new Date().toISOString().slice(0,10);if(f.date===o&&k(o)){alert("Anda sudah membuat request perubahan status absensi untuk hari ini. Setiap user hanya dapat membuat 1 request per hari. Silakan tunggu admin memproses request Anda.");return}let B="",ee=[];if(f.checkInStatus==="late"?(B="late",ee=[{value:"onTime",label:"On Time"},{value:"almostLate",label:"Almost Late"}]):f.checkInStatus==="almostLate"?(B="almostLate",ee=[{value:"onTime",label:"On Time"}]):f.checkInStatus==="early"?(B="early",ee=[{value:"onTime",label:"On Time"}]):f.checkInStatus==="onTime"?(B="onTime",ee=[{value:"early",label:"Come Early"}]):f.breakLate?(B="breakLate",ee=[{value:"normal",label:"Normal (Hapus Break Late)"}]):f.earlyLeave?(B="earlyLeave",ee=[{value:"onTimeCheckout",label:"On Time Checkout (Hapus Early Leave)"}]):f.checkIn&&f.status==="Hadir"&&(B="general",ee=[{value:"onTime",label:"On Time"},{value:"early",label:"Come Early"}]),!B&&f.checkIn&&(B="general",ee=[{value:"onTime",label:"On Time"},{value:"early",label:"Come Early"}]),!B){alert("Tidak dapat membuat request untuk absensi ini. Pastikan Anda sudah check in.");return}l(f),C({currentStatus:B,requestedStatus:((M=ee[0])==null?void 0:M.value)||"",description:""}),n(!0)}async function H(){var f,o;if(!m.description.trim()){alert("Deskripsi wajib diisi");return}y(!0);try{const B=localStorage.getItem("token");await R.post(`${U}/api/attendance-status-requests`,{attendanceId:a.id,currentStatus:m.currentStatus,requestedStatus:m.requestedStatus,description:m.description},{headers:{Authorization:`Bearer ${B}`}}),alert("Request berhasil dikirim. Admin akan meninjau request Anda."),n(!1),C({currentStatus:"",requestedStatus:"",description:""}),l(null),await g(),await N()}catch(B){console.error(B),alert(((o=(f=B.response)==null?void 0:f.data)==null?void 0:o.message)||"Gagal mengirim request")}finally{y(!1)}}return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Absensi ",e.jsx("span",{className:"gradient-text",children:"Saya"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Riwayat catatan absensi Anda"})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Riwayat Absensi"}),e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:(()=>{let f=r.filter(o=>w==="all"?!0:w==="early"?o.checkInStatus==="early":w==="onTime"?o.checkInStatus==="onTime":w==="almostLate"?o.checkInStatus==="almostLate":w==="late"?o.checkInStatus==="late":w==="hadir"?o.status==="Hadir"&&o.checkIn&&!o.checkInStatus:w==="izin"?o.status==="Izin":w==="sakit"?o.status==="Sakit":w==="alfa"?o.status==="Alfa":w==="breakLate"?o.breakLate===!0:w==="earlyLeave"?o.earlyLeave===!0:w==="belumAbsen"?!o.checkIn&&o.status!=="Izin"&&o.status!=="Sakit"&&o.status!=="Alfa":!0).length;return w!=="all"?`${f} dari ${r.length} catatan`:`${r.length} catatan`})()})]}),e.jsx("div",{className:`mb-6 p-4 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Urutkan Berdasarkan Tanggal"}),e.jsxs("select",{value:L,onChange:f=>v(f.target.value),className:`w-full p-2.5 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"desc",children:"Terbaru  Terlama (Descending)"}),e.jsx("option",{value:"asc",children:"Terlama  Terbaru (Ascending)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Filter Berdasarkan Status"}),e.jsxs("select",{value:w,onChange:f=>I(f.target.value),className:`w-full p-2.5 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"early",children:" Come Early"}),e.jsx("option",{value:"onTime",children:" On Time"}),e.jsx("option",{value:"almostLate",children:" Almost Late"}),e.jsx("option",{value:"late",children:" Late"}),e.jsx("option",{value:"hadir",children:" Hadir (Umum)"}),e.jsx("option",{value:"izin",children:" Izin"}),e.jsx("option",{value:"sakit",children:" Sakit"}),e.jsx("option",{value:"alfa",children:" Alfa"}),e.jsx("option",{value:"breakLate",children:" Break Late"}),e.jsx("option",{value:"earlyLeave",children:" Early Leave"}),e.jsx("option",{value:"belumAbsen",children:" Belum Absen"})]})]})]})}),(()=>{let f=r.filter(o=>w==="all"?!0:w==="early"?o.checkInStatus==="early":w==="onTime"?o.checkInStatus==="onTime":w==="almostLate"?o.checkInStatus==="almostLate":w==="late"?o.checkInStatus==="late":w==="hadir"?o.status==="Hadir"&&o.checkIn&&!o.checkInStatus:w==="izin"?o.status==="Izin":w==="sakit"?o.status==="Sakit":w==="alfa"?o.status==="Alfa":w==="breakLate"?o.breakLate===!0:w==="earlyLeave"?o.earlyLeave===!0:w==="belumAbsen"?!o.checkIn&&o.status!=="Izin"&&o.status!=="Sakit"&&o.status!=="Alfa":!0);return f=[...f].sort((o,B)=>{const ee=new Date(o.date),M=new Date(B.date);return L==="asc"?ee-M:M-ee}),e.jsx("div",{className:"space-y-3",children:f.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:w!=="all"?"Tidak ada data dengan status yang dipilih":"Belum ada catatan absensi"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`text-sm mb-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Menampilkan ",f.length," dari ",r.length," catatan"]}),f.map(o=>e.jsx("div",{className:`card transition-colors cursor-pointer ${t==="dark"?"bg-gray-700 border-gray-600 hover:border-indigo-500":"bg-white border-gray-200 hover:border-indigo-300"}`,onClick:()=>{c(o),S(!0)},children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("div",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:o.date}),o.status==="Izin"&&e.jsx("span",{className:"status-chip status-warning",children:"Izin"}),o.status==="Sakit"&&e.jsx("span",{className:"status-chip status-danger",children:"Sakit"}),o.status==="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Alfa"}),o.status==="Hadir"&&o.checkIn&&o.checkInStatus&&e.jsx("span",{className:`status-chip font-semibold ${o.checkInStatus==="early"?"bg-blue-100 text-blue-800 border-2 border-blue-400":o.checkInStatus==="onTime"?"bg-green-100 text-green-800 border-2 border-green-400":o.checkInStatus==="almostLate"?"bg-yellow-100 text-yellow-800 border-2 border-yellow-400":"bg-red-100 text-red-800 border-2 border-red-400"}`,children:o.checkInStatus==="early"?" Come Early":o.checkInStatus==="onTime"?" On Time":o.checkInStatus==="almostLate"?" Almost Late":" Late"}),o.status==="Hadir"&&o.checkIn&&!o.checkInStatus&&e.jsx("span",{className:"status-chip status-success",children:"Hadir"}),o.breakLate&&e.jsx("span",{className:"status-chip bg-orange-100 text-orange-800 border border-orange-300 font-medium",children:" Break Late"}),o.earlyLeave&&e.jsx("span",{className:"status-chip bg-blue-100 text-blue-800 border border-blue-300 font-medium",children:" Early Leave"}),!o.checkIn&&o.status!=="Izin"&&o.status!=="Sakit"&&o.status!=="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Belum Absen"}),o.checkIn&&(()=>{const B=new Date().toISOString().slice(0,10);return o.date===B&&k(B)?e.jsx("span",{className:"px-3 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 rounded-lg border border-yellow-300",children:"Request Pending"}):e.jsx("button",{onClick:M=>{M.stopPropagation(),u(o)},className:"px-3 py-1 text-xs font-medium bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors",children:"Request Perubahan"})})()]}),e.jsx("div",{className:`text-sm mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"CheckIn: ",o.checkIn||"-"]}),(o.breakStart||o.breakEnd)&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Break: ",o.breakStart||"-"," - ",o.breakEnd||"-"]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"CheckOut: ",o.checkOut||"-"]})]})}),o.note&&e.jsx("div",{className:`text-sm rounded-lg p-2 border transition-colors ${t==="dark"?"text-gray-300 bg-gray-600 border-gray-500":"text-gray-600 bg-gray-50 border-gray-200"}`,children:o.note})]})})},o.id))]})})})()]}),i&&a&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`rounded-xl shadow-2xl p-6 max-w-md w-full transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Request Perubahan Status"}),e.jsx("button",{onClick:()=>{n(!1),C({currentStatus:"",requestedStatus:"",description:""}),l(null)},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Tanggal Absensi"}),e.jsx("div",{className:`p-3 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-300":"bg-gray-50 border-gray-200"}`,children:a.date})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status Saat Ini"}),e.jsx("div",{className:`p-3 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-300":"bg-gray-50 border-gray-200"}`,children:m.currentStatus==="late"?" Late":m.currentStatus==="almostLate"?" Almost Late":m.currentStatus==="early"?" Come Early":m.currentStatus==="onTime"?" On Time":m.currentStatus==="breakLate"?" Break Late":m.currentStatus==="earlyLeave"?" Early Leave":m.currentStatus==="general"?"Hadir":"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Request Status Baru"}),e.jsxs("select",{value:m.requestedStatus,onChange:f=>C({...m,requestedStatus:f.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[m.currentStatus==="late"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"onTime",children:"On Time"}),e.jsx("option",{value:"almostLate",children:"Almost Late"})]}),m.currentStatus==="almostLate"&&e.jsx("option",{value:"onTime",children:"On Time"}),m.currentStatus==="early"&&e.jsx("option",{value:"onTime",children:"On Time"}),m.currentStatus==="onTime"&&e.jsx("option",{value:"early",children:"Come Early"}),m.currentStatus==="breakLate"&&e.jsx("option",{value:"normal",children:"Normal (Hapus Break Late)"}),m.currentStatus==="earlyLeave"&&e.jsx("option",{value:"onTimeCheckout",children:"On Time Checkout (Hapus Early Leave)"}),m.currentStatus==="general"&&e.jsxs(e.Fragment,{children:[e.jsx("option",{value:"onTime",children:"On Time"}),e.jsx("option",{value:"early",children:"Come Early"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Deskripsi/Alasan *"}),e.jsx("textarea",{required:!0,value:m.description,onChange:f=>C({...m,description:f.target.value}),rows:4,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"Jelaskan alasan mengapa status perlu diubah..."}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Deskripsi ini akan dibaca oleh admin untuk meninjau request Anda"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{n(!1),C({currentStatus:"",requestedStatus:"",description:""}),l(null)},className:`px-4 py-2 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{onClick:H,disabled:b||!m.description.trim(),className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Mengirim...":"Kirim Request"})]})]})}),j&&D&&e.jsx("div",{className:`fixed inset-0 flex items-center justify-center z-50 p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black bg-opacity-50"}`,onClick:()=>S(!1),children:e.jsxs("div",{className:`rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{className:`sticky top-0 border-b px-6 py-4 flex items-center justify-between transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Detail Absensi"}),e.jsx("button",{onClick:()=>S(!1),className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:`mb-6 pb-6 border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("h3",{className:`text-xl font-bold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Tanggal: ",D.date]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[D.status==="Izin"&&e.jsx("span",{className:"status-chip status-warning",children:"Izin"}),D.status==="Sakit"&&e.jsx("span",{className:"status-chip status-danger",children:"Sakit"}),D.status==="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Alfa"}),D.status==="Hadir"&&D.checkIn&&D.checkInStatus&&e.jsx("span",{className:`status-chip font-semibold ${D.checkInStatus==="early"?"bg-blue-100 text-blue-800 border-2 border-blue-400":D.checkInStatus==="onTime"?"bg-green-100 text-green-800 border-2 border-green-400":D.checkInStatus==="almostLate"?"bg-yellow-100 text-yellow-800 border-2 border-yellow-400":"bg-red-100 text-red-800 border-2 border-red-400"}`,children:D.checkInStatus==="early"?" Come Early":D.checkInStatus==="onTime"?" On Time":D.checkInStatus==="almostLate"?" Almost Late":" Late"}),D.status==="Hadir"&&D.checkIn&&!D.checkInStatus&&e.jsx("span",{className:"status-chip status-success",children:"Hadir"}),D.breakLate&&e.jsx("span",{className:"status-chip bg-orange-100 text-orange-800 border border-orange-300 font-medium",children:" Break Late"}),D.earlyLeave&&e.jsx("span",{className:"status-chip bg-blue-100 text-blue-800 border border-blue-300 font-medium",children:" Early Leave"}),!D.checkIn&&D.status!=="Izin"&&D.status!=="Sakit"&&D.status!=="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Belum Absen"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Check In"}),e.jsx("div",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:D.checkIn||"-"})]}),(D.breakStart||D.breakEnd)&&e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Break"}),e.jsxs("div",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[D.breakStart||"-"," - ",D.breakEnd||"-"]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Check Out"}),e.jsx("div",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:D.checkOut||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[D.checkInPhotoPath?e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check In"}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:ke(D.checkInPhotoPath),alt:"Check In Photo",className:`w-full rounded-lg border shadow-sm object-cover transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`,onError:f=>{f.target.style.display="none";const o=f.target.parentElement.querySelector(".error-message");o&&(o.style.display="block")}}),e.jsx("div",{className:`error-message hidden text-sm text-center py-4 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Foto tidak tersedia"})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check In"}),e.jsx("div",{className:`text-sm text-center py-8 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Tidak ada foto"})]}),D.checkOutPhotoPath?e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check Out"}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:ke(D.checkOutPhotoPath),alt:"Check Out Photo",className:`w-full rounded-lg border shadow-sm object-cover transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`,onError:f=>{f.target.style.display="none";const o=f.target.parentElement.querySelector(".error-message");o&&(o.style.display="block")}}),e.jsx("div",{className:`error-message hidden text-sm text-center py-4 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Foto tidak tersedia"})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check Out"}),e.jsx("div",{className:`text-sm text-center py-8 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Tidak ada foto"})]})]}),D.note&&e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-blue-900/30 border-blue-700":"bg-blue-50 border-blue-200"}`,children:[e.jsx("div",{className:`text-sm font-medium mb-1 transition-colors ${t==="dark"?"text-blue-200":"text-blue-900"}`,children:"Catatan"}),e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-blue-300":"text-blue-800"}`,children:D.note})]}),(D.checkInStatus==="late"||D.checkInStatus==="almostLate"||D.breakLate||D.earlyLeave||D.checkIn&&D.status==="Hadir")&&e.jsx("div",{className:`mt-6 pt-6 border-t transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:(()=>{const f=new Date().toISOString().slice(0,10);return D.date===f&&k(f)?e.jsxs("div",{className:`p-4 rounded-lg border transition-colors ${t==="dark"?"bg-yellow-900/30 border-yellow-700":"bg-yellow-50 border-yellow-200"}`,children:[e.jsx("div",{className:`text-sm font-medium mb-1 transition-colors ${t==="dark"?"text-yellow-200":"text-yellow-900"}`,children:" Request Pending"}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-yellow-300":"text-yellow-700"}`,children:"Anda sudah membuat request perubahan status absensi untuk hari ini. Setiap user hanya dapat membuat 1 request per hari."})]}):e.jsx("button",{onClick:()=>{S(!1),u(D)},className:"w-full px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium",children:"Request Perubahan Status"})})()})]}),e.jsx("div",{className:`sticky bottom-0 border-t px-6 py-4 flex justify-end transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"}`,children:e.jsx("button",{onClick:()=>S(!1),className:"px-6 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium",children:"Tutup"})})]})})]})}const cn=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),mn=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),gn=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 5v.01M12 12v.01M12 19v.01M12 6a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2zm0 7a1 1 0 110-2 1 1 0 010 2z"})});function xn(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState(!1),[a,l]=d.useState({name:"",username:"",password:"",email:"",employeeId:"",position:"",department:"",division:"",supervisor:"",startDate:"",employmentStatus:"",education:"",educationOther:"",institution:"",degree:"",basicSalary:"",currency:"IDR",leaveQuota:"12",leaveQuotaOther:"",role:"user"}),[m,C]=d.useState(!1),[b,y]=d.useState(null),[j,S]=d.useState(!1),[D,c]=d.useState(!1),[L,v]=d.useState(null),[w,I]=d.useState(!1),[W,Q]=d.useState({});d.useEffect(()=>{N(),k();const o=setInterval(k,3e4),B=()=>{k()};return window.addEventListener("refreshAttendanceStatus",B),()=>{clearInterval(o),window.removeEventListener("refreshAttendanceStatus",B)}},[]);async function N(){n(!0);try{const o=localStorage.getItem("token"),B=await R.get(`${U}/api/users`,{headers:{Authorization:`Bearer ${o}`}});s(B.data)}catch(o){console.error(o),alert("Gagal memuat data user")}n(!1)}async function k(){try{const o=localStorage.getItem("token"),B=new Date().toISOString().slice(0,10),M=(await R.get(`${U}/api/attendances`,{headers:{Authorization:`Bearer ${o}`}})).data.filter(T=>T.date===B),_={};M.forEach(T=>{_[T.userId]={status:T.status,checkInStatus:T.checkInStatus,checkIn:T.checkIn}}),Q(_)}catch(o){console.error("Error loading user attendance status:",o)}}async function g(o){var B,ee;o.preventDefault(),I(!0);try{const M=localStorage.getItem("token");if(b){const _={...a};if(delete _.password,_.leaveQuota==="other"){const T=parseInt(_.leaveQuotaOther)||12;_.leaveQuota=null,_.leaveQuotaOther=T}else _.leaveQuota=parseInt(_.leaveQuota)||12,_.leaveQuotaOther=null;await R.put(`${U}/api/users/${b.id}`,_,{headers:{Authorization:`Bearer ${M}`}}),alert("User berhasil diperbarui"),S(!1),y(null)}else{const _={...a};if(delete _.employeeId,delete _.startDate,_.education==="Other"&&_.educationOther&&(_.education=_.educationOther),delete _.educationOther,_.leaveQuota==="other"){const T=parseInt(_.leaveQuotaOther)||12;_.leaveQuota=null,_.leaveQuotaOther=T}else _.leaveQuota=parseInt(_.leaveQuota)||12,_.leaveQuotaOther=null;await R.post(`${U}/api/users`,_,{headers:{Authorization:`Bearer ${M}`}}),alert("User berhasil ditambahkan"),C(!1),N()}l({name:"",username:"",password:"",email:"",employeeId:"",position:"",department:"",division:"",supervisor:"",startDate:"",employmentStatus:"",education:"",educationOther:"",institution:"",degree:"",basicSalary:"",currency:"IDR",leaveQuota:"12",leaveQuotaOther:"",role:"user"}),N()}catch(M){console.error(M),alert(((ee=(B=M.response)==null?void 0:B.data)==null?void 0:ee.message)||"Gagal menyimpan user")}finally{I(!1)}}function u(o){y(o);const B=["Kuliah","SMA","SMK"],ee=o.education||"",M=ee&&!B.includes(ee);l({name:o.name||"",username:o.username||"",password:"",email:o.email||"",employeeId:o.employeeId||"",position:o.position||"",department:o.department||"",division:o.division||"",supervisor:o.supervisor||"",startDate:o.startDate||"",employmentStatus:o.employmentStatus||"",education:M?"Other":ee||"",educationOther:M?ee:"",institution:o.institution||"",degree:o.degree||"",basicSalary:o.basicSalary||"",currency:o.currency||"IDR",leaveQuota:o.leaveQuotaOther?"other":o.leaveQuota?String(o.leaveQuota):"12",leaveQuotaOther:o.leaveQuotaOther?String(o.leaveQuotaOther):"",role:o.role||"user"}),S(!0)}function H(o){v(o),c(!0)}async function f(){var o,B;if(L)try{const ee=localStorage.getItem("token");await R.delete(`${U}/api/users/${L.id}`,{headers:{Authorization:`Bearer ${ee}`}}),alert("User berhasil dihapus"),c(!1),v(null),N()}catch(ee){console.error(ee),alert(((B=(o=ee.response)==null?void 0:o.data)==null?void 0:B.message)||"Gagal menghapus user")}}return e.jsxs("div",{children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Master ",e.jsx("span",{className:"gradient-text",children:"User"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Kelola data diri semua user"})]}),e.jsx("button",{onClick:()=>{if(!m){const o=new Date().toISOString().split("T")[0];l({name:"",username:"",password:"",email:"",employeeId:"",position:"",department:"",division:"",supervisor:"",startDate:o,employmentStatus:"",education:"",educationOther:"",institution:"",degree:"",basicSalary:"",currency:"IDR",role:"user"})}C(!m)},className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium",children:m?"Tutup Form":"Tambah User"})]})}),m&&!j&&e.jsxs("div",{className:`card-strong mb-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Tambah User Baru"}),e.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Nama Lengkap *"}),e.jsx("input",{required:!0,type:"text",placeholder:"Nama Lengkap",value:a.name,onChange:o=>l({...a,name:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Username *"}),e.jsx("input",{required:!0,type:"text",placeholder:"Username",value:a.username,onChange:o=>l({...a,username:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Email *"}),e.jsx("input",{required:!0,type:"email",placeholder:"Email",value:a.email,onChange:o=>l({...a,email:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${a.email&&a.email.includes("@example.com")?"border-red-500 focus:border-red-500 focus:ring-red-500":t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`}),a.email&&a.email.includes("@example.com")&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:" Email tidak boleh menggunakan domain example.com. Silakan gunakan email yang valid."})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Password *"}),e.jsx("input",{required:!0,type:"password",placeholder:"Password",value:a.password,onChange:o=>l({...a,password:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Employee ID",e.jsx("span",{className:`text-xs ml-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"(Otomatis di-generate)"})]}),e.jsx("input",{type:"text",placeholder:"Akan di-generate otomatis",value:"Akan di-generate otomatis",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-50 border-gray-300 text-gray-500"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Posisi *"}),e.jsxs("select",{required:!0,value:a.position,onChange:o=>l({...a,position:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih Posisi..."}),e.jsx("option",{value:"Head",children:"Head"}),e.jsx("option",{value:"Staff",children:"Staff"}),e.jsx("option",{value:"Admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Department"}),e.jsx("input",{type:"text",placeholder:"Department",value:a.department,onChange:o=>l({...a,department:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Tanggal Mulai",e.jsx("span",{className:`text-xs ml-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"(Otomatis: hari ini)"})]}),e.jsx("input",{type:"date",value:a.startDate,disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-50 border-gray-300 text-gray-500"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status Karyawan *"}),e.jsxs("select",{required:!0,value:a.employmentStatus,onChange:o=>l({...a,employmentStatus:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih..."}),e.jsx("option",{value:"Tetap",children:"Tetap"}),e.jsx("option",{value:"Kontrak",children:"Kontrak"}),e.jsx("option",{value:"Magang",children:"Magang"}),e.jsx("option",{value:"Freelance",children:"Freelance"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Pendidikan Terakhir *"}),e.jsxs("select",{required:!0,value:a.education,onChange:o=>l({...a,education:o.target.value,educationOther:""}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih Pendidikan..."}),e.jsx("option",{value:"Kuliah",children:"Kuliah"}),e.jsx("option",{value:"SMA",children:"SMA"}),e.jsx("option",{value:"SMK",children:"SMK"}),e.jsx("option",{value:"Other",children:"Other"})]}),a.education==="Other"&&e.jsx("input",{required:!0,type:"text",placeholder:"Masukkan pendidikan lainnya",value:a.educationOther,onChange:o=>l({...a,educationOther:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 mt-2 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Institusi *"}),e.jsx("input",{required:!0,type:"text",placeholder:"Institusi",value:a.institution,onChange:o=>l({...a,institution:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Gelar *"}),e.jsxs("select",{required:!0,value:a.degree,onChange:o=>l({...a,degree:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih Gelar..."}),e.jsx("option",{value:"D1",children:"D1"}),e.jsx("option",{value:"D3",children:"D3"}),e.jsx("option",{value:"S1",children:"S1"}),e.jsx("option",{value:"S2",children:"S2"}),e.jsx("option",{value:"S3",children:"S3"})]})]}),e.jsxs("div",{className:`md:col-span-2 border-t pt-4 mt-2 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Informasi Gaji"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Mata Uang *"}),e.jsxs("select",{required:!0,value:a.currency,onChange:o=>l({...a,currency:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"IDR",children:"IDR (Rupiah)"}),e.jsx("option",{value:"USD",children:"USD (Dollar)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Gaji Pokok"}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Masukkan gaji pokok",value:a.basicSalary,onChange:o=>l({...a,basicSalary:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Jatah Cuti *"}),e.jsxs("select",{value:a.leaveQuota,onChange:o=>l({...a,leaveQuota:o.target.value,leaveQuotaOther:o.target.value==="other"?a.leaveQuotaOther:""}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"12",children:"12 Hari"}),e.jsx("option",{value:"24",children:"24 Hari"}),e.jsx("option",{value:"other",children:"Other (Custom)"})]})]}),a.leaveQuota==="other"&&e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Jatah Cuti Custom (Hari) *"}),e.jsx("input",{type:"number",min:"1",placeholder:"Masukkan jumlah hari",value:a.leaveQuotaOther,onChange:o=>l({...a,leaveQuotaOther:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,required:a.leaveQuota==="other"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Role *"}),e.jsxs("select",{value:a.role,onChange:o=>l({...a,role:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{C(!1),l({name:"",username:"",password:"",email:"",employeeId:"",position:"",department:"",division:"",supervisor:"",startDate:"",employmentStatus:"",education:"",educationOther:"",institution:"",degree:"",basicSalary:"",currency:"IDR",leaveQuota:"12",leaveQuotaOther:"",role:"user"})},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium",children:"Tambah User"})]})]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Semua User"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[r.length," user"]})]}),i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[r.length===0&&e.jsx("div",{className:"col-span-full text-center py-12",children:e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Belum ada user"})}),r.map(o=>e.jsxs("div",{className:`card transition-colors relative group ${t==="dark"?"bg-gray-700 border-gray-600 hover:border-purple-500":"bg-white border-gray-200 hover:border-indigo-300"}`,children:[e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>{const B=document.getElementById(`menu-${o.id}`);B&&B.classList.toggle("hidden")},className:`p-2 rounded-lg transition-colors opacity-0 group-hover:opacity-100 ${t==="dark"?"hover:bg-gray-600 text-gray-300":"hover:bg-gray-100 text-gray-700"}`,children:e.jsx(gn,{})}),e.jsxs("div",{id:`menu-${o.id}`,className:`hidden absolute right-0 mt-2 w-40 rounded-lg shadow-lg border py-1 z-10 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("button",{onClick:()=>{var B;(B=document.getElementById(`menu-${o.id}`))==null||B.classList.add("hidden"),u(o)},className:`w-full text-left px-4 py-2 flex items-center gap-2 transition-colors ${t==="dark"?"text-gray-300 hover:bg-gray-700":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(cn,{}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:()=>{var B;(B=document.getElementById(`menu-${o.id}`))==null||B.classList.add("hidden"),H(o)},className:`w-full text-left px-4 py-2 flex items-center gap-2 transition-colors ${t==="dark"?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-red-50"}`,children:[e.jsx(mn,{}),e.jsx("span",{children:"Hapus"})]})]})]})}),e.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`font-semibold text-lg transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:o.name}),W[o.id]&&(()=>{const B=W[o.id];return B.status==="Hadir"&&B.checkIn?B.checkInStatus==="early"?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-100 text-blue-800 border border-blue-300",children:" Early"}):B.checkInStatus==="onTime"?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800 border border-green-300",children:" On Time"}):B.checkInStatus==="almostLate"?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800 border border-yellow-300",children:" Almost Late"}):B.checkInStatus==="late"?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:" Late"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-green-100 text-green-800 border border-green-300",children:" Hadir"}):B.status==="Izin"?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800 border border-yellow-300",children:" Izin"}):B.status==="Sakit"?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-red-100 text-red-800 border border-red-300",children:" Sakit"}):B.status==="Alfa"?e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-gray-100 text-gray-800 border border-gray-300",children:" Alfa"}):e.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs font-semibold bg-gray-100 text-gray-600 border border-gray-300",children:" Belum Absen"})})()]}),e.jsxs("div",{className:`text-sm mb-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:[e.jsxs("div",{children:["@",o.username]}),e.jsxs("div",{className:`font-medium ${o.email&&o.email.includes("@example.com")?"text-red-500":""}`,children:[o.email||"Email tidak tersedia",o.email&&o.email.includes("@example.com")&&e.jsx("span",{className:"ml-2 text-xs text-yellow-600 dark:text-yellow-400",children:" Perlu diupdate"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2 flex-wrap",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${o.role==="admin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`,children:o.role}),o.employmentStatus&&e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium transition-colors ${t==="dark"?"bg-gray-600 text-gray-300":"bg-gray-100 text-gray-800"}`,children:o.employmentStatus})]})]})}),e.jsxs("div",{className:`space-y-1 text-sm border-t pt-3 transition-colors ${t==="dark"?"text-gray-400 border-gray-600":"text-gray-600 border-gray-200"}`,children:[o.employeeId&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Employee ID:"})," ",o.employeeId]}),o.position&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Posisi:"})," ",o.position]}),o.department&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Department:"})," ",o.department]}),o.phone&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Phone:"})," ",o.phone]}),o.startDate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Mulai:"})," ",new Date(o.startDate).toLocaleDateString("id-ID")]})]})]},o.id))]})]}),j&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`rounded-xl shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Edit User: ",b==null?void 0:b.name]}),e.jsx("button",{onClick:()=>{S(!1),y(null),l({name:"",username:"",password:"",email:"",employeeId:"",position:"",department:"",division:"",supervisor:"",startDate:"",employmentStatus:"",education:"",educationOther:"",institution:"",degree:"",basicSalary:"",currency:"IDR",role:"user"})},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:g,className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Nama Lengkap *"}),e.jsx("input",{required:!0,type:"text",placeholder:"Nama Lengkap",value:a.name,onChange:o=>l({...a,name:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Username *"}),e.jsx("input",{required:!0,type:"text",placeholder:"Username",value:a.username,onChange:o=>l({...a,username:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Email *"}),e.jsx("input",{required:!0,type:"email",placeholder:"Email",value:a.email,onChange:o=>l({...a,email:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${a.email&&a.email.includes("@example.com")?"border-red-500 focus:border-red-500 focus:ring-red-500":t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`}),a.email&&a.email.includes("@example.com")&&e.jsx("p",{className:"mt-1 text-xs text-red-600 dark:text-red-400",children:" Email tidak boleh menggunakan domain example.com. Silakan gunakan email yang valid."})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Employee ID *"}),e.jsx("input",{required:!0,type:"text",placeholder:"Employee ID",value:a.employeeId,onChange:o=>l({...a,employeeId:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Posisi *"}),e.jsxs("select",{required:!0,value:a.position,onChange:o=>l({...a,position:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih Posisi..."}),e.jsx("option",{value:"Head",children:"Head"}),e.jsx("option",{value:"Staff",children:"Staff"}),e.jsx("option",{value:"Admin",children:"Admin"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Department"}),e.jsx("input",{type:"text",placeholder:"Department",value:a.department,onChange:o=>l({...a,department:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Divisi"}),e.jsx("input",{type:"text",placeholder:"Divisi",value:a.division,onChange:o=>l({...a,division:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Supervisor"}),e.jsx("input",{type:"text",placeholder:"Supervisor",value:a.supervisor,onChange:o=>l({...a,supervisor:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Tanggal Mulai *"}),e.jsx("input",{required:!0,type:"date",value:a.startDate,onChange:o=>l({...a,startDate:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status Karyawan *"}),e.jsxs("select",{required:!0,value:a.employmentStatus,onChange:o=>l({...a,employmentStatus:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih..."}),e.jsx("option",{value:"Tetap",children:"Tetap"}),e.jsx("option",{value:"Kontrak",children:"Kontrak"}),e.jsx("option",{value:"Magang",children:"Magang"}),e.jsx("option",{value:"Freelance",children:"Freelance"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Pendidikan Terakhir *"}),e.jsxs("select",{required:!0,value:a.education,onChange:o=>l({...a,education:o.target.value,educationOther:""}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih Pendidikan..."}),e.jsx("option",{value:"Kuliah",children:"Kuliah"}),e.jsx("option",{value:"SMA",children:"SMA"}),e.jsx("option",{value:"SMK",children:"SMK"}),e.jsx("option",{value:"Other",children:"Other"})]}),a.education==="Other"&&e.jsx("input",{required:!0,type:"text",placeholder:"Masukkan pendidikan lainnya",value:a.educationOther,onChange:o=>l({...a,educationOther:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 mt-2 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Institusi *"}),e.jsx("input",{required:!0,type:"text",placeholder:"Institusi",value:a.institution,onChange:o=>l({...a,institution:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Gelar *"}),e.jsxs("select",{required:!0,value:a.degree,onChange:o=>l({...a,degree:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih Gelar..."}),e.jsx("option",{value:"D1",children:"D1"}),e.jsx("option",{value:"D3",children:"D3"}),e.jsx("option",{value:"S1",children:"S1"}),e.jsx("option",{value:"S2",children:"S2"}),e.jsx("option",{value:"S3",children:"S3"})]})]}),e.jsxs("div",{className:`md:col-span-2 border-t pt-4 mt-2 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Informasi Gaji"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Mata Uang *"}),e.jsxs("select",{required:!0,value:a.currency,onChange:o=>l({...a,currency:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"IDR",children:"IDR (Rupiah)"}),e.jsx("option",{value:"USD",children:"USD (Dollar)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Gaji Pokok"}),e.jsx("input",{type:"number",step:"0.01",placeholder:"Masukkan gaji pokok",value:a.basicSalary,onChange:o=>l({...a,basicSalary:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Jatah Cuti *"}),e.jsxs("select",{value:a.leaveQuota,onChange:o=>l({...a,leaveQuota:o.target.value,leaveQuotaOther:o.target.value==="other"?a.leaveQuotaOther:""}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"12",children:"12 Hari"}),e.jsx("option",{value:"24",children:"24 Hari"}),e.jsx("option",{value:"other",children:"Other (Custom)"})]})]}),a.leaveQuota==="other"&&e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Jatah Cuti Custom (Hari) *"}),e.jsx("input",{type:"number",min:"1",placeholder:"Masukkan jumlah hari",value:a.leaveQuotaOther,onChange:o=>l({...a,leaveQuotaOther:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,required:a.leaveQuota==="other"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Role *"}),e.jsxs("select",{value:a.role,onChange:o=>l({...a,role:o.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsxs("div",{className:"md:col-span-2 flex items-center justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{S(!1),y(null),l({name:"",username:"",password:"",email:"",employeeId:"",position:"",department:"",division:"",supervisor:"",startDate:"",employmentStatus:"",education:"",educationOther:"",institution:"",degree:"",basicSalary:"",currency:"IDR",role:"user"})},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{type:"submit",disabled:w,className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:w?"Menyimpan...":"Simpan Perubahan"})]})]})]})}),D&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`rounded-xl shadow-2xl p-6 max-w-md w-full transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Hapus User"}),e.jsx("button",{onClick:()=>{c(!1),v(null)},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:`mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:["Apakah Anda yakin ingin menghapus user ",e.jsx("span",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:L==null?void 0:L.name}),"?"]}),e.jsx("p",{className:"text-sm text-red-600",children:"Tindakan ini tidak dapat dibatalkan."})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>{c(!1),v(null)},className:`px-4 py-2 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium",children:"Hapus"})]})]})})]})}const Vr=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),at=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Jr=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),st=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),un=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),nt=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),it=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),Lt=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),hn=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})}),pn=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),hr=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),ot=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),bn=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),yn=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Gr=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})}),Qr=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),Yr=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"})});function be({to:t,icon:r,children:s,onClick:i,badge:n,theme:a}){const l=At(),m=l.pathname===t||t!=="/"&&l.pathname.startsWith(t);return e.jsxs(Nt,{to:t,onClick:i,className:`flex items-center justify-between px-4 py-2.5 rounded-lg transition-all duration-200 group ${a==="dark"?m?"text-white bg-purple-500/20":"text-white/90 hover:text-white hover:bg-white/10":m?"text-indigo-900 bg-indigo-100":"text-indigo-700 hover:text-indigo-900 hover:bg-indigo-50"}`,style:a==="dark"&&m?{background:"rgba(175, 71, 210, 0.2)"}:{},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:a==="dark"?m?"text-white":"text-white/90":m?"text-indigo-900":"text-indigo-700"}),e.jsx("span",{className:"font-medium text-sm",children:s})]}),n&&n>0&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold rounded-full text-white",style:{background:"#AF47D2"},children:n})]})}function fn({open:t,onClose:r,user:s,pendingCount:i,theme:n,toggleTheme:a,userViewMode:l}){const m=lt(),[C,b]=d.useState(!1);function y(){localStorage.removeItem("token"),localStorage.removeItem("user"),m("/login")}return e.jsxs("div",{className:`${t?"fixed":"hidden"} inset-0 z-50 lg:hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300",onClick:r}),e.jsxs("div",{className:`absolute left-0 top-0 bottom-0 w-80 shadow-2xl transform transition-transform duration-300 flex flex-col ${n==="dark"?"bg-[#26355D]":"bg-gradient-to-br from-indigo-50 to-purple-50"}`,children:[e.jsx("div",{className:`p-6 border-b transition-colors ${n==="dark"?"border-white/10":"border-indigo-200/50"}`,children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center overflow-hidden shadow-lg",children:C?e.jsx("div",{className:"w-full h-full flex items-center justify-center text-white font-semibold text-lg",style:{background:"linear-gradient(135deg, #AF47D2 0%, #8B3DB8 100%)"},children:"A"}):e.jsx("img",{src:"/IconP.png",alt:"HexaSuite",className:"w-full h-full object-cover",onError:()=>b(!0)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-base font-bold leading-tight transition-colors ${n==="dark"?"text-white":"text-indigo-900"}`,children:"HexaSuite HR"}),e.jsx("div",{className:`text-[10px] font-normal leading-tight mt-0.5 transition-colors ${n==="dark"?"text-white/50":"text-indigo-500/70"}`,children:"Management System"}),e.jsx("div",{className:`text-xs mt-1 transition-colors ${n==="dark"?"text-white/70":"text-indigo-600/70"}`,children:(s==null?void 0:s.name)||"Guest"})]})]}),e.jsx("button",{onClick:r,className:`p-2 rounded-lg transition-colors ${n==="dark"?"hover:bg-white/10 text-white":"hover:bg-indigo-100 text-indigo-700"}`,children:e.jsx(pn,{})})]})}),e.jsxs("nav",{className:"flex-1 p-4 flex flex-col gap-2 overflow-y-auto sidebar-scroll",children:[e.jsx(be,{to:"/",icon:Vr,onClick:r,theme:n,children:"Dashboard"}),(s==null?void 0:s.role)==="admin"&&!l?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`px-4 py-2 text-xs font-semibold uppercase tracking-wider transition-colors ${n==="dark"?"text-white/60":"text-indigo-600/70"}`,children:"Master Menu"}),e.jsx(be,{to:"/admin/attendance",icon:at,onClick:r,badge:i,theme:n,children:"Master Absensi"}),e.jsx(be,{to:"/admin/leave",icon:it,onClick:r,badge:i,theme:n,children:"Master Izin/Cuti"}),e.jsx(be,{to:"/admin/daily-report",icon:ot,onClick:r,theme:n,children:"Master Laporan"}),e.jsx(be,{to:"/admin/users",icon:Jr,onClick:r,theme:n,children:"Master User"}),e.jsx(be,{to:"/admin/payroll",icon:nt,onClick:r,theme:n,children:"Master Payroll"}),e.jsx(be,{to:"/admin/performance",icon:st,onClick:r,theme:n,children:"Performance"}),e.jsx(be,{to:"/admin/biometric",icon:Yr,onClick:r,theme:n,children:"Biometric"})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{to:"/attendance",icon:at,onClick:r,theme:n,children:"Absensi Saya"}),e.jsx(be,{to:"/leave",icon:it,onClick:r,theme:n,children:"Izin/Cuti Saya"}),e.jsx(be,{to:"/daily-report",icon:ot,onClick:r,theme:n,children:"Laporan"}),e.jsx(be,{to:"/payroll",icon:nt,onClick:r,theme:n,children:"Payroll Saya"}),e.jsx(be,{to:"/performance",icon:st,onClick:r,theme:n,children:"Performance"})]})]}),e.jsxs("div",{className:`absolute bottom-0 left-0 right-0 p-4 border-t space-y-2 transition-colors ${n==="dark"?"border-white/10":"border-indigo-200/50"}`,children:[e.jsx("button",{onClick:a,className:`w-full flex items-center justify-between px-4 py-2.5 rounded-lg transition-all duration-200 ${n==="dark"?"text-white/90 hover:text-white hover:bg-white/10 border border-white/20":"text-indigo-700 hover:text-indigo-900 hover:bg-indigo-100 border border-indigo-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[n==="dark"?e.jsx(Gr,{}):e.jsx(Qr,{}),e.jsx("span",{className:"font-medium text-sm",children:n==="dark"?"Light Mode":"Dark Mode"})]})}),e.jsxs("button",{onClick:y,className:`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all font-medium border ${n==="dark"?"text-white/90 hover:text-white hover:bg-red-500/20 border-red-500/30":"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200"}`,children:[e.jsx(Lt,{}),e.jsx("span",{children:"Logout"})]})]})]})]})}function kn(){const[t,r]=d.useState(!1),[s,i]=d.useState(!1),[n,a]=d.useState(!1),[l,m]=d.useState([]),[C,b]=d.useState([]),[y,j]=d.useState([]),[S,D]=d.useState([]),[c,L]=d.useState(()=>JSON.parse(localStorage.getItem("user")||"null")),[v,w]=d.useState(!1),[I,W]=d.useState(()=>localStorage.getItem("adminUserViewMode")==="true"),[Q,N]=d.useState(!1),[k,g]=d.useState(null),{theme:u,toggleTheme:H}=Ne(),f=lt(),o=At(),B=l.length+C.length+y.length;d.useEffect(()=>{async function M(){const _=localStorage.getItem("token");if(_)try{const Y=(await R.get(`${U}/api/users/me`,{headers:{Authorization:`Bearer ${_}`}})).data;Y&&(localStorage.setItem("user",JSON.stringify(Y)),L(Y))}catch(T){console.error("Error refreshing user data:",T)}}M()},[]),d.useEffect(()=>{async function M(){const Y=localStorage.getItem("token"),oe=JSON.parse(localStorage.getItem("user")||"null");if(!(!Y||!oe||oe.role!=="admin"))try{const[$,X,p]=await Promise.all([R.get(`${U}/api/leaverequests/pending`,{headers:{Authorization:`Bearer ${Y}`}}),R.get(`${U}/api/attendance-status-requests/pending`,{headers:{Authorization:`Bearer ${Y}`}}),R.get(`${U}/api/daily-report-edit-requests/pending`,{headers:{Authorization:`Bearer ${Y}`}})]);m(($.data||[]).filter(F=>F.status==="Pending")),b((X.data||[]).filter(F=>F.status==="Pending")),j((p.data||[]).filter(F=>F.status==="Pending"))}catch($){console.error("Error loading pending requests:",$)}}M();const _=setInterval(M,15e3),T=()=>{M()};return window.addEventListener("refreshNotifications",T),()=>{clearInterval(_),window.removeEventListener("refreshNotifications",T)}},[]),d.useEffect(()=>{async function M(){const T=localStorage.getItem("token");if(T)try{const Y=await R.get(`${U}/api/notifications`,{headers:{Authorization:`Bearer ${T}`}});D(Y.data||[])}catch(Y){console.error("Error loading notifications:",Y)}}M();const _=setInterval(M,3e4);return()=>clearInterval(_)},[]),d.useEffect(()=>{function M(_){s&&!_.target.closest(".user-menu-container")&&i(!1),n&&!_.target.closest(".notification-container")&&a(!1)}return document.addEventListener("mousedown",M),()=>document.removeEventListener("mousedown",M)},[s,n]),d.useEffect(()=>{if(!(!c||c.role!=="admin")){if(I){if(o.pathname.startsWith("/admin/")){const M=o.pathname.replace("/admin/","/");M!==o.pathname&&f(M||"/",{replace:!0})}}else if(["/attendance","/leave","/daily-report","/payroll","/performance"].includes(o.pathname)){const _="/admin"+o.pathname;_!==o.pathname&&f(_,{replace:!0})}}},[I,o.pathname,c==null?void 0:c.role,f,c]);function ee(){localStorage.removeItem("token"),localStorage.removeItem("user"),f("/login")}return e.jsxs("div",{className:`min-h-screen transition-colors duration-300 ${u==="dark"?"bg-gray-900":"bg-gray-50"}`,children:[Q&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm transition-colors ${u==="dark"?"bg-black/60":"bg-black/40"}`,children:e.jsx("div",{className:`rounded-xl shadow-2xl p-6 transition-colors ${u==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} border`,children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:`h-12 w-12 border-4 rounded-full animate-spin ${u==="dark"?"border-purple-500 border-t-transparent":"border-purple-600 border-t-transparent"}`}),e.jsx("p",{className:`text-sm font-medium transition-colors ${u==="dark"?"text-white":"text-gray-900"}`,children:k!==null?k?"Switching to User View...":"Switching to Admin View...":"Switching view..."})]})})}),e.jsx(fn,{open:t,onClose:()=>r(!1),user:c,pendingCount:B,theme:u,toggleTheme:H,userViewMode:I}),e.jsxs("div",{className:"lg:flex",children:[e.jsxs("aside",{className:`hidden lg:flex lg:flex-col lg:w-72 lg:fixed lg:left-0 lg:top-0 lg:h-screen lg:border-r shadow-2xl transition-colors duration-300 ${u==="dark"?"bg-[#26355D] border-[#AF47D2]/20":"bg-gradient-to-br from-indigo-50 to-purple-50 border-indigo-200"}`,children:[e.jsx("div",{className:`p-6 border-b transition-colors duration-300 ${u==="dark"?"border-white/10":"border-indigo-200/50"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl flex items-center justify-center overflow-hidden shadow-lg",children:e.jsx("img",{src:_r,alt:"HexaSuite",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-base font-bold leading-tight transition-colors ${u==="dark"?"text-white":"text-indigo-900"}`,children:"HexaSuite HR"}),e.jsx("div",{className:`text-[10px] font-normal leading-tight mt-0.5 transition-colors ${u==="dark"?"text-white/50":"text-indigo-500/70"}`,children:"Management System"})]})]})}),e.jsxs("nav",{className:"flex-1 p-4 flex flex-col gap-2 overflow-y-auto sidebar-scroll",children:[e.jsx(be,{to:"/",icon:Vr,theme:u,children:"Dashboard"}),(c==null?void 0:c.role)==="admin"&&!I?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"px-4 py-2 mt-2",children:e.jsx("span",{className:`text-xs font-semibold uppercase tracking-wider transition-colors ${u==="dark"?"text-white/60":"text-indigo-600/70"}`,children:"Master Menu"})}),e.jsx(be,{to:"/admin/attendance",icon:at,theme:u,children:"Master Absensi"}),e.jsx(be,{to:"/admin/leave",icon:it,theme:u,children:"Master Izin/Cuti"}),e.jsx(be,{to:"/admin/daily-report",icon:ot,theme:u,children:"Master Laporan"}),e.jsx(be,{to:"/admin/users",icon:Jr,theme:u,children:"Master User"}),e.jsx(be,{to:"/admin/payroll",icon:nt,theme:u,children:"Master Payroll"}),e.jsx(be,{to:"/admin/performance",icon:st,theme:u,children:"Performance"}),e.jsx(be,{to:"/admin/biometric",icon:Yr,theme:u,children:"Biometric"})]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{to:"/attendance",icon:at,theme:u,children:"Absensi Saya"}),e.jsx(be,{to:"/leave",icon:it,theme:u,children:"Izin/Cuti Saya"}),e.jsx(be,{to:"/daily-report",icon:ot,theme:u,children:"Laporan"}),e.jsx(be,{to:"/payroll",icon:nt,theme:u,children:"Payroll Saya"}),e.jsx(be,{to:"/performance",icon:st,theme:u,children:"Performance"})]})]}),e.jsxs("div",{className:`p-4 border-t transition-colors duration-300 ${u==="dark"?"border-white/10":"border-indigo-200/50"} space-y-2`,children:[e.jsx("button",{onClick:H,className:`w-full flex items-center justify-between px-4 py-2.5 rounded-lg transition-all duration-200 ${u==="dark"?"text-white/90 hover:text-white hover:bg-white/10 border border-white/20":"text-indigo-700 hover:text-indigo-900 hover:bg-indigo-100 border border-indigo-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[u==="dark"?e.jsx(Gr,{}):e.jsx(Qr,{}),e.jsx("span",{className:"font-medium text-sm",children:u==="dark"?"Light Mode":"Dark Mode"})]})}),e.jsxs("button",{onClick:ee,className:`w-full flex items-center gap-3 px-4 py-2.5 rounded-lg transition-all duration-200 font-medium border ${u==="dark"?"text-white/90 hover:text-white hover:bg-red-500/20 border-red-500/30":"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-200"}`,children:[e.jsx(Lt,{}),e.jsx("span",{className:"text-sm",children:"Logout"})]})]})]}),e.jsxs("div",{className:"flex-1 min-h-screen flex flex-col lg:ml-72",children:[e.jsx("header",{className:`sticky top-0 z-40 border-b shadow-lg backdrop-blur-xl transition-colors duration-300 ${u==="dark"?"bg-gray-800/95 border-gray-700":"bg-white/95 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between px-3 py-3 sm:px-4 sm:py-4 lg:px-8",children:[e.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 min-w-0 flex-1",children:[e.jsx("button",{onClick:()=>r(!0),className:`lg:hidden p-2 rounded-xl transition-colors flex-shrink-0 ${u==="dark"?"hover:bg-gray-700 text-gray-200":"hover:bg-gray-100 text-gray-700"}`,children:e.jsx(hn,{})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h1",{className:`text-lg sm:text-xl font-bold transition-colors truncate ${u==="dark"?"text-white":"text-gray-900"}`,children:"Absensi"}),e.jsx("p",{className:`text-xs hidden sm:block transition-colors ${u==="dark"?"text-gray-400":"text-purple-600"}`,children:"Sistem Manajemen Absensi"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:[(c==null?void 0:c.role)==="admin"&&e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[e.jsx("span",{className:`text-xs font-medium transition-colors hidden sm:inline ${u==="dark"?"text-gray-400":"text-gray-600"}`,children:I?"User":"Admin"}),e.jsx("button",{onClick:()=>{if(Q)return;const M=!I;g(M),N(!0),setTimeout(()=>{W(M),localStorage.setItem("adminUserViewMode",M.toString()),window.dispatchEvent(new Event("viewModeChanged")),f("/"),N(!1),g(null)},800)},disabled:Q,className:`relative inline-flex h-6 w-11 sm:h-7 sm:w-14 items-center rounded-full transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 ${Q?"cursor-wait":"cursor-pointer"} ${I?u==="dark"?"bg-purple-600 focus:ring-purple-500":"bg-purple-500 focus:ring-purple-400":u==="dark"?"bg-gray-700 focus:ring-gray-500":"bg-gray-300 focus:ring-gray-400"}`,title:I?"Switch to Admin View":"Switch to User View",children:Q?e.jsx("span",{className:`inline-block h-4 w-4 sm:h-5 sm:w-5 transform rounded-full transition-transform duration-300 ${I?"translate-x-6 sm:translate-x-8":"translate-x-1"}`,children:e.jsx("div",{className:`h-4 w-4 sm:h-5 sm:w-5 rounded-full flex items-center justify-center ${u==="dark"?"bg-gray-800":"bg-white"}`,children:e.jsx("div",{className:`h-2.5 w-2.5 sm:h-3 sm:w-3 border-2 rounded-full animate-spin ${u==="dark"?"border-purple-400 border-t-transparent":"border-purple-500 border-t-transparent"}`})})}):e.jsx("span",{className:`inline-block h-4 w-4 sm:h-5 sm:w-5 transform rounded-full transition-transform duration-300 ${I?"translate-x-6 sm:translate-x-8":"translate-x-1"} ${u==="dark"?"bg-gray-800":"bg-white"} shadow-lg`})})]}),(c==null?void 0:c.role)==="admin"&&!I&&e.jsxs("div",{className:"relative notification-container",children:[e.jsxs("button",{onClick:()=>a(!n),className:`relative p-1.5 sm:p-2 rounded-xl transition-colors ${u==="dark"?"hover:bg-gray-700 text-gray-200":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx(hr,{className:"w-5 h-5"}),B>0?e.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 min-w-[1.25rem] h-5 text-xs font-bold text-white bg-red-500 rounded-full border-2 border-white animate-pulse",children:B>99?"99+":B}):null]}),n&&e.jsxs("div",{className:`absolute right-0 mt-2 w-72 sm:w-80 rounded-xl shadow-xl border z-50 animate-fade-in max-h-96 overflow-hidden flex flex-col transition-colors duration-300 ${u==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:`p-4 border-b transition-colors duration-300 ${u==="dark"?"border-gray-700 bg-gray-700/50":"border-gray-200 bg-gray-50"}`,children:[e.jsx("h3",{className:`font-semibold transition-colors ${u==="dark"?"text-white":"text-gray-900"}`,children:"Notifikasi"}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${u==="dark"?"text-gray-400":"text-gray-600"}`,children:B>0?`${B} pengajuan menunggu`:"Tidak ada pengajuan baru"})]}),e.jsx("div",{className:"overflow-y-auto",children:l.length===0&&C.length===0&&y.length===0?e.jsxs("div",{className:`p-6 text-center transition-colors ${u==="dark"?"text-gray-400":"text-gray-500"}`,children:[e.jsx(hr,{className:`w-12 h-12 mx-auto mb-2 transition-colors ${u==="dark"?"text-gray-600":"text-gray-300"}`}),e.jsx("p",{className:"text-sm",children:"Tidak ada pengajuan baru"})]}):e.jsxs("div",{className:"divide-y divide-gray-100",children:[l.map(M=>{var _,T,Y;return e.jsx("button",{onClick:()=>{a(!1),f("/admin/leave")},className:`w-full p-4 text-left transition-colors ${u==="dark"?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`flex-shrink-0 w-2 h-2 rounded-full mt-2 ${(_=M.reason)!=null&&_.toLowerCase().includes("cuti")?"bg-blue-500":"bg-yellow-500"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-sm font-semibold transition-colors ${u==="dark"?"text-white":"text-gray-900"}`,children:(T=M.reason)!=null&&T.toLowerCase().includes("cuti")?"Cuti":"Izin"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full transition-colors ${u==="dark"?"bg-yellow-900/50 text-yellow-300":"bg-yellow-100 text-yellow-800"}`,children:"Pending"})]}),e.jsx("p",{className:`text-sm font-medium truncate transition-colors ${u==="dark"?"text-gray-200":"text-gray-900"}`,children:((Y=M.User)==null?void 0:Y.name)||`User ID: ${M.userId}`}),e.jsx("p",{className:`text-xs mt-1 line-clamp-2 transition-colors ${u==="dark"?"text-gray-400":"text-gray-600"}`,children:M.reason||"Tidak ada deskripsi"}),e.jsxs("p",{className:"text-xs mt-1 transition-colors text-gray-500",children:[new Date(M.startDate).toLocaleDateString("id-ID")," - ",new Date(M.endDate).toLocaleDateString("id-ID")]})]})]})},`leave-${M.id}`)}),C.map(M=>{var _,T;return e.jsx("button",{onClick:()=>{a(!1),f("/admin/attendance")},className:`w-full p-4 text-left transition-colors ${u==="dark"?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-2 h-2 rounded-full mt-2 bg-purple-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-sm font-semibold transition-colors ${u==="dark"?"text-white":"text-gray-900"}`,children:"Request Status Absensi"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full transition-colors ${u==="dark"?"bg-yellow-900/50 text-yellow-300":"bg-yellow-100 text-yellow-800"}`,children:"Pending"})]}),e.jsx("p",{className:`text-sm font-medium truncate transition-colors ${u==="dark"?"text-gray-200":"text-gray-900"}`,children:((_=M.User)==null?void 0:_.name)||`User ID: ${M.userId}`}),e.jsx("p",{className:`text-xs mt-1 line-clamp-2 transition-colors ${u==="dark"?"text-gray-400":"text-gray-600"}`,children:M.description||"Tidak ada deskripsi"}),e.jsx("p",{className:"text-xs mt-1 transition-colors text-gray-500",children:(T=M.Attendance)!=null&&T.date?new Date(M.Attendance.date).toLocaleDateString("id-ID"):"-"})]})]})},`attendance-${M.id}`)}),y.map(M=>{var _,T;return e.jsx("button",{onClick:()=>{a(!1),f("/admin/daily-report")},className:`w-full p-4 text-left transition-colors ${u==="dark"?"hover:bg-gray-700":"hover:bg-gray-50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-2 h-2 rounded-full mt-2 bg-orange-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`text-sm font-semibold transition-colors ${u==="dark"?"text-white":"text-gray-900"}`,children:"Request Edit Laporan"}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full transition-colors ${u==="dark"?"bg-yellow-900/50 text-yellow-300":"bg-yellow-100 text-yellow-800"}`,children:"Pending"})]}),e.jsx("p",{className:`text-sm font-medium truncate transition-colors ${u==="dark"?"text-gray-200":"text-gray-900"}`,children:((_=M.User)==null?void 0:_.name)||`User ID: ${M.userId}`}),e.jsx("p",{className:`text-xs mt-1 line-clamp-2 transition-colors ${u==="dark"?"text-gray-400":"text-gray-600"}`,children:M.reason||"Tidak ada alasan"}),e.jsx("p",{className:"text-xs mt-1 transition-colors text-gray-500",children:(T=M.DailyReport)!=null&&T.date?new Date(M.DailyReport.date).toLocaleDateString("id-ID"):"-"})]})]})},`daily-report-edit-${M.id}`)})]})}),B>0&&e.jsx("div",{className:`p-3 border-t transition-colors ${u==="dark"?"border-gray-700 bg-gray-700/50":"border-gray-200 bg-gray-50"}`,children:e.jsx("button",{onClick:()=>{a(!1),f("/admin/leave")},className:`w-full text-sm font-medium transition-colors ${u==="dark"?"text-indigo-400 hover:text-indigo-300":"text-indigo-600 hover:text-indigo-700"}`,children:"Lihat Semua "})})]})]}),e.jsxs("div",{className:"relative user-menu-container",children:[e.jsxs("button",{onClick:()=>i(!s),className:`flex items-center gap-2 sm:gap-3 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg border transition-all duration-200 ${u==="dark"?"border-gray-700 bg-gray-800 hover:bg-gray-700":"border-gray-200 bg-white hover:bg-gray-50"}`,children:[c!=null&&c.profilePicture?e.jsx("img",{src:ke(c.profilePicture),alt:(c==null?void 0:c.name)||"User",className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full object-cover border-2 border-gray-200 flex-shrink-0"}):e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full text-white flex items-center justify-center font-semibold text-xs sm:text-sm flex-shrink-0",style:{background:"linear-gradient(135deg, #AF47D2 0%, #8B3DB8 100%)"},children:((c==null?void 0:c.name)||"U").slice(0,1).toUpperCase()}),e.jsxs("div",{className:"hidden sm:block text-left min-w-0",children:[e.jsx("div",{className:`text-xs sm:text-sm font-semibold truncate transition-colors ${u==="dark"?"text-white":"text-gray-900"}`,children:(c==null?void 0:c.name)||"Guest"}),e.jsx("div",{className:`text-xs truncate transition-colors ${u==="dark"?"text-gray-400":"text-gray-500"}`,children:(c==null?void 0:c.email)||(c==null?void 0:c.role)||"User"})]}),e.jsx(bn,{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 flex-shrink-0 hidden sm:block"})]}),s&&e.jsxs("div",{className:"absolute right-0 mt-2 w-44 sm:w-48 rounded-xl shadow-2xl border py-2 z-50",style:{background:"#1a2440",borderColor:"rgba(175, 71, 210, 0.3)"},children:[e.jsxs(Nt,{to:"/profile",onClick:()=>i(!1),className:"w-full text-left px-4 py-2.5 text-white/90 hover:text-white hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(un,{}),e.jsx("span",{className:"text-sm",children:"View profile"})]}),(c==null?void 0:c.role)==="admin"&&e.jsxs(Nt,{to:"/admin/performance",onClick:()=>i(!1),className:"w-full text-left px-4 py-2.5 text-white/90 hover:text-white hover:bg-white/10 flex items-center gap-3 transition-colors",children:[e.jsx(yn,{}),e.jsx("span",{className:"text-sm",children:"Analytics"})]}),e.jsx("div",{className:"border-t border-white/10 my-1"}),e.jsxs("button",{onClick:()=>{i(!1),ee()},className:"w-full text-left px-4 py-2.5 text-red-400 hover:text-red-300 hover:bg-red-500/10 flex items-center gap-3 transition-colors",children:[e.jsx(Lt,{}),e.jsx("span",{className:"text-sm",children:"Log out"})]}),e.jsx("div",{className:"px-4 py-2 text-xs text-white/60 text-center border-t border-white/10 mt-1",children:"v1.0"})]})]})]})]})}),e.jsx("main",{className:`flex-1 p-4 lg:p-8 transition-colors duration-300 ${u==="dark"?"bg-gray-900":"bg-gray-50"}`,children:e.jsx(la,{})})]})]}),e.jsx("style",{children:`
        @keyframes fade-in {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in {
          animation: fade-in 0.3s ease-out;
        }
        /* Hide scrollbar for sidebar */
        .sidebar-scroll::-webkit-scrollbar {
          display: none;
        }
        .sidebar-scroll {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
      `})]})}function jn({status:t,theme:r}){const i={Pending:r==="dark"?"bg-yellow-700 text-yellow-100":"bg-yellow-100 text-yellow-800",Approved:r==="dark"?"bg-green-700 text-green-100":"bg-green-100 text-green-800",Rejected:r==="dark"?"bg-rose-700 text-rose-100":"bg-rose-100 text-rose-800"}[t]||(r==="dark"?"bg-gray-700 text-gray-100":"bg-gray-100 text-gray-800");return e.jsx("span",{className:`${i} px-3 py-1 rounded-full text-sm font-medium`,children:t})}function vn(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState(!1),[a,l]=d.useState(""),[m,C]=d.useState(""),[b,y]=d.useState(""),[j,S]=d.useState("Izin"),[D,c]=d.useState(!1),[L,v]=d.useState(null),w=JSON.parse(localStorage.getItem("user")||"null"),I=(w==null?void 0:w.role)==="admin";d.useEffect(()=>{Q(),W();const f=setInterval(()=>{W()},3e4),o=()=>{W(),Q()};return window.addEventListener("focus",o),()=>{clearInterval(f),window.removeEventListener("focus",o)}},[]);async function W(){try{const f=localStorage.getItem("token"),o=await R.get(`${U}/api/users/me`,{headers:{Authorization:`Bearer ${f}`}});v(o.data),localStorage.setItem("user",JSON.stringify(o.data))}catch(f){console.error(f)}}async function Q(){try{const f=localStorage.getItem("token"),o=await R.get(`${U}/api/leaverequests`,{headers:{Authorization:`Bearer ${f}`}});s(o.data||[]),await W()}catch(f){console.error(f)}}function N(){if(!L)return 0;const f=L.leaveQuotaOther?L.leaveQuotaOther:L.leaveQuota||12,o=L.usedLeaveQuota||0;return Math.max(0,f-o)}const k=N(),g=k>0;function u(){return!a||!m?!1:new Date(a)<=new Date(m)}async function H(){var f,o;if(!u()){alert("Tanggal tidak valid");return}if(j==="Cuti"&&!g){alert("Jatah cuti Anda sudah habis. Anda tidak dapat mengajukan cuti lagi, tapi masih bisa mengajukan izin.");return}c(!0);try{const B=localStorage.getItem("token");await R.post(`${U}/api/leaverequests`,{startDate:a,endDate:m,reason:b,type:j},{headers:{Authorization:`Bearer ${B}`}}),l(""),C(""),y(""),S("Izin"),n(!1),await Q(),await W()}catch(B){alert(((o=(f=B.response)==null?void 0:f.data)==null?void 0:o.message)||"Submit failed")}c(!1)}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Izin/Cuti ",e.jsx("span",{className:"gradient-text",children:"Saya"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Lihat riwayat dan ajukan cuti atau izin kerja"})]}),!I&&e.jsx("div",{children:e.jsx("button",{onClick:()=>{S("Izin"),n(!0)},className:"btn btn-primary",children:"Ajukan Cuti / Izin"})})]}),!I&&L&&e.jsx("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gradient-to-br from-[#26355D] to-[#1a2440] border-[#AF47D2]/30":"bg-gradient-to-br from-indigo-100 to-purple-100 border-indigo-300"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-3 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Jatah Cuti Saya"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Total Jatah:"}),e.jsxs("span",{className:`ml-2 font-bold text-base transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[L.leaveQuotaOther?L.leaveQuotaOther:L.leaveQuota||12," hari"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Terpakai:"}),e.jsxs("span",{className:`ml-2 font-bold text-base transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[L.usedLeaveQuota||0," hari"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Sisa:"}),e.jsxs("span",{className:`ml-2 font-bold text-xl ${k>0?t==="dark"?"text-green-300":"text-green-600":t==="dark"?"text-red-300":"text-red-600"}`,children:[k," hari"]})]})]})]}),e.jsx("div",{className:`px-5 py-4 rounded-xl transition-colors ${k>0?t==="dark"?"bg-green-600/20 text-green-200 border-2 border-green-500":"bg-green-500 text-white border-2 border-green-600":t==="dark"?"bg-red-600/20 text-red-200 border-2 border-red-500":"bg-red-500 text-white border-2 border-red-600"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:k>0?"":""}),e.jsx("span",{className:"text-sm font-semibold",children:k>0?"Masih Bisa Cuti":"Jatah Cuti Habis"})]})})]})}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Riwayat Pengajuan"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Total: ",r.length]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.length===0&&e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Belum ada pengajuan"}),r.map(f=>e.jsx("div",{className:`border rounded-lg p-4 shadow-sm flex items-start gap-4 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-medium flex items-center gap-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[f.type==="Cuti"?" Cuti":" Izin",e.jsxs("span",{className:`text-sm font-normal transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["(",f.type,")"]})]}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[f.startDate,"  ",f.endDate]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(jn,{status:f.status,theme:t})})]}),e.jsx("div",{className:`mt-2 text-sm rounded-lg p-2 border transition-colors ${t==="dark"?"text-gray-300 bg-gray-600 border-gray-500":"text-gray-700 bg-gray-50 border-gray-200"}`,children:f.reason||"Tidak ada alasan"})]})},f.id))]})]}),i&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`w-full max-w-lg rounded-xl shadow-xl p-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Form Pengajuan"}),e.jsx("button",{onClick:()=>{n(!1),S("Izin")},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-500 hover:text-gray-700"}`,children:"Tutup"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:`text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Jenis *"}),e.jsxs("select",{value:j,onChange:f=>{const o=f.target.value;if(o==="Cuti"&&!g){alert("Jatah cuti Anda sudah habis. Anda tidak dapat mengajukan cuti lagi, tapi masih bisa mengajukan izin.");return}S(o)},className:`mt-1 p-2 border rounded w-full transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"Izin",children:"Izin"}),e.jsxs("option",{value:"Cuti",disabled:!g,children:["Cuti ",g?"":"(Jatah Habis)"]})]}),!g&&e.jsxs("p",{className:`mt-1 text-xs flex items-center gap-1 transition-colors ${t==="dark"?"text-red-400":"text-red-600"}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),"Jatah cuti Anda sudah habis. Anda masih bisa mengajukan izin."]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:`text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Mulai"}),e.jsx("input",{type:"date",value:a,onChange:f=>l(f.target.value),className:`mt-1 p-2 border rounded w-full transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Selesai"}),e.jsx("input",{type:"date",value:m,onChange:f=>C(f.target.value),className:`mt-1 p-2 border rounded w-full transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{className:`text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:"Alasan"}),e.jsx("textarea",{value:b,onChange:f=>y(f.target.value),className:`mt-1 p-2 border rounded w-full h-24 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>n(!1),className:`btn btn-ghost transition-colors ${t==="dark"?"text-gray-300 hover:bg-gray-700":""}`,children:"Batal"}),e.jsx("button",{onClick:H,className:"btn btn-primary",disabled:D,children:D?"Mengirim...":"Kirim Pengajuan"})]})]})})]})}function wn(){return e.jsxs("div",{className:"max-w-xl",children:[e.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Pengaturan Sistem"}),e.jsx("div",{className:"card-strong",children:e.jsx("p",{className:"text-gray-600",children:"Pengaturan waktu absensi dapat diatur di halaman Master Absensi."})})]})}function Nn(){const[t,r]=d.useState("");function s(i){const n=`${API_URL}/api${i}?month=${t}`;window.open(n,"_blank")}return e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Laporan & Export"}),e.jsx("div",{className:"card-strong",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Pilih Bulan"}),e.jsx("input",{type:"month",value:t,onChange:i=>r(i.target.value),className:"mt-1 p-2 border rounded w-full"})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>s("/reports/attendances"),className:"btn btn-primary",children:"Export Absensi (CSV)"})}),e.jsx("div",{children:e.jsx("button",{onClick:()=>s("/reports/leaves"),className:"btn btn-ghost",children:"Export Cuti (CSV)"})})]})})]})}function $n(){var C,b,y;const{theme:t}=Ne(),[r,s]=d.useState(new Date().toISOString().slice(0,7)),[i,n]=d.useState(!1),[a,l]=d.useState(null);d.useEffect(()=>{r&&m()},[r]);async function m(){if(r){n(!0);try{const j=localStorage.getItem("token"),S=await R.get(`${API_URL}/api/payroll/me?month=${r}`,{headers:{Authorization:`Bearer ${j}`}});l(S.data)}catch(j){console.error(j),l(null)}n(!1)}}return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Payroll ",e.jsx("span",{className:"gradient-text",children:"Saya"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Lihat detail gaji dan payroll Anda"})]}),e.jsx("div",{className:`card-strong mb-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Pilih Bulan"}),e.jsx("input",{type:"month",value:r,onChange:j=>s(j.target.value),className:`w-full md:w-64 p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]})}),i?e.jsx("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]})}):a?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gradient-to-br from-indigo-600 to-purple-600 border-indigo-500":"bg-gradient-to-br from-indigo-400 to-purple-400 border-indigo-300"}`,children:[e.jsx("div",{className:"text-sm mb-1 transition-colors text-white/90",children:"Bulan"}),e.jsx("div",{className:"text-2xl font-bold transition-colors text-white",children:new Date(r+"-01").toLocaleDateString("id-ID",{month:"long",year:"numeric"})})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gradient-to-br from-green-600 to-emerald-600 border-green-500":"bg-gradient-to-br from-green-400 to-emerald-400 border-green-300"}`,children:[e.jsx("div",{className:"text-sm mb-1 transition-colors text-white/90",children:"Hari Kerja"}),e.jsxs("div",{className:"text-2xl font-bold transition-colors text-white",children:[a.presentDays||0," hari"]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gradient-to-br from-amber-600 to-orange-600 border-amber-500":"bg-gradient-to-br from-amber-400 to-orange-400 border-amber-300"}`,children:[e.jsx("div",{className:"text-sm mb-1 transition-colors text-white/90",children:"Total Gaji"}),e.jsxs("div",{className:"text-2xl font-bold transition-colors text-white",children:["Rp ",((C=a.salary)==null?void 0:C.toLocaleString("id-ID"))||"0"]})]})]}):e.jsx("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Tidak ada data payroll untuk bulan ini"})]})}),a&&e.jsxs("div",{className:`card-strong mt-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Detail Perhitungan"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex items-center justify-between py-2 border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("span",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Daily Rate"}),e.jsxs("span",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Rp ",((b=a.dailyRate)==null?void 0:b.toLocaleString("id-ID"))||"0"]})]}),e.jsxs("div",{className:`flex items-center justify-between py-2 border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("span",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Hari Kerja"}),e.jsxs("span",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[a.presentDays||0," hari"]})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsx("span",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Total Gaji"}),e.jsxs("span",{className:`text-lg font-bold transition-colors ${t==="dark"?"text-indigo-400":"text-indigo-600"}`,children:["Rp ",((y=a.salary)==null?void 0:y.toLocaleString("id-ID"))||"0"]})]})]})]})]})}function Sn(){const[t,r]=d.useState([]);d.useEffect(()=>{s()},[]);async function s(){try{const i=localStorage.getItem("token"),a=(await R.get(`${API_URL}/api/leaverequests`,{headers:{Authorization:`Bearer ${i}`}})).data.filter(l=>l.status==="Approved").map(l=>{var m;return{title:((m=l.User)==null?void 0:m.name)||"Leave",date:l.startDate}});r(a)}catch(i){console.error(i)}}return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Kalender Cuti (Approved)"}),e.jsxs("div",{className:"card-strong",children:[t.length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"Belum ada cuti disetujui"}),e.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2",children:t.map((i,n)=>e.jsxs("div",{className:"p-2 bg-indigo-50 rounded",children:[i.date,"  ",i.title]},n))})]})]})}function In(){const[t,r]=d.useState([]);d.useEffect(()=>{s()},[]);async function s(){try{const i=localStorage.getItem("token"),n=await R.get(`${API_URL}/api/notifications`,{headers:{Authorization:`Bearer ${i}`}});r(n.data||[])}catch(i){console.error(i)}}return e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold mb-4",children:"Notifikasi"}),e.jsxs("div",{className:"card-strong",children:[t.length===0&&e.jsx("div",{className:"text-sm text-gray-500",children:"Belum ada notifikasi"}),e.jsx("div",{className:"space-y-2",children:t.map(i=>e.jsxs("div",{className:"p-2 border rounded flex items-start gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:i.title}),e.jsx("div",{className:"text-sm text-gray-600",children:i.body})]}),e.jsx("div",{className:"text-xs text-gray-500",children:i.read?"Read":"New"})]},i.id))})]})]})}function Cn(){var Bt,Ft,Ot,Ut,zt,Kt,Ht,qt,Wt,_t,Vt,Jt,Gt,Qt;const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState(!1),[a,l]=d.useState({date:"",userId:""}),[m,C]=d.useState("desc"),[b,y]=d.useState(""),[j,S]=d.useState([]),[D,c]=d.useState(!1),[L,v]=d.useState("time"),[w,I]=d.useState({checkInTime:"08:00",checkOutTime:"17:00",breakStartTime:"12:00",breakEndTime:"13:00",checkInTolerance:15,breakDuration:60}),[W,Q]=d.useState(!1),[N,k]=d.useState(!1),[g,u]=d.useState(null),[H,f]=d.useState(!1),[o,B]=d.useState({startDate:new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),[ee,M]=d.useState(!1),[_,T]=d.useState([]),[Y,oe]=d.useState(!1),[$,X]=d.useState(null),[p,F]=d.useState(""),[h,E]=d.useState(!1),[z,Z]=d.useState("absen"),[ne,re]=d.useState({}),[V,me]=d.useState(!1),[A,J]=d.useState([]),[K,ae]=d.useState(null),[G,ce]=d.useState({day1:"",day2:"",isActive:!0}),[de,ge]=d.useState(!1),[ue,Ae]=d.useState([]),[O,se]=d.useState([]),[ie,he]=d.useState(!1),[pe,ve]=d.useState(!1);d.useEffect(()=>{pt(),ia(),Et(),Mt(),Se(),$e()},[]),d.useEffect(()=>{const x=setInterval(()=>{z==="absen"&&$e()},3e4),q=()=>{z==="absen"&&$e()};return window.addEventListener("refreshAttendanceStatus",q),()=>{clearInterval(x),window.removeEventListener("refreshAttendanceStatus",q)}},[z]);async function $e(){me(!0);try{const x=localStorage.getItem("token"),q=new Date().toISOString().slice(0,10),le=(await R.get(`${U}/api/attendances`,{headers:{Authorization:`Bearer ${x}`}})).data.filter(ye=>ye.date===q),je={};le.forEach(ye=>{je[ye.userId]={status:ye.status,checkInStatus:ye.checkInStatus,checkIn:ye.checkIn,checkOut:ye.checkOut,breakTaken:ye.breakTaken,breakLate:ye.breakLate,earlyLeave:ye.earlyLeave}}),re(je)}catch(x){console.error("Error loading today attendance status:",x)}me(!1)}async function Se(){try{const x=localStorage.getItem("token"),q=await R.get(`${U}/api/user-holiday-settings`,{headers:{Authorization:`Bearer ${x}`}});J(q.data||[])}catch(x){console.error("Error loading holiday settings:",x)}}function we(x){return["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"][x]||""}async function Me(x){var q,te;if(!G.day1){alert("Hari libur pertama wajib diisi");return}ge(!0);try{const le=localStorage.getItem("token");await R.post(`${U}/api/user-holiday-settings/user/${x}`,{day1:parseInt(G.day1),day2:G.day2?parseInt(G.day2):null,isActive:G.isActive},{headers:{Authorization:`Bearer ${le}`}}),alert("Pengaturan hari libur berhasil disimpan"),ae(null),ce({day1:"",day2:"",isActive:!0}),await Se()}catch(le){alert(((te=(q=le.response)==null?void 0:q.data)==null?void 0:te.message)||"Gagal menyimpan pengaturan hari libur"),console.error(le)}ge(!1)}async function Je(x){var q,te;if(confirm("Apakah Anda yakin ingin menghapus pengaturan hari libur untuk user ini?"))try{const le=localStorage.getItem("token");await R.delete(`${U}/api/user-holiday-settings/user/${x}`,{headers:{Authorization:`Bearer ${le}`}}),alert("Pengaturan hari libur berhasil dihapus"),await Se()}catch(le){alert(((te=(q=le.response)==null?void 0:q.data)==null?void 0:te.message)||"Gagal menghapus pengaturan hari libur"),console.error(le)}}function Zr(x){var q,te;ae(x.userId),ce({day1:((q=x.day1)==null?void 0:q.toString())||"",day2:x.day2!==null?(te=x.day2)==null?void 0:te.toString():"",isActive:x.isActive!==!1})}function ea(x){ae(x),ce({day1:"",day2:"",isActive:!0})}async function ta(){var x,q;if(ue.length===0){alert("Pilih minimal 1 user untuk di-assign pengaturan waktu");return}he(!0);try{const te=localStorage.getItem("token"),le=await R.post(`${U}/api/user-time-settings/bulk-assign`,{userIds:ue,checkInTime:w.checkInTime,checkOutTime:w.checkOutTime,breakStartTime:w.breakStartTime,breakEndTime:w.breakEndTime,checkInTolerance:w.checkInTolerance,breakDuration:w.breakDuration,isActive:!0},{headers:{Authorization:`Bearer ${te}`}});alert(`Pengaturan waktu berhasil di-assign ke ${le.data.success.length} user`),Ae([])}catch(te){alert(((q=(x=te.response)==null?void 0:x.data)==null?void 0:q.message)||"Gagal assign pengaturan waktu"),console.error(te)}he(!1)}async function ra(){var x,q;if(O.length===0){alert("Pilih minimal 1 user untuk di-assign pengaturan hari libur");return}if(!G.day1){alert("Hari libur pertama wajib diisi");return}ve(!0);try{const te=localStorage.getItem("token"),le=await R.post(`${U}/api/user-holiday-settings/bulk-assign`,{userIds:O,day1:parseInt(G.day1),day2:G.day2?parseInt(G.day2):null,isActive:G.isActive},{headers:{Authorization:`Bearer ${te}`}});alert(`Pengaturan hari libur berhasil di-assign ke ${le.data.success.length} user`),se([]),ce({day1:"",day2:"",isActive:!0}),await Se()}catch(te){alert(((q=(x=te.response)==null?void 0:x.data)==null?void 0:q.message)||"Gagal assign pengaturan hari libur"),console.error(te)}ve(!1)}function aa(x){Ae(q=>q.includes(x)?q.filter(te=>te!==x):[...q,x])}function sa(x){se(q=>q.includes(x)?q.filter(te=>te!==x):[...q,x])}async function Et(){try{const x=localStorage.getItem("token"),q=await R.get(`${U}/api/settings`,{headers:{Authorization:`Bearer ${x}`}}),te={};q.data.forEach(le=>{te[le.key]=le.value}),I({checkInTime:te.checkInTime||"08:00",checkOutTime:te.checkOutTime||"17:00",breakStartTime:te.breakStartTime||"12:00",breakEndTime:te.breakEndTime||"13:00",checkInTolerance:parseInt(te.checkInTolerance)||15,breakDuration:parseInt(te.breakDuration)||60})}catch(x){console.error("Error loading settings:",x)}}async function na(){var x,q;Q(!0);try{const te=localStorage.getItem("token"),le=[{key:"checkInTime",value:w.checkInTime},{key:"checkOutTime",value:w.checkOutTime},{key:"breakStartTime",value:w.breakStartTime},{key:"breakEndTime",value:w.breakEndTime},{key:"checkInTolerance",value:String(w.checkInTolerance)},{key:"breakDuration",value:String(w.breakDuration)}];for(const je of le)await R.post(`${U}/api/settings`,je,{headers:{Authorization:`Bearer ${te}`}});alert("Pengaturan berhasil disimpan"),c(!1)}catch(te){alert(((q=(x=te.response)==null?void 0:x.data)==null?void 0:q.message)||"Gagal menyimpan pengaturan"),console.error(te)}Q(!1)}async function ia(){try{const x=localStorage.getItem("token"),q=await R.get(`${U}/api/users`,{headers:{Authorization:`Bearer ${x}`}});S(q.data)}catch(x){console.error(x)}}async function pt(){n(!0);try{const x=localStorage.getItem("token");let te=(await R.get(`${U}/api/attendances`,{headers:{Authorization:`Bearer ${x}`}})).data||[];const le=b||a.date;le&&(te=te.filter(je=>je.date===le)),a.userId&&(te=te.filter(je=>je.userId===parseInt(a.userId))),te.sort((je,ye)=>{const Ue=new Date(je.date),ze=new Date(ye.date);return m==="asc"?Ue-ze:ze-Ue}),s(te)}catch(x){console.error(x)}n(!1)}d.useEffect(()=>{pt()},[a,m,b]);async function Mt(){try{const x=localStorage.getItem("token"),te=((await R.get(`${U}/api/attendance-status-requests/pending`,{headers:{Authorization:`Bearer ${x}`}})).data||[]).filter(le=>le.status==="Pending");T(te)}catch(x){console.error("Error loading pending requests:",x)}}function Ge(x){X(x),F(""),oe(!0)}async function Qe(x,q=null){var le,je;const te=q||$;if(te){E(!0);try{const ye=localStorage.getItem("token");await R.put(`${U}/api/attendance-status-requests/${te.id}`,{status:x,adminNote:p||void 0},{headers:{Authorization:`Bearer ${ye}`}}),alert(`Request berhasil ${x==="Approved"?"disetujui":"ditolak"}`),oe(!1),X(null),F(""),await Mt(),await pt(),window.dispatchEvent(new Event("refreshNotifications"))}catch(ye){console.error(ye),alert(((je=(le=ye.response)==null?void 0:le.data)==null?void 0:je.message)||"Gagal memproses request")}finally{E(!1)}}}function bt(x){return{late:" Late",almostLate:" Almost Late",early:" Come Early",onTime:" On Time",breakLate:" Break Late",earlyLeave:" Early Leave",general:"Hadir"}[x]||x}function yt(x){return{onTime:" On Time",almostLate:" Almost Late",early:" Come Early",normal:"Normal",onTimeCheckout:"On Time Checkout"}[x]||x}return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Master ",e.jsx("span",{className:"gradient-text",children:"Absensi"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Lihat dan kelola data absensi semua user"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export Excel"]}),e.jsxs("button",{onClick:()=>{c(!D),D||v("time")},className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium flex items-center gap-2",children:[e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Pengaturan Waktu"]})]})]}),D&&e.jsxs("div",{className:`card-strong mb-6 border transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-gradient-to-br from-indigo-50 to-purple-50 border-indigo-200"}`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Pengaturan Waktu Absensi"}),e.jsxs("div",{className:`flex border-b mb-6 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("button",{onClick:()=>v("time"),className:`px-6 py-3 font-medium text-sm transition-colors relative ${L==="time"?t==="dark"?"text-white":"text-indigo-600":t==="dark"?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:["Pengaturan Waktu",L==="time"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]}),e.jsxs("button",{onClick:()=>{v("holiday"),Se()},className:`px-6 py-3 font-medium text-sm transition-colors relative ${L==="holiday"?t==="dark"?"text-white":"text-indigo-600":t==="dark"?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:["Pengaturan Hari Libur",L==="holiday"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]})]}),L==="time"&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Waktu Check In *"}),e.jsx("input",{type:"time",value:w.checkInTime,onChange:x=>I({...w,checkInTime:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Waktu Check Out *"}),e.jsx("input",{type:"time",value:w.checkOutTime,onChange:x=>I({...w,checkOutTime:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Waktu Mulai Istirahat *"}),e.jsx("input",{type:"time",value:w.breakStartTime,onChange:x=>I({...w,breakStartTime:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Waktu Selesai Istirahat *"}),e.jsx("input",{type:"time",value:w.breakEndTime,onChange:x=>I({...w,breakEndTime:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Toleransi Check In (menit) *"}),e.jsx("input",{type:"number",min:"0",value:w.checkInTolerance,onChange:x=>I({...w,checkInTolerance:parseInt(x.target.value)||0}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,placeholder:"15"}),e.jsxs("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Jika check in tepat waktu = On Time",e.jsx("br",{}),"Jika melewati waktu tapi belum melebihi toleransi = Almost Late",e.jsx("br",{}),"Jika melewati toleransi = Late"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Durasi Istirahat (menit) *"}),e.jsx("input",{type:"number",min:"0",value:w.breakDuration,onChange:x=>I({...w,breakDuration:parseInt(x.target.value)||0}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,placeholder:"60"}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Jika selesai istirahat melewati durasi yang ditentukan = Break Late"})]})]}),e.jsxs("div",{className:`mt-6 p-4 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Pilih Karyawan untuk Assign Pengaturan Waktu"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ae(j.map(x=>x.id)),className:`text-xs px-3 py-1 rounded transition-colors ${t==="dark"?"text-gray-300 hover:bg-gray-600":"text-gray-600 hover:bg-gray-200"}`,children:"Pilih Semua"}),e.jsx("button",{onClick:()=>Ae([]),className:`text-xs px-3 py-1 rounded transition-colors ${t==="dark"?"text-gray-300 hover:bg-gray-600":"text-gray-600 hover:bg-gray-200"}`,children:"Batal Pilih"})]})]}),e.jsx("div",{className:"max-h-48 overflow-y-auto space-y-2",children:j.map(x=>e.jsxs("label",{className:`flex items-center gap-3 p-2 rounded cursor-pointer hover:bg-opacity-50 transition-colors ${t==="dark"?"hover:bg-gray-600":"hover:bg-gray-100"}`,children:[e.jsx("input",{type:"checkbox",checked:ue.includes(x.id),onChange:()=>aa(x.id),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:x.name}),e.jsxs("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:["@",x.username,"  ",x.department||"Tidak ada departemen"]})]})]},x.id))}),ue.length>0&&e.jsx("div",{className:`mt-4 pt-4 border-t transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`,children:e.jsxs("p",{className:`text-sm mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[ue.length," user terpilih"]})})]}),L==="time"&&e.jsxs("div",{className:"mt-6 flex items-center justify-between gap-3",children:[e.jsx("button",{onClick:()=>{c(!1),Ae([]),Et()},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:ta,disabled:ie||ue.length===0,className:"px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:ie?"Mengassign...":`Assign ke ${ue.length} User`}),e.jsx("button",{onClick:na,disabled:W,className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:W?"Menyimpan...":"Simpan Pengaturan Global"})]})]})]}),L==="holiday"&&e.jsxs("div",{children:[e.jsx("p",{className:`text-sm mb-4 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Kelola hari libur untuk setiap user. Setiap user dapat memiliki 1 atau 2 hari libur per minggu."}),e.jsxs("div",{className:`mb-6 p-4 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-blue-50 border-blue-200"}`,children:[e.jsx("h3",{className:`font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Bulk Assign Hari Libur"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Hari Libur Pertama ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:G.day1,onChange:x=>ce({...G,day1:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-600 border-gray-500 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih hari..."}),e.jsx("option",{value:"0",children:"Minggu"}),e.jsx("option",{value:"1",children:"Senin"}),e.jsx("option",{value:"2",children:"Selasa"}),e.jsx("option",{value:"3",children:"Rabu"}),e.jsx("option",{value:"4",children:"Kamis"}),e.jsx("option",{value:"5",children:"Jumat"}),e.jsx("option",{value:"6",children:"Sabtu"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Hari Libur Kedua ",e.jsx("span",{className:"text-xs text-gray-500",children:"(Opsional)"})]}),e.jsxs("select",{value:G.day2,onChange:x=>ce({...G,day2:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-600 border-gray-500 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Tidak ada (hanya 1 hari libur)"}),e.jsx("option",{value:"0",children:"Minggu"}),e.jsx("option",{value:"1",children:"Senin"}),e.jsx("option",{value:"2",children:"Selasa"}),e.jsx("option",{value:"3",children:"Rabu"}),e.jsx("option",{value:"4",children:"Kamis"}),e.jsx("option",{value:"5",children:"Jumat"}),e.jsx("option",{value:"6",children:"Sabtu"})]})]})]}),e.jsxs("div",{className:`mb-4 p-3 rounded-lg border transition-colors ${t==="dark"?"bg-gray-600 border-gray-500":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Pilih Karyawan"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>se(j.map(x=>x.id)),className:`text-xs px-2 py-1 rounded transition-colors ${t==="dark"?"text-gray-300 hover:bg-gray-500":"text-gray-600 hover:bg-gray-100"}`,children:"Semua"}),e.jsx("button",{onClick:()=>se([]),className:`text-xs px-2 py-1 rounded transition-colors ${t==="dark"?"text-gray-300 hover:bg-gray-500":"text-gray-600 hover:bg-gray-100"}`,children:"Reset"})]})]}),e.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:j.map(x=>e.jsxs("label",{className:`flex items-center gap-2 p-1.5 rounded cursor-pointer hover:bg-opacity-50 transition-colors ${t==="dark"?"hover:bg-gray-500":"hover:bg-gray-100"}`,children:[e.jsx("input",{type:"checkbox",checked:O.includes(x.id),onChange:()=>sa(x.id),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"}),e.jsxs("span",{className:`text-sm transition-colors ${t==="dark"?"text-gray-200":"text-gray-700"}`,children:[x.name," (@",x.username,")"]})]},x.id))})]}),e.jsx("div",{className:"flex items-center justify-end gap-3",children:e.jsx("button",{onClick:ra,disabled:pe||O.length===0||!G.day1,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:pe?"Mengassign...":`Assign ke ${O.length} User`})})]}),e.jsx("div",{className:"space-y-4",children:j.map(x=>{const q=A.find(le=>le.userId===x.id),te=K===x.id;return e.jsxs("div",{className:`p-4 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:x.name}),e.jsxs("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:["@",x.username,"  ",x.department||"Tidak ada departemen"]})]}),!te&&e.jsx("div",{className:"flex items-center gap-2",children:q?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:`text-sm px-3 py-1 rounded-full ${q.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:q.isActive?" Aktif":" Nonaktif"}),e.jsx("button",{onClick:()=>Zr(q),className:"px-3 py-1.5 text-sm bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors",children:"Edit"}),e.jsx("button",{onClick:()=>Je(x.id),className:"px-3 py-1.5 text-sm bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Hapus"})]}):e.jsx("button",{onClick:()=>ea(x.id),className:"px-3 py-1.5 text-sm bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"+ Tambah"})})]}),!te&&q&&e.jsx("div",{className:`text-sm p-3 rounded-lg ${t==="dark"?"bg-gray-600 text-gray-200":"bg-gray-50 text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium",children:"Hari Libur:"}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-medium",children:we(q.day1)}),q.day2!==null&&q.day2!==void 0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:","}),e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded text-xs font-medium",children:we(q.day2)})]})]})}),te&&e.jsxs("div",{className:"mt-4 space-y-4 p-4 border rounded-lg",style:{borderColor:t==="dark"?"#4b5563":"#e5e7eb"},children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Hari Libur Pertama ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:G.day1,onChange:le=>ce({...G,day1:le.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-600 border-gray-500 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih hari..."}),e.jsx("option",{value:"0",children:"Minggu"}),e.jsx("option",{value:"1",children:"Senin"}),e.jsx("option",{value:"2",children:"Selasa"}),e.jsx("option",{value:"3",children:"Rabu"}),e.jsx("option",{value:"4",children:"Kamis"}),e.jsx("option",{value:"5",children:"Jumat"}),e.jsx("option",{value:"6",children:"Sabtu"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Hari Libur Kedua ",e.jsx("span",{className:"text-xs text-gray-500",children:"(Opsional)"})]}),e.jsxs("select",{value:G.day2,onChange:le=>ce({...G,day2:le.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-600 border-gray-500 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Tidak ada (hanya 1 hari libur)"}),e.jsx("option",{value:"0",children:"Minggu"}),e.jsx("option",{value:"1",children:"Senin"}),e.jsx("option",{value:"2",children:"Selasa"}),e.jsx("option",{value:"3",children:"Rabu"}),e.jsx("option",{value:"4",children:"Kamis"}),e.jsx("option",{value:"5",children:"Jumat"}),e.jsx("option",{value:"6",children:"Sabtu"})]}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Kosongkan jika user hanya memiliki 1 hari libur per minggu"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`isActive-${x.id}`,checked:G.isActive,onChange:le=>ce({...G,isActive:le.target.checked}),className:"w-4 h-4 text-indigo-600 rounded focus:ring-indigo-500"}),e.jsx("label",{htmlFor:`isActive-${x.id}`,className:`text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Aktifkan pengaturan hari libur ini"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:()=>{ae(null),ce({day1:"",day2:"",isActive:!0})},className:`px-4 py-2 text-sm rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-600 hover:bg-gray-500":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{onClick:()=>Me(x.id),disabled:de||!G.day1,className:"px-4 py-2 text-sm bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:de?"Menyimpan...":"Simpan"})]})]})]},x.id)})}),L==="holiday"&&e.jsx("div",{className:"mt-6 flex items-center justify-end",children:e.jsx("button",{onClick:()=>{c(!1),ae(null),se([]),ce({day1:"",day2:"",isActive:!0})},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Tutup"})})]})]}),z==="log"&&e.jsxs("div",{className:`card-strong mb-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Cari Tanggal Spesifik"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:b,onChange:x=>y(x.target.value),placeholder:"Pilih tanggal...",className:`w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors pr-10 ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),b&&e.jsx("button",{onClick:()=>y(""),className:`absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors ${t==="dark"?"hover:text-gray-300":""}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Filter User"}),e.jsxs("select",{value:a.userId,onChange:x=>l({...a,userId:x.target.value}),className:`w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Semua User"}),j.map(x=>e.jsxs("option",{value:x.id,children:[x.name," (",x.username,")"]},x.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Urutkan Berdasarkan Tanggal"}),e.jsxs("select",{value:m,onChange:x=>C(x.target.value),className:`w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"desc",children:"Terbaru  Terlama"}),e.jsx("option",{value:"asc",children:"Terlama  Terbaru"})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:["Menampilkan ",r.length," catatan",b&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-indigo-100 text-indigo-700 rounded text-xs",children:["Filter: ",new Date(b).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})]}),e.jsx("button",{onClick:()=>{l({date:"",userId:""}),y(""),C("desc")},className:`px-4 py-2 text-sm rounded-lg transition-colors ${t==="dark"?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:"Reset Semua Filter"})]})]}),e.jsx("div",{className:`card-strong mb-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:`flex border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsxs("button",{onClick:()=>{Z("absen"),$e()},className:`px-6 py-3 font-medium text-sm transition-colors relative ${z==="absen"?t==="dark"?"text-white":"text-indigo-600":t==="dark"?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:["Absen",z==="absen"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]}),e.jsxs("button",{onClick:()=>Z("log"),className:`px-6 py-3 font-medium text-sm transition-colors relative ${z==="log"?t==="dark"?"text-white":"text-indigo-600":t==="dark"?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:["LOG",z==="log"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]}),e.jsxs("button",{onClick:()=>Z("requests"),className:`px-6 py-3 font-medium text-sm transition-colors relative ${z==="requests"?t==="dark"?"text-white":"text-indigo-600":t==="dark"?"text-gray-400 hover:text-white":"text-gray-600 hover:text-gray-900"}`,children:["Request Perubahan",_.length>0&&e.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs font-bold text-white bg-red-500 rounded-full",children:_.length}),z==="requests"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-gradient-to-r from-indigo-500 to-purple-500"})]})]})}),z==="absen"&&e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Status Kehadiran Hari Ini"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:new Date().toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("button",{onClick:$e,disabled:V,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx("svg",{className:`w-5 h-5 ${V?"animate-spin":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Refresh"]})]}),V?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(x=>{var ze,Yt;const q=ne[x.id],te=q==null?void 0:q.checkIn,le=(q==null?void 0:q.status)||"Belum Absen",je=q==null?void 0:q.checkInStatus,ye=q==null?void 0:q.checkIn,Ue=q==null?void 0:q.checkOut;return e.jsx("div",{className:`p-4 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[x.profilePicture?e.jsx("img",{src:x.profilePicture.startsWith("data:")?x.profilePicture:ke(x.profilePicture),alt:x.name,className:"w-12 h-12 rounded-full object-cover border-2 border-indigo-300"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center text-white font-bold",children:((Yt=(ze=x.name)==null?void 0:ze.charAt(0))==null?void 0:Yt.toUpperCase())||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`font-semibold truncate transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:x.name}),e.jsxs("p",{className:`text-xs truncate transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:["@",x.username]}),x.department&&e.jsx("p",{className:"text-xs mt-1 transition-colors text-gray-500",children:x.department})]})}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:te?e.jsxs(e.Fragment,{children:[je==="early"&&e.jsx("span",{className:"status-chip bg-blue-100 text-blue-800 border-2 border-blue-400",children:" Come Early"}),je==="onTime"&&e.jsx("span",{className:"status-chip bg-green-100 text-green-800 border-2 border-green-400",children:" On Time"}),je==="almostLate"&&e.jsx("span",{className:"status-chip bg-yellow-100 text-yellow-800 border-2 border-yellow-400",children:" Almost Late"}),je==="late"&&e.jsx("span",{className:"status-chip bg-red-100 text-red-800 border-2 border-red-400",children:" Late"}),(q==null?void 0:q.breakLate)&&e.jsx("span",{className:"status-chip bg-orange-100 text-orange-800 border border-orange-300",children:" Break Late"}),(q==null?void 0:q.earlyLeave)&&e.jsx("span",{className:"status-chip bg-blue-100 text-blue-800 border border-blue-300",children:" Early Leave"})]}):e.jsxs(e.Fragment,{children:[le==="Izin"&&e.jsx("span",{className:"status-chip status-warning",children:"Izin"}),le==="Sakit"&&e.jsx("span",{className:"status-chip status-danger",children:"Sakit"}),le==="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Alfa"}),(le==="Hadir"||le==="Belum Absen"||!le)&&e.jsx("span",{className:"status-chip status-default",children:"Belum Absen"})]})}),te&&e.jsxs("div",{className:`mt-3 text-xs space-y-1 transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{children:["Check In: ",ye||"-"]})]}),Ue&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{children:["Check Out: ",Ue]})]})]})]})]})},x.id)})})]}),z==="requests"&&e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Request Perubahan Status Absensi"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[_.length," request pending"]})]}),_.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Tidak ada request perubahan status absensi yang pending"})]}):e.jsx("div",{className:"space-y-3",children:_.map(x=>{var q,te;return e.jsx("div",{className:`card transition-colors cursor-pointer ${t==="dark"?"bg-gray-700 border-gray-600 hover:border-purple-500":"bg-white border-gray-200 hover:border-indigo-300"}`,onClick:()=>Ge(x),children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("div",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:((q=x.User)==null?void 0:q.name)||`User ID: ${x.userId}`}),e.jsx("span",{className:"status-chip bg-yellow-100 text-yellow-800 border-2 border-yellow-400",children:"Pending"})]}),e.jsxs("div",{className:`text-sm mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:["Tanggal Absensi: ",(te=x.Attendance)!=null&&te.date?new Date(x.Attendance.date).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"-"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[e.jsx("span",{className:"px-2 py-1 bg-red-50 text-red-700 rounded text-xs font-medium border border-red-200",children:bt(x.currentStatus)}),e.jsx("span",{className:`text-gray-400 transition-colors ${t==="dark"?"text-gray-500":""}`,children:""}),e.jsx("span",{className:"px-2 py-1 bg-green-50 text-green-700 rounded text-xs font-medium border border-green-200",children:yt(x.requestedStatus)})]}),e.jsxs("div",{className:`text-sm rounded-lg p-2 border transition-colors mb-3 ${t==="dark"?"text-gray-300 bg-gray-600 border-gray-500":"text-gray-600 bg-gray-50 border-gray-200"}`,children:[e.jsx("span",{className:"font-medium",children:"Alasan:"})," ",x.description]}),e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t",style:{borderColor:t==="dark"?"#374151":"#e5e7eb"},children:[e.jsx("button",{onClick:le=>{le.stopPropagation(),Ge(x)},className:"flex-1 px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium text-sm",children:"Lihat Detail"}),e.jsx("button",{onClick:async le=>{le.stopPropagation(),confirm("Apakah Anda yakin ingin menyetujui request ini?")&&(F(""),await Qe("Approved",x))},disabled:h,className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:h?"...":" Approve"}),e.jsx("button",{onClick:async le=>{le.stopPropagation(),confirm("Apakah Anda yakin ingin menolak request ini?")&&(F(""),await Qe("Rejected",x))},disabled:h,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:h?"...":" Reject"})]})]})})},x.id)})})]}),z==="log"&&e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Log Absensi"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Semua catatan absensi termasuk yang belum absen"})]}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[r.length," catatan"]})]}),i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsxs("div",{className:"space-y-3",children:[r.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Tidak ada data absensi"})]}),r.map(x=>e.jsx("div",{className:`card transition-colors cursor-pointer ${t==="dark"?"bg-gray-700 border-gray-600 hover:border-purple-500":"bg-white border-gray-200 hover:border-indigo-300"}`,onClick:()=>{u(x),k(!0)},children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2 flex-wrap",children:[e.jsx("div",{className:`font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:x.date}),x.status==="Izin"&&e.jsx("span",{className:"status-chip status-warning",children:"Izin"}),x.status==="Sakit"&&e.jsx("span",{className:"status-chip status-danger",children:"Sakit"}),x.status==="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Alfa"}),x.status==="Hadir"&&x.checkIn&&x.checkInStatus&&e.jsx("span",{className:`status-chip font-semibold ${x.checkInStatus==="early"?"bg-blue-100 text-blue-800 border-2 border-blue-400":x.checkInStatus==="onTime"?"bg-green-100 text-green-800 border-2 border-green-400":x.checkInStatus==="almostLate"?"bg-yellow-100 text-yellow-800 border-2 border-yellow-400":"bg-red-100 text-red-800 border-2 border-red-400"}`,children:x.checkInStatus==="early"?" Come Early":x.checkInStatus==="onTime"?" On Time":x.checkInStatus==="almostLate"?" Almost Late":" Late"}),x.status==="Hadir"&&x.checkIn&&!x.checkInStatus&&e.jsx("span",{className:"status-chip status-success",children:"Hadir"}),x.breakLate&&e.jsx("span",{className:"status-chip bg-orange-100 text-orange-800 border border-orange-300 font-medium",children:" Break Late"}),x.earlyLeave&&e.jsx("span",{className:"status-chip bg-blue-100 text-blue-800 border border-blue-300 font-medium",children:" Early Leave"}),!x.checkIn&&x.status!=="Izin"&&x.status!=="Sakit"&&x.status!=="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Belum Absen"})]}),e.jsxs("div",{className:`text-sm mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-600"}`,children:[e.jsx("div",{className:`font-medium mb-1 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:x.User?x.User.name:`User ID: ${x.userId}`}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"CheckIn: ",x.checkIn||"-"]}),(x.breakStart||x.breakEnd)&&e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Break: ",x.breakStart||"-"," - ",x.breakEnd||"-"]}),e.jsxs("span",{className:"inline-flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"CheckOut: ",x.checkOut||"-"]})]})]}),x.note&&e.jsx("div",{className:`text-sm rounded-lg p-2 border transition-colors ${t==="dark"?"text-gray-300 bg-gray-700 border-gray-600":"text-gray-600 bg-gray-50 border-gray-200"}`,children:x.note})]})})},x.id))]})]}),N&&g&&e.jsx("div",{className:`fixed inset-0 flex items-center justify-center z-50 p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,onClick:()=>k(!1),children:e.jsxs("div",{className:`rounded-xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:`sticky top-0 border-b px-6 py-4 flex items-center justify-between transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Detail Absensi"}),e.jsx("button",{onClick:()=>k(!1),className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:`flex items-center gap-4 mb-6 pb-6 border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[(Bt=g.User)!=null&&Bt.profilePicture?e.jsx("img",{src:g.User.profilePicture.startsWith("data:")?g.User.profilePicture:ke(g.User.profilePicture),alt:g.User.name,className:`w-16 h-16 rounded-full object-cover border-2 transition-colors ${t==="dark"?"border-purple-500":"border-indigo-200"}`}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center text-white text-xl font-bold",children:((Ut=(Ot=(Ft=g.User)==null?void 0:Ft.name)==null?void 0:Ot.charAt(0))==null?void 0:Ut.toUpperCase())||"U"}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:((zt=g.User)==null?void 0:zt.name)||`User ID: ${g.userId}`}),e.jsxs("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:["@",((Kt=g.User)==null?void 0:Kt.username)||"N/A"]}),e.jsxs("p",{className:"text-sm mt-1 transition-colors text-gray-500",children:["Tanggal: ",g.date]})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[g.status==="Izin"&&e.jsx("span",{className:"status-chip status-warning",children:"Izin"}),g.status==="Sakit"&&e.jsx("span",{className:"status-chip status-danger",children:"Sakit"}),g.status==="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Alfa"}),g.status==="Hadir"&&g.checkIn&&g.checkInStatus&&e.jsx("span",{className:`status-chip font-semibold ${g.checkInStatus==="early"?"bg-blue-100 text-blue-800 border-2 border-blue-400":g.checkInStatus==="onTime"?"bg-green-100 text-green-800 border-2 border-green-400":g.checkInStatus==="almostLate"?"bg-yellow-100 text-yellow-800 border-2 border-yellow-400":"bg-red-100 text-red-800 border-2 border-red-400"}`,children:g.checkInStatus==="early"?" Come Early":g.checkInStatus==="onTime"?" On Time":g.checkInStatus==="almostLate"?" Almost Late":" Late"}),g.status==="Hadir"&&g.checkIn&&!g.checkInStatus&&e.jsx("span",{className:"status-chip status-success",children:"Hadir"}),g.breakLate&&e.jsx("span",{className:"status-chip bg-orange-100 text-orange-800 border border-orange-300 font-medium",children:" Break Late"}),g.earlyLeave&&e.jsx("span",{className:"status-chip bg-blue-100 text-blue-800 border border-blue-300 font-medium",children:" Early Leave"}),!g.checkIn&&g.status!=="Izin"&&g.status!=="Sakit"&&g.status!=="Alfa"&&e.jsx("span",{className:"status-chip status-default",children:"Belum Absen"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Check In"}),e.jsx("div",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:g.checkIn||"-"})]}),(g.breakStart||g.breakEnd)&&e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Break"}),e.jsxs("div",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[g.breakStart||"-"," - ",g.breakEnd||"-"]})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Check Out"}),e.jsx("div",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:g.checkOut||"-"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[g.checkInPhotoPath?e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check In"}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:ke(g.checkInPhotoPath),alt:"Check In Photo",className:`w-full rounded-lg border shadow-sm object-cover transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`,onError:x=>{x.target.style.display="none";const q=x.target.parentElement.querySelector(".error-message");q&&(q.style.display="block")}}),e.jsx("div",{className:`error-message hidden text-sm text-center py-4 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Foto tidak tersedia"})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check In"}),e.jsx("div",{className:`text-sm text-center py-8 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Tidak ada foto"})]}),g.checkOutPhotoPath?e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check Out"}),e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:ke(g.checkOutPhotoPath),alt:"Check Out Photo",className:`w-full rounded-lg border shadow-sm object-cover transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`,onError:x=>{x.target.style.display="none";const q=x.target.parentElement.querySelector(".error-message");q&&(q.style.display="block")}}),e.jsx("div",{className:`error-message hidden text-sm text-center py-4 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Foto tidak tersedia"})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Foto Check Out"}),e.jsx("div",{className:`text-sm text-center py-8 rounded-lg border transition-colors ${t==="dark"?"text-gray-400 bg-gray-700 border-gray-600":"text-gray-500 bg-gray-50 border-gray-200"}`,children:"Tidak ada foto"})]})]}),_.filter(x=>x.attendanceId===g.id&&x.status==="Pending").length>0&&e.jsxs("div",{className:`rounded-lg p-4 border transition-colors mb-6 ${t==="dark"?"bg-yellow-900/20 border-yellow-700":"bg-yellow-50 border-yellow-200"}`,children:[e.jsx("div",{className:`text-sm font-medium mb-3 transition-colors ${t==="dark"?"text-yellow-300":"text-yellow-900"}`,children:"Request Perubahan Status"}),_.filter(x=>x.attendanceId===g.id&&x.status==="Pending").map(x=>e.jsxs("div",{className:`mb-3 p-3 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t==="dark"?"bg-red-900/50 text-red-300":"bg-red-100 text-red-700"}`,children:bt(x.currentStatus)}),e.jsx("span",{className:"text-gray-400",children:""}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t==="dark"?"bg-green-900/50 text-green-300":"bg-green-100 text-green-700"}`,children:yt(x.requestedStatus)})]}),e.jsx("div",{className:`text-sm mb-3 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:x.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ge(x),className:"px-3 py-1.5 text-xs font-medium bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:"Approve"}),e.jsx("button",{onClick:()=>Ge(x),className:"px-3 py-1.5 text-xs font-medium bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:"Reject"})]})]},x.id))]}),g.note&&e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-blue-900/30 border-blue-700":"bg-blue-50 border-blue-200"}`,children:[e.jsx("div",{className:`text-sm font-medium mb-1 transition-colors ${t==="dark"?"text-blue-300":"text-blue-900"}`,children:"Catatan"}),e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-blue-200":"text-blue-800"}`,children:g.note})]})]}),e.jsx("div",{className:`sticky bottom-0 border-t px-6 py-4 flex justify-end transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"}`,children:e.jsx("button",{onClick:()=>k(!1),className:"px-6 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium",children:"Tutup"})})]})}),Y&&$&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,onClick:()=>{oe(!1),X(null),F("")},children:e.jsxs("div",{className:`rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:`sticky top-0 border-b px-6 py-4 flex items-center justify-between transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:$.status==="Pending"?"Proses Request Perubahan Status":"Detail Request"}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:$.status==="Pending"?"Tinjau dan proses request perubahan status absensi":"Detail request yang sudah diproses"})]}),e.jsx("button",{onClick:()=>{oe(!1),X(null),F("")},className:`p-2 rounded-lg transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200 hover:bg-gray-700":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:`rounded-lg p-4 mb-6 border transition-colors ${t==="dark"?"bg-gray-700/50 border-gray-600":"bg-gradient-to-br from-indigo-50 to-purple-50 border-indigo-200"}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[(Ht=$.User)!=null&&Ht.profilePicture?e.jsx("img",{src:$.User.profilePicture.startsWith("data:")?$.User.profilePicture:ke($.User.profilePicture),alt:$.User.name,className:"w-16 h-16 rounded-full object-cover border-2 border-indigo-300"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center text-white text-xl font-bold",children:((_t=(Wt=(qt=$.User)==null?void 0:qt.name)==null?void 0:Wt.charAt(0))==null?void 0:_t.toUpperCase())||"U"}),e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:((Vt=$.User)==null?void 0:Vt.name)||`User ID: ${$.userId}`}),e.jsxs("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:["@",((Jt=$.User)==null?void 0:Jt.username)||"N/A"]}),((Gt=$.User)==null?void 0:Gt.department)&&e.jsx("p",{className:"text-xs mt-1 transition-colors text-gray-500",children:$.User.department})]})]})}),e.jsxs("div",{className:`rounded-lg p-6 mb-6 border-2 transition-colors ${t==="dark"?"bg-gray-700/30 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-bold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Perubahan Status"}),e.jsxs("div",{className:"flex items-center justify-center gap-4 flex-wrap",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`text-xs font-medium mb-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Status Saat Ini"}),e.jsx("div",{className:`px-4 py-3 rounded-lg border-2 font-semibold ${$.currentStatus==="late"||$.currentStatus==="breakLate"||$.currentStatus==="earlyLeave"?"bg-red-50 text-red-800 border-red-300":$.currentStatus==="almostLate"?"bg-yellow-50 text-yellow-800 border-yellow-300":"bg-gray-50 text-gray-800 border-gray-300"}`,children:bt($.currentStatus)})]}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("svg",{className:"w-8 h-8 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:`text-xs font-medium mb-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Status yang Diminta"}),e.jsx("div",{className:"px-4 py-3 rounded-lg border-2 font-semibold bg-green-50 text-green-800 border-green-300",children:yt($.requestedStatus)})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("label",{className:`block text-xs font-medium mb-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Tanggal Absensi"}),e.jsx("div",{className:`text-base font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:(Qt=$.Attendance)!=null&&Qt.date?new Date($.Attendance.date).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):"-"})]}),e.jsxs("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("label",{className:`block text-xs font-medium mb-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Status Request"}),e.jsx("div",{children:e.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ${$.status==="Pending"?"bg-yellow-100 text-yellow-800 border-2 border-yellow-400":$.status==="Approved"?"bg-green-100 text-green-800 border-2 border-green-400":"bg-red-100 text-red-800 border-2 border-red-400"}`,children:$.status==="Pending"?" Pending":$.status==="Approved"?" Approved":" Rejected"})})]})]}),e.jsxs("div",{className:`rounded-lg p-4 mb-6 border transition-colors ${t==="dark"?"bg-blue-900/20 border-blue-700":"bg-blue-50 border-blue-200"}`,children:[e.jsx("label",{className:`block text-sm font-semibold mb-2 transition-colors ${t==="dark"?"text-blue-300":"text-blue-900"}`,children:"Alasan / Deskripsi"}),e.jsx("p",{className:`text-sm leading-relaxed transition-colors ${t==="dark"?"text-blue-200":"text-blue-800"}`,children:$.description||"Tidak ada deskripsi"})]}),$.adminNote&&e.jsxs("div",{className:`rounded-lg p-4 mb-6 border transition-colors ${t==="dark"?"bg-purple-900/20 border-purple-700":"bg-purple-50 border-purple-200"}`,children:[e.jsx("label",{className:`block text-sm font-semibold mb-2 transition-colors ${t==="dark"?"text-purple-300":"text-purple-900"}`,children:"Catatan Admin"}),e.jsx("p",{className:`text-sm leading-relaxed transition-colors ${t==="dark"?"text-purple-200":"text-purple-800"}`,children:$.adminNote})]}),$.status==="Pending"&&e.jsxs("div",{className:`rounded-lg p-4 mb-6 border transition-colors ${t==="dark"?"bg-gray-700/50 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("label",{className:`block text-sm font-semibold mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Catatan Admin ",e.jsx("span",{className:"text-xs font-normal text-gray-500",children:"(Opsional)"})]}),e.jsx("textarea",{value:p,onChange:x=>F(x.target.value),rows:4,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"Tambahkan catatan untuk user (opsional)..."}),e.jsx("p",{className:`text-xs mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Catatan ini akan dikirim ke user setelah request diproses"})]})]}),$.status==="Pending"&&e.jsxs("div",{className:`sticky bottom-0 border-t px-6 py-4 flex items-center justify-end gap-3 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsx("button",{type:"button",onClick:()=>{oe(!1),X(null),F("")},className:`px-6 py-2.5 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsxs("button",{onClick:()=>Qe("Rejected"),disabled:h,className:"px-6 py-2.5 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),h?"Memproses...":"Tolak Request"]}),e.jsxs("button",{onClick:()=>Qe("Approved"),disabled:h,className:"px-6 py-2.5 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),h?"Memproses...":"Setujui Request"]})]}),$.status!=="Pending"&&e.jsx("div",{className:`sticky bottom-0 border-t px-6 py-4 flex items-center justify-end transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-gray-50 border-gray-200"}`,children:e.jsx("button",{onClick:()=>{oe(!1),X(null),F("")},className:"px-6 py-2.5 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium",children:"Tutup"})})]})}),H&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`w-full max-w-md rounded-xl shadow-2xl p-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Export Excel"}),e.jsx("button",{onClick:()=>f(!1),className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Tanggal Mulai ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:o.startDate,onChange:x=>B({...o,startDate:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Tanggal Akhir ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",value:o.endDate,onChange:x=>B({...o,endDate:x.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsx("div",{className:`border rounded-lg p-3 transition-colors ${t==="dark"?"bg-blue-900/30 border-blue-700":"bg-blue-50 border-blue-200"}`,children:e.jsxs("p",{className:`text-sm transition-colors ${t==="dark"?"text-blue-200":"text-blue-800"}`,children:[e.jsx("strong",{children:"Catatan:"})," File Excel akan berisi 2 sheet:",e.jsx("br",{})," Sheet 1: Data Absensi (check in, check out, break, status, dll)",e.jsx("br",{})," Sheet 2: Data Laporan Harian (konten laporan, file, dll)"]})})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>f(!1),className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{onClick:async()=>{var x,q;if(!o.startDate||!o.endDate){alert("Tanggal mulai dan tanggal akhir wajib diisi");return}if(new Date(o.startDate)>new Date(o.endDate)){alert("Tanggal mulai tidak boleh lebih besar dari tanggal akhir");return}M(!0);try{const te=localStorage.getItem("token"),le=await R.get(`${U}/api/reports/export-excel`,{params:{startDate:o.startDate,endDate:o.endDate},headers:{Authorization:`Bearer ${te}`},responseType:"blob"}),je=window.URL.createObjectURL(new Blob([le.data])),ye=document.createElement("a");ye.href=je,ye.setAttribute("download",`export_absensi_laporan_${o.startDate}_${o.endDate}.xlsx`),document.body.appendChild(ye),ye.click(),ye.remove(),window.URL.revokeObjectURL(je),f(!1),alert("Export berhasil! File sedang didownload.")}catch(te){console.error("Export error:",te),alert(((q=(x=te.response)==null?void 0:x.data)==null?void 0:q.message)||"Gagal export Excel")}finally{M(!1)}},disabled:ee,className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-lg hover:from-green-600 hover:to-emerald-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:ee?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Export & Download"]})})]})]})})]})}function Ln({status:t,theme:r}){const i={Pending:r==="dark"?"bg-yellow-900/50 text-yellow-300 border border-yellow-700":"bg-yellow-100 text-yellow-800",Approved:r==="dark"?"bg-green-900/50 text-green-300 border border-green-700":"bg-green-100 text-green-800",Rejected:r==="dark"?"bg-rose-900/50 text-rose-300 border border-rose-700":"bg-rose-100 text-rose-800"}[t]||(r==="dark"?"bg-gray-700 text-gray-300 border border-gray-600":"bg-gray-100 text-gray-800");return e.jsx("span",{className:`${i} px-3 py-1 rounded-full text-sm font-medium`,children:t})}function An(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState(!1),[a,l]=d.useState({status:"",userId:""}),[m,C]=d.useState([]),[b,y]=d.useState("Izin");d.useEffect(()=>{S(),j()},[]);async function j(){try{const c=localStorage.getItem("token"),L=await R.get(`${U}/api/users`,{headers:{Authorization:`Bearer ${c}`}});C(L.data)}catch(c){console.error(c)}}async function S(){n(!0);try{const c=localStorage.getItem("token");let v=(await R.get(`${U}/api/leaverequests`,{headers:{Authorization:`Bearer ${c}`}})).data||[];v=v.filter(w=>(w.type||"Izin")===b),a.status&&(v=v.filter(w=>w.status===a.status)),a.userId&&(v=v.filter(w=>w.userId===parseInt(a.userId))),s(v)}catch(c){console.error(c)}n(!1)}d.useEffect(()=>{S()},[a,b]);async function D(c,L){var v,w;try{const I=localStorage.getItem("token");await R.put(`${U}/api/leaverequests/${c}`,{status:L},{headers:{Authorization:`Bearer ${I}`}}),await S(),window.location.reload()}catch(I){alert(((w=(v=I.response)==null?void 0:v.data)==null?void 0:w.message)||"Action failed")}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Master ",e.jsx("span",{className:"gradient-text",children:"Izin/Cuti"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Lihat dan kelola semua pengajuan izin dan cuti"})]}),e.jsx("div",{className:`card-strong mb-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:`flex border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("button",{onClick:()=>y("Izin"),className:`px-6 py-3 font-medium text-sm transition-colors ${b==="Izin"?"border-b-2 border-indigo-500 text-indigo-600":t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-600 hover:text-gray-900"}`,children:" Izin"}),e.jsx("button",{onClick:()=>y("Cuti"),className:`px-6 py-3 font-medium text-sm transition-colors ${b==="Cuti"?"border-b-2 border-indigo-500 text-indigo-600":t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-600 hover:text-gray-900"}`,children:" Cuti"})]})}),e.jsxs("div",{className:`card-strong mb-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Filter Status"}),e.jsxs("select",{value:a.status,onChange:c=>l({...a,status:c.target.value}),className:`w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"Rejected",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Filter User"}),e.jsxs("select",{value:a.userId,onChange:c=>l({...a,userId:c.target.value}),className:`w-full p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Semua User"}),m.map(c=>e.jsxs("option",{value:c.id,children:[c.name," (",c.username,")"]},c.id))]})]})]}),e.jsx("div",{className:"mt-4 flex items-center gap-2",children:e.jsx("button",{onClick:()=>l({status:"",userId:""}),className:`px-4 py-2 text-sm rounded-lg transition-colors ${t==="dark"?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:"Reset Filter"})})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:`text-lg font-medium transition-colors ${t==="dark"?"text-white":""}`,children:["Pengajuan ",b]}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Total: ",r.length]})]}),i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[r.length===0&&e.jsxs("div",{className:"col-span-2 text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Tidak ada pengajuan"})]}),r.map(c=>e.jsx("div",{className:`border rounded-lg p-4 shadow-sm flex items-start gap-4 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between gap-4 mb-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`font-medium flex items-center gap-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[c.User?c.User.name:c.userId?`User ${c.userId}`:"Unknown",e.jsxs("span",{className:`text-xs font-normal transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["(",c.type||"Izin",")"]})]}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[c.startDate,"  ",c.endDate]})]}),e.jsx(Ln,{status:c.status,theme:t})]}),e.jsx("div",{className:`mt-2 text-sm rounded-lg p-2 border transition-colors ${t==="dark"?"text-gray-300 bg-gray-800 border-gray-600":"text-gray-700 bg-gray-50 border-gray-200"}`,children:c.reason||"Tidak ada alasan"}),e.jsx("div",{className:"mt-3 flex items-center gap-2",children:c.status==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>D(c.id,"Approved"),className:`px-3 py-1 rounded-lg transition-colors text-sm font-medium ${t==="dark"?"bg-green-900/50 text-green-300 hover:bg-green-900/70 border border-green-700":"bg-green-50 text-green-700 hover:bg-green-100"}`,children:"Approve"}),e.jsx("button",{onClick:()=>D(c.id,"Rejected"),className:`px-3 py-1 rounded-lg transition-colors text-sm font-medium ${t==="dark"?"bg-rose-900/50 text-rose-300 hover:bg-rose-900/70 border border-rose-700":"bg-rose-50 text-rose-700 hover:bg-rose-100"}`,children:"Reject"})]})})]})},c.id))]})]})]})}function Pn({status:t}){const s={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-rose-100 text-rose-800"}[t]||"bg-gray-100 text-gray-800";return e.jsx("span",{className:`${s} px-3 py-1 rounded-full text-sm font-medium`,children:t})}function Dn(){var W,Q;const[t,r]=d.useState([]),[s,i]=d.useState(!1),[n,a]=d.useState({status:""}),[l,m]=d.useState(""),[C,b]=d.useState(null),[y,j]=d.useState(!1),[S,D]=d.useState(null);d.useEffect(()=>{c()},[]),d.useEffect(()=>{c()},[n]);async function c(){i(!0);try{const N=localStorage.getItem("token");let g=(await R.get(`${U}/api/attendance-status-requests`,{headers:{Authorization:`Bearer ${N}`}})).data||[];n.status&&(g=g.filter(u=>u.status===n.status)),r(g)}catch(N){console.error(N),alert("Gagal memuat data request")}i(!1)}function L(N,k){b(N),D(k),m(""),j(!0)}async function v(){var N,k;if(C)try{const g=localStorage.getItem("token");await R.put(`${U}/api/attendance-status-requests/${C.id}`,{status:S==="approve"?"Approved":"Rejected",adminNote:l||void 0},{headers:{Authorization:`Bearer ${g}`}}),alert(`Request berhasil ${S==="approve"?"disetujui":"ditolak"}`),j(!1),b(null),m(""),c()}catch(g){console.error(g),alert(((k=(N=g.response)==null?void 0:N.data)==null?void 0:k.message)||"Gagal memproses request")}}function w(N){return{late:" Late",almostLate:" Almost Late",early:" Come Early",onTime:" On Time",breakLate:" Break Late",earlyLeave:" Early Leave",general:"Hadir"}[N]||N}function I(N){return{onTime:" On Time",almostLate:" Almost Late",early:" Come Early",normal:"Normal",onTimeCheckout:"On Time Checkout"}[N]||N}return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Request ",e.jsx("span",{className:"gradient-text",children:"Perubahan Status Absensi"})," "]}),e.jsx("p",{className:"text-gray-600",children:"Tinjau dan kelola request perubahan status absensi dari user"})]}),e.jsx("div",{className:"card-strong mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter Status"}),e.jsxs("select",{value:n.status,onChange:N=>a({...n,status:N.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"Rejected",children:"Rejected"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>a({status:""}),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:"Reset Filter"})})]})}),e.jsx("div",{className:"card-strong",children:s?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Memuat data..."})]}):e.jsxs("div",{className:"space-y-4",children:[t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:"text-gray-500",children:"Tidak ada request"})]}),t.map(N=>{var k,g;return e.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:((k=N.User)==null?void 0:k.name)||`User ID: ${N.userId}`}),e.jsx(Pn,{status:N.status})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsxs("div",{className:"font-medium text-gray-900 mb-1",children:["Tanggal Absensi: ",(g=N.Attendance)!=null&&g.date?new Date(N.Attendance.date).toLocaleDateString("id-ID"):"-"]}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("span",{className:"px-2 py-1 bg-red-50 text-red-700 rounded text-xs font-medium",children:w(N.currentStatus)}),e.jsx("span",{className:"text-gray-400",children:""}),e.jsx("span",{className:"px-2 py-1 bg-green-50 text-green-700 rounded text-xs font-medium",children:I(N.requestedStatus)})]})]}),e.jsxs("div",{className:"mt-3 text-sm text-gray-700 bg-gray-50 rounded-lg p-3 border border-gray-200",children:[e.jsx("div",{className:"font-medium text-gray-900 mb-1",children:"Deskripsi/Alasan:"}),e.jsx("div",{className:"text-gray-700 whitespace-pre-wrap",children:N.description||"Tidak ada deskripsi"})]}),N.adminNote&&e.jsxs("div",{className:"mt-2 text-sm text-gray-700 bg-blue-50 rounded-lg p-3 border border-blue-200",children:[e.jsx("div",{className:"font-medium text-gray-900 mb-1",children:"Catatan Admin:"}),e.jsx("div",{className:"text-gray-700",children:N.adminNote})]})]})}),e.jsx("div",{className:"mt-3 flex items-center gap-2",children:N.status==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>L(N,"approve"),className:"px-4 py-2 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors text-sm font-medium",children:"Approve"}),e.jsx("button",{onClick:()=>L(N,"reject"),className:"px-4 py-2 bg-rose-50 text-rose-700 rounded-lg hover:bg-rose-100 transition-colors text-sm font-medium",children:"Reject"})]})})]},N.id)})]})}),y&&C&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl p-6 max-w-md w-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:S==="approve"?"Approve Request":"Reject Request"}),e.jsx("button",{onClick:()=>{j(!1),b(null),m("")},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["User: ",((W=C.User)==null?void 0:W.name)||`User ID: ${C.userId}`]}),e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Tanggal: ",(Q=C.Attendance)!=null&&Q.date?new Date(C.Attendance.date).toLocaleDateString("id-ID"):"-"]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Catatan Admin ",S==="reject"?"(Opsional)":""]}),e.jsx("textarea",{value:l,onChange:N=>m(N.target.value),rows:4,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",placeholder:S==="approve"?"Catatan (opsional)...":"Alasan penolakan (opsional)..."})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{j(!1),b(null),m("")},className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Batal"}),e.jsx("button",{onClick:v,className:`px-4 py-2 rounded-lg transition-colors font-medium ${S==="approve"?"bg-green-500 text-white hover:bg-green-600":"bg-rose-500 text-white hover:bg-rose-600"}`,children:S==="approve"?"Approve":"Reject"})]})]})})]})}function Tn(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState([]),[a,l]=d.useState(!1),[m,C]=d.useState(!1),[b,y]=d.useState({reportStartTime:"08:00",reportEndTime:"18:00",reportFrequency:"daily"}),[j,S]=d.useState({userId:"",date:""}),[D,c]=d.useState([]),[L,v]=d.useState(null),[w,I]=d.useState([]),[W,Q]=d.useState({});d.useEffect(()=>{f(),N(),k(),g()},[]),d.useEffect(()=>{f()},[j]),d.useEffect(()=>{r.length>=0&&D.length>0&&B()},[r,D]),d.useEffect(()=>{L?o(L.id):I([])},[L]);async function N(){try{const T=localStorage.getItem("token"),Y=await R.get(`${U}/api/users`,{headers:{Authorization:`Bearer ${T}`}});c(Y.data)}catch(T){console.error(T)}}async function k(){try{const T=localStorage.getItem("token"),Y=await R.get(`${U}/api/daily-reports/settings`,{headers:{Authorization:`Bearer ${T}`}});y(Y.data)}catch(T){console.error(T)}}async function g(){try{const T=localStorage.getItem("token"),Y=await R.get(`${U}/api/daily-report-edit-requests/pending`,{headers:{Authorization:`Bearer ${T}`}});n(Y.data||[])}catch(T){console.error(T)}}async function u(T,Y){var oe,$;try{const X=localStorage.getItem("token"),p=Y==="Rejected"&&prompt("Masukkan catatan penolakan (opsional):")||"";await R.put(`${U}/api/daily-report-edit-requests/${T}`,{status:Y,adminNote:p||null},{headers:{Authorization:`Bearer ${X}`}}),await g(),await f(),window.location.reload()}catch(X){alert((($=(oe=X.response)==null?void 0:oe.data)==null?void 0:$.message)||"Gagal memproses request")}}function H(T){return i.find(Y=>Y.dailyReportId===T)}async function f(){l(!0);try{const T=localStorage.getItem("token");let oe=(await R.get(`${U}/api/daily-reports`,{headers:{Authorization:`Bearer ${T}`}})).data||[];j.userId&&(oe=oe.filter($=>$.userId===parseInt(j.userId))),j.date&&(oe=oe.filter($=>$.date===j.date)),s(oe)}catch(T){console.error(T)}l(!1)}async function o(T){try{const Y=localStorage.getItem("token"),X=((await R.get(`${U}/api/daily-reports`,{headers:{Authorization:`Bearer ${Y}`}})).data||[]).filter(p=>p.userId===T);I(X)}catch(Y){console.error(Y),I([])}}function B(){const T={};D.filter(oe=>oe.role==="user").forEach(oe=>{const $=r.filter(F=>F.userId===oe.id),X=new Date().toISOString().split("T")[0],p=$.some(F=>F.date===X);T[oe.id]={hasReport:p,reportCount:$.length}}),Q(T)}async function ee(){var T,Y;try{const oe=localStorage.getItem("token");await R.put(`${U}/api/daily-reports/settings`,b,{headers:{Authorization:`Bearer ${oe}`}}),alert("Pengaturan berhasil disimpan"),C(!1),await k()}catch(oe){alert(((Y=(T=oe.response)==null?void 0:T.data)==null?void 0:Y.message)||"Gagal menyimpan pengaturan")}}function M(T){return new Date(T).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function _(T){return T?new Date(T).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):""}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Master ",e.jsx("span",{className:"gradient-text",children:"Laporan"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Lihat dan kelola semua laporan harian dari semua user"})]}),e.jsx("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium",children:"Pengaturan Waktu"})]}),L?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>v(null),className:`px-4 py-2 rounded-lg transition-colors ${t==="dark"?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex items-center gap-3",children:[L.profilePicture?e.jsx("img",{src:ke(L.profilePicture),alt:L.name,className:`w-10 h-10 rounded-full object-cover border-2 transition-colors ${t==="dark"?"border-purple-500":"border-indigo-200"}`}):e.jsx("div",{className:`w-10 h-10 rounded-full bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center text-white font-bold border-2 transition-colors ${t==="dark"?"border-purple-500":"border-indigo-200"}`,children:(L.name||"U").slice(0,1).toUpperCase()}),e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:L.name}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:L.username})]})]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Laporan User"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Total: ",w.length," laporan"]})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsxs("div",{className:"space-y-4",children:[w.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Tidak ada laporan"})]}),w.map(T=>e.jsxs("div",{className:`border rounded-lg p-4 shadow-sm transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"mb-3",children:e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[M(T.date),"  Dikirim pada ",_(T.submittedAt),T.isLate&&e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium ${t==="dark"?"bg-red-900/50 text-red-300":"bg-red-100 text-red-800"}`,children:"Terlambat"})]})}),e.jsx("div",{className:`text-sm rounded-lg p-3 border whitespace-pre-wrap mb-3 transition-colors ${t==="dark"?"text-gray-300 bg-gray-800 border-gray-600":"text-gray-700 bg-gray-50 border-gray-200"}`,children:T.content}),T.filePath&&e.jsx("div",{className:"mt-3",children:T.fileType==="image"?e.jsx("img",{src:ke(T.filePath),alt:"Lampiran",className:`max-w-full h-auto rounded-lg border transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`}):e.jsxs("a",{href:ke(T.filePath),target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${t==="dark"?"bg-indigo-900/50 text-indigo-300 hover:bg-indigo-900/70":"bg-indigo-50 text-indigo-700 hover:bg-indigo-100"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsxs("span",{children:["Lihat PDF: ",T.fileName]})]})}),(()=>{const Y=H(T.id);return Y?e.jsxs("div",{className:`mt-4 p-4 border rounded-lg transition-colors ${t==="dark"?"bg-yellow-900/30 border-yellow-700":"bg-yellow-50 border-yellow-200"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:`w-5 h-5 transition-colors ${t==="dark"?"text-yellow-400":"text-yellow-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),e.jsx("span",{className:`font-semibold transition-colors ${t==="dark"?"text-yellow-300":"text-yellow-800"}`,children:"Request Edit Pending"})]})}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:`text-sm font-medium mb-1 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Alasan:"}),e.jsx("div",{className:`text-sm rounded p-2 border transition-colors ${t==="dark"?"text-gray-300 bg-gray-800 border-gray-600":"text-gray-600 bg-white border-yellow-200"}`,children:Y.reason||"Tidak ada alasan"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:`text-sm font-medium mb-1 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Konten Baru:"}),e.jsx("div",{className:`text-sm rounded p-2 border whitespace-pre-wrap transition-colors ${t==="dark"?"text-gray-300 bg-gray-800 border-gray-600":"text-gray-700 bg-white border-yellow-200"}`,children:Y.newContent})]}),Y.newFilePath&&e.jsx("div",{className:"mb-3",children:Y.newFileType==="image"?e.jsx("img",{src:ke(Y.newFilePath),alt:"File baru",className:`max-w-full h-auto rounded-lg border transition-colors ${t==="dark"?"border-gray-600":"border-yellow-200"}`}):e.jsxs("a",{href:ke(Y.newFilePath),target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center gap-2 px-3 py-1.5 rounded-lg transition-colors text-sm border ${t==="dark"?"bg-gray-800 text-indigo-300 hover:bg-gray-700 border-gray-600":"bg-white text-indigo-700 hover:bg-indigo-50 border-yellow-200"}`,children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsxs("span",{children:["File Baru: ",Y.newFileName]})]})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>u(Y.id,"Approved"),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm font-medium",children:"Approve"}),e.jsx("button",{onClick:()=>u(Y.id,"Rejected"),className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm font-medium",children:"Decline"})]})]}):null})()]},T.id))]})]})]}):e.jsx(e.Fragment,{children:e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Daftar User"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Total: ",D.filter(T=>T.role==="user").length," user"]})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:D.filter(T=>T.role==="user").map(T=>{const Y=W[T.id]||{hasReport:!1,reportCount:0};return e.jsxs("div",{onClick:()=>v(T),className:`border rounded-lg p-4 cursor-pointer hover:shadow-md transition-all ${t==="dark"?"bg-gray-700 border-gray-600 hover:border-purple-500":"bg-white border-gray-200 hover:border-indigo-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[T.profilePicture?e.jsx("img",{src:ke(T.profilePicture),alt:T.name,className:`w-12 h-12 rounded-full object-cover border-2 transition-colors ${t==="dark"?"border-purple-500":"border-indigo-200"}`}):e.jsx("div",{className:`w-12 h-12 rounded-full bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center text-white font-bold border-2 transition-colors ${t==="dark"?"border-purple-500":"border-indigo-200"}`,children:(T.name||"U").slice(0,1).toUpperCase()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`font-semibold truncate transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:T.name}),e.jsx("div",{className:`text-xs truncate transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:T.username})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:`text-xs px-2 py-1 rounded-full font-medium ${Y.hasReport?t==="dark"?"bg-green-900/50 text-green-300 border border-green-700":"bg-green-100 text-green-800 border border-green-300":t==="dark"?"bg-red-900/50 text-red-300 border border-red-700":"bg-red-100 text-red-800 border border-red-300"}`,children:Y.hasReport?" Sudah Laporan":" Belum Laporan"}),e.jsxs("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[Y.reportCount," laporan"]})]})]},T.id)})})]})}),m&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`w-full max-w-md rounded-xl shadow-2xl p-6 transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Pengaturan Waktu Submit Laporan"}),e.jsx("button",{onClick:()=>C(!1),className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Waktu Mulai Submit"}),e.jsx("input",{type:"time",value:b.reportStartTime,onChange:T=>y({...b,reportStartTime:T.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"User dapat mulai submit laporan dari jam ini"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Waktu Akhir Submit"}),e.jsx("input",{type:"time",value:b.reportEndTime,onChange:T=>y({...b,reportEndTime:T.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Jika submit melewati jam ini, laporan akan dianggap terlambat (tetap masuk)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Frekuensi Laporan"}),e.jsxs("select",{value:b.reportFrequency||"daily",onChange:T=>y({...b,reportFrequency:T.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"daily",children:"Setiap Hari (Wajib)"}),e.jsx("option",{value:"weekly",children:"Seminggu Sekali"})]}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:b.reportFrequency==="daily"?"User wajib membuat laporan setiap hari kerja":"User wajib membuat laporan minimal 1 kali dalam seminggu"})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>C(!1),className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{onClick:ee,className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium",children:"Simpan"})]})]})})]})}function Rn({status:t}){const s={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-rose-100 text-rose-800"}[t]||"bg-gray-100 text-gray-800";return e.jsx("span",{className:`${s} px-3 py-1 rounded-full text-sm font-medium`,children:t})}function En(){const[t,r]=d.useState([]),[s,i]=d.useState(!1),[n,a]=d.useState({status:"",userId:""}),[l,m]=d.useState([]);d.useEffect(()=>{b(),C()},[]),d.useEffect(()=>{b()},[n]);async function C(){try{const S=localStorage.getItem("token"),D=await R.get(`${API_URL}/api/users`,{headers:{Authorization:`Bearer ${S}`}});m(D.data)}catch(S){console.error(S)}}async function b(){i(!0);try{const S=localStorage.getItem("token");let c=(await R.get(`${API_URL}/api/daily-report-edit-requests`,{headers:{Authorization:`Bearer ${S}`}})).data||[];n.status&&(c=c.filter(L=>L.status===n.status)),n.userId&&(c=c.filter(L=>L.userId===parseInt(n.userId))),r(c)}catch(S){console.error(S)}i(!1)}async function y(S,D,c=""){var L,v;try{const w=localStorage.getItem("token");await R.put(`${API_URL}/api/daily-report-edit-requests/${S}`,{status:D,adminNote:c},{headers:{Authorization:`Bearer ${w}`}}),await b(),window.location.reload()}catch(w){alert(((v=(L=w.response)==null?void 0:L.data)==null?void 0:v.message)||"Action failed")}}function j(S){return new Date(S).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:["Master ",e.jsx("span",{className:"gradient-text",children:"Request Edit Laporan"})," "]}),e.jsx("p",{className:"text-gray-600",children:"Kelola semua request edit laporan dari user"})]}),e.jsxs("div",{className:"card-strong mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter Status"}),e.jsxs("select",{value:n.status,onChange:S=>a({...n,status:S.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Semua Status"}),e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"Rejected",children:"Rejected"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter User"}),e.jsxs("select",{value:n.userId,onChange:S=>a({...n,userId:S.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"Semua User"}),l.map(S=>e.jsxs("option",{value:S.id,children:[S.name," (",S.username,")"]},S.id))]})]})]}),e.jsx("div",{className:"mt-4 flex items-center gap-2",children:e.jsx("button",{onClick:()=>a({status:"",userId:""}),className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:"Reset Filter"})})]}),e.jsxs("div",{className:"card-strong",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Semua Request"}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",t.length]})]}),s?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:"mt-2 text-gray-500",children:"Memuat data..."})]}):e.jsxs("div",{className:"space-y-4",children:[t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-300 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-gray-500",children:"Tidak ada request"})]}),t.map(S=>{var D,c;return e.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900 mb-1",children:((D=S.User)==null?void 0:D.name)||`User ${S.userId}`}),e.jsxs("div",{className:"text-sm text-gray-500",children:["Laporan tanggal: ",j(((c=S.DailyReport)==null?void 0:c.date)||S.createdAt)]})]}),e.jsx(Rn,{status:S.status})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Alasan Edit:"}),e.jsx("div",{className:"text-sm text-gray-600 bg-gray-50 rounded-lg p-2 border border-gray-200",children:S.reason||"Tidak ada alasan"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Konten Baru:"}),e.jsx("div",{className:"text-sm text-gray-700 bg-gray-50 rounded-lg p-3 border border-gray-200 whitespace-pre-wrap",children:S.newContent})]}),S.newFilePath&&e.jsx("div",{className:"mb-3",children:S.newFileType==="image"?e.jsx("img",{src:getFileUrl(S.newFilePath),alt:"File baru",className:"max-w-full h-auto rounded-lg border border-gray-200"}):e.jsxs("a",{href:getFileUrl(S.newFilePath),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-indigo-50 text-indigo-700 rounded-lg hover:bg-indigo-100 transition-colors",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsxs("span",{children:["Lihat PDF: ",S.newFileName]})]})}),S.status==="Pending"&&e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(S.id,"Approved"),className:"px-3 py-1 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors text-sm font-medium",children:"Approve"}),e.jsx("button",{onClick:()=>{const L=prompt("Masukkan catatan penolakan (opsional):");L!==null&&y(S.id,"Rejected",L)},className:"px-3 py-1 bg-rose-50 text-rose-700 rounded-lg hover:bg-rose-100 transition-colors text-sm font-medium",children:"Reject"})]}),S.adminNote&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 italic",children:["Catatan admin: ",S.adminNote]})]},S.id)})]})]})]})}const Mn=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})});function Bn(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState([]),[a,l]=d.useState(!1),[m,C]=d.useState(null),[b,y]=d.useState([]),[j,S]=d.useState(!1),[D,c]=d.useState(!1),[L,v]=d.useState(!1),[w,I]=d.useState(null),[W,Q]=d.useState(!1),[N,k]=d.useState(!1),[g,u]=d.useState({alphaDeduction:0,izinDeduction:0,lateDeduction:0,breakLateDeduction:0,earlyLeaveDeduction:0,noReportDeduction:0,maxLateAllowed:0,maxBreakLateAllowed:0,maxEarlyLeaveAllowed:0,deductionType:"percentage",perfectAttendanceBonus:0,allReportsBonus:0,isActive:!0}),[H,f]=d.useState({userId:"",month:new Date().toISOString().slice(0,7)});d.useEffect(()=>{o(),B()},[]);async function o(){try{const p=localStorage.getItem("token"),F=await R.get(`${U}/api/users`,{headers:{Authorization:`Bearer ${p}`}});s(F.data)}catch(p){console.error(p),alert("Gagal memuat data user")}}async function B(){l(!0);try{const p=localStorage.getItem("token"),F=await R.get(`${U}/api/payroll-settings`,{headers:{Authorization:`Bearer ${p}`}});n(F.data)}catch(p){console.error(p),alert("Gagal memuat data payroll settings")}l(!1)}function ee(p){const F=i.find(h=>h.userId===p.id);u(F?{alphaDeduction:F.alphaDeduction||0,izinDeduction:F.izinDeduction||0,lateDeduction:F.lateDeduction||0,breakLateDeduction:F.breakLateDeduction||0,earlyLeaveDeduction:F.earlyLeaveDeduction||0,noReportDeduction:F.noReportDeduction||0,maxLateAllowed:F.maxLateAllowed||0,maxBreakLateAllowed:F.maxBreakLateAllowed||0,maxEarlyLeaveAllowed:F.maxEarlyLeaveAllowed||0,deductionType:F.deductionType||"percentage",perfectAttendanceBonus:F.perfectAttendanceBonus||0,allReportsBonus:F.allReportsBonus||0,isActive:F.isActive!==void 0?F.isActive:!0}:{alphaDeduction:0,izinDeduction:0,lateDeduction:0,breakLateDeduction:0,earlyLeaveDeduction:0,noReportDeduction:0,maxLateAllowed:0,maxBreakLateAllowed:0,maxEarlyLeaveAllowed:0,deductionType:"percentage",perfectAttendanceBonus:0,allReportsBonus:0,isActive:!0}),C(p),S(!0)}async function M(p){var F,h;p.preventDefault(),Q(!0);try{const E=localStorage.getItem("token");await R.post(`${U}/api/payroll-settings/user/${m.id}`,g,{headers:{Authorization:`Bearer ${E}`}}),alert("Pengaturan payroll berhasil disimpan"),S(!1),C(null),B()}catch(E){console.error(E),alert(((h=(F=E.response)==null?void 0:F.data)==null?void 0:h.message)||"Gagal menyimpan pengaturan payroll")}Q(!1)}async function _(p){var F,h;if(p.preventDefault(),!H.userId||!H.month){alert("Pilih user dan bulan terlebih dahulu");return}try{const E=localStorage.getItem("token"),z=await R.get(`${U}/api/payroll-settings/calculate`,{params:{userId:H.userId,month:H.month},headers:{Authorization:`Bearer ${E}`}});I(z.data)}catch(E){console.error(E),alert(((h=(F=E.response)==null?void 0:F.data)==null?void 0:h.message)||"Gagal menghitung payroll")}}function T(p){return i.find(F=>F.userId===p)}function Y(p){y(F=>F.includes(p)?F.filter(h=>h!==p):[...F,p])}function oe(){b.length===r.length?y([]):y(r.map(p=>p.id))}function $(){if(b.length===0){alert("Pilih minimal satu user terlebih dahulu");return}u({alphaDeduction:0,izinDeduction:0,lateDeduction:0,breakLateDeduction:0,earlyLeaveDeduction:0,noReportDeduction:0,maxLateAllowed:0,maxBreakLateAllowed:0,maxEarlyLeaveAllowed:0,deductionType:"percentage",perfectAttendanceBonus:0,allReportsBonus:0,isActive:!0}),c(!0)}async function X(p){if(p.preventDefault(),b.length===0){alert("Pilih minimal satu user terlebih dahulu");return}k(!0);try{const F=localStorage.getItem("token");let h=0,E=0;for(const z of b)try{await R.post(`${U}/api/payroll-settings/user/${z}`,g,{headers:{Authorization:`Bearer ${F}`}}),h++}catch(Z){console.error(`Error saving for user ${z}:`,Z),E++}h>0?alert(`Pengaturan payroll berhasil disimpan untuk ${h} user${h>1,""}${E>0?` (${E} gagal)`:""}`):alert("Gagal menyimpan pengaturan payroll untuk semua user"),c(!1),y([]),B()}catch(F){console.error(F),alert("Gagal menyimpan pengaturan payroll")}k(!1)}return e.jsxs("div",{children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Master ",e.jsx("span",{className:"gradient-text",children:"Payroll"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Kelola pengaturan perhitungan payroll untuk setiap user"})]}),e.jsx("button",{onClick:()=>{f({userId:"",month:new Date().toISOString().slice(0,7)}),I(null),v(!0)},className:"px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-colors font-medium",children:"Hitung Payroll"})]})}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Pengaturan Payroll per User"}),b.length>0&&e.jsxs("p",{className:`text-sm mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:[b.length," user dipilih"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[b.length>0&&e.jsxs("button",{onClick:$,className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Atur untuk ",b.length," User"]}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:[r.length," user"]})]})]}),a?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("th",{className:`text-left p-4 text-sm font-semibold w-12 transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:e.jsx("input",{type:"checkbox",checked:b.length===r.length&&r.length>0,onChange:oe,className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"})}),e.jsx("th",{className:`text-left p-4 text-sm font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Nama"}),e.jsx("th",{className:`text-left p-4 text-sm font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Employee ID"}),e.jsx("th",{className:`text-left p-4 text-sm font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Posisi"}),e.jsx("th",{className:`text-left p-4 text-sm font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Gaji Pokok"}),e.jsx("th",{className:`text-left p-4 text-sm font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Status"}),e.jsx("th",{className:`text-left p-4 text-sm font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Aksi"})]})}),e.jsx("tbody",{children:r.map(p=>{const F=T(p.id),h=b.includes(p.id);return e.jsxs("tr",{className:`border-b transition-colors ${t==="dark"?`border-gray-700 hover:bg-gray-700/50 ${h?"bg-indigo-900/30":""}`:`border-gray-100 hover:bg-gray-50 ${h?"bg-indigo-50":""}`}`,children:[e.jsx("td",{className:"p-4",children:e.jsx("input",{type:"checkbox",checked:h,onChange:()=>Y(p.id),className:"w-4 h-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500"})}),e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:p.name}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["@",p.username]})]}),e.jsx("td",{className:`p-4 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:p.employeeId||"-"}),e.jsx("td",{className:`p-4 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:p.position||"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:p.basicSalary?`${p.currency||"IDR"} ${parseFloat(p.basicSalary).toLocaleString("id-ID")}`:"-"})}),e.jsx("td",{className:"p-4",children:F?e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${F.isActive?t==="dark"?"bg-green-700 text-green-100":"bg-green-100 text-green-800":t==="dark"?"bg-gray-700 text-gray-100":"bg-gray-100 text-gray-800"}`,children:F.isActive?"Aktif":"Nonaktif"}):e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t==="dark"?"bg-yellow-700 text-yellow-100":"bg-yellow-100 text-yellow-800"}`,children:"Belum Diatur"})}),e.jsx("td",{className:"p-4",children:e.jsxs("button",{onClick:()=>ee(p),className:"px-3 py-1.5 bg-indigo-500 text-white rounded hover:bg-indigo-600 transition-colors text-sm font-medium flex items-center gap-2",children:[e.jsx(Mn,{}),F?"Edit":"Atur"]})})]},p.id)})})]})})]}),j&&m&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`rounded-xl shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Pengaturan Payroll: ",m.name]}),e.jsx("button",{onClick:()=>{S(!1),C(null)},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Tipe Deduction *"}),e.jsxs("select",{required:!0,value:g.deductionType,onChange:p=>u({...g,deductionType:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"percentage",children:"Persentase (%)"}),e.jsx("option",{value:"fixed",children:"Jumlah Tetap"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status"}),e.jsxs("select",{value:g.isActive?"true":"false",onChange:p=>u({...g,isActive:p.target.value==="true"}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"true",children:"Aktif"}),e.jsx("option",{value:"false",children:"Nonaktif"})]})]})]}),e.jsxs("div",{className:`border-t pt-4 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Deduction untuk Pelanggaran"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Alpha ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.alphaDeduction,onChange:p=>u({...g,alphaDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Izin ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.izinDeduction,onChange:p=>u({...g,izinDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Telat ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.lateDeduction,onChange:p=>u({...g,lateDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Maks Telat Diizinkan"}),e.jsx("input",{type:"number",value:g.maxLateAllowed,onChange:p=>u({...g,maxLateAllowed:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"0 = semua telat kena deduction"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Istirahat Terlambat ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.breakLateDeduction,onChange:p=>u({...g,breakLateDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Maks Istirahat Terlambat Diizinkan"}),e.jsx("input",{type:"number",value:g.maxBreakLateAllowed,onChange:p=>u({...g,maxBreakLateAllowed:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"0 = semua kena deduction"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Pulang Cepat ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.earlyLeaveDeduction,onChange:p=>u({...g,earlyLeaveDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Maks Pulang Cepat Diizinkan"}),e.jsx("input",{type:"number",value:g.maxEarlyLeaveAllowed,onChange:p=>u({...g,maxEarlyLeaveAllowed:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"0 = semua kena deduction"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Tidak Ada Laporan ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.noReportDeduction,onChange:p=>u({...g,noReportDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]})]})]}),e.jsxs("div",{className:`border-t pt-4 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Bonus"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Bonus Absensi Sempurna ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.perfectAttendanceBonus,onChange:p=>u({...g,perfectAttendanceBonus:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Diberikan jika tidak ada alpha, izin, telat, istirahat terlambat, atau pulang cepat"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Bonus Semua Laporan ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.allReportsBonus,onChange:p=>u({...g,allReportsBonus:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Diberikan jika semua laporan harian sudah disubmit"})]})]})]}),e.jsxs("div",{className:`flex items-center justify-end gap-3 pt-4 border-t transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("button",{type:"button",onClick:()=>{S(!1),C(null)},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{type:"submit",disabled:W,className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:W?"Menyimpan...":"Simpan Pengaturan"})]})]})]})}),D&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`rounded-xl shadow-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Pengaturan Payroll untuk ",b.length," User"]}),e.jsx("p",{className:`text-sm mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Pengaturan ini akan diterapkan ke semua user yang dipilih"})]}),e.jsx("button",{onClick:()=>{c(!1)},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:X,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Tipe Deduction *"}),e.jsxs("select",{required:!0,value:g.deductionType,onChange:p=>u({...g,deductionType:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"percentage",children:"Persentase (%)"}),e.jsx("option",{value:"fixed",children:"Jumlah Tetap"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status"}),e.jsxs("select",{value:g.isActive?"true":"false",onChange:p=>u({...g,isActive:p.target.value==="true"}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"true",children:"Aktif"}),e.jsx("option",{value:"false",children:"Nonaktif"})]})]})]}),e.jsxs("div",{className:`border-t pt-4 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Deduction untuk Pelanggaran"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Alpha ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.alphaDeduction,onChange:p=>u({...g,alphaDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Izin ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.izinDeduction,onChange:p=>u({...g,izinDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Telat ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.lateDeduction,onChange:p=>u({...g,lateDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Maks Telat Diizinkan"}),e.jsx("input",{type:"number",value:g.maxLateAllowed,onChange:p=>u({...g,maxLateAllowed:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"0 = semua telat kena deduction"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Istirahat Terlambat ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.breakLateDeduction,onChange:p=>u({...g,breakLateDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Maks Istirahat Terlambat Diizinkan"}),e.jsx("input",{type:"number",value:g.maxBreakLateAllowed,onChange:p=>u({...g,maxBreakLateAllowed:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"0 = semua kena deduction"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Pulang Cepat ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.earlyLeaveDeduction,onChange:p=>u({...g,earlyLeaveDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Maks Pulang Cepat Diizinkan"}),e.jsx("input",{type:"number",value:g.maxEarlyLeaveAllowed,onChange:p=>u({...g,maxEarlyLeaveAllowed:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"0 = semua kena deduction"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Deduction Tidak Ada Laporan ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.noReportDeduction,onChange:p=>u({...g,noReportDeduction:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]})]})]}),e.jsxs("div",{className:`border-t pt-4 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Bonus"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Bonus Absensi Sempurna ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.perfectAttendanceBonus,onChange:p=>u({...g,perfectAttendanceBonus:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Diberikan jika tidak ada alpha, izin, telat, istirahat terlambat, atau pulang cepat"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Bonus Semua Laporan ",g.deductionType==="percentage"?"(%)":"(Jumlah)"]}),e.jsx("input",{type:"number",step:"0.01",value:g.allReportsBonus,onChange:p=>u({...g,allReportsBonus:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`}),e.jsx("p",{className:`text-xs mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Diberikan jika semua laporan harian sudah disubmit"})]})]})]}),e.jsx("div",{className:`border rounded-lg p-4 transition-colors ${t==="dark"?"bg-blue-900/30 border-blue-700":"bg-blue-50 border-blue-200"}`,children:e.jsxs("p",{className:`text-sm transition-colors ${t==="dark"?"text-blue-200":"text-blue-800"}`,children:[e.jsx("strong",{children:"Info:"})," Pengaturan ini akan diterapkan ke ",b.length," user yang dipilih. Jika user sudah memiliki pengaturan, pengaturan lama akan diganti dengan pengaturan baru ini."]})}),e.jsxs("div",{className:`flex items-center justify-end gap-3 pt-4 border-t transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("button",{type:"button",onClick:()=>{c(!1)},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{type:"submit",disabled:N,className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:N?`Menyimpan untuk ${b.length} user...`:`Simpan untuk ${b.length} User`})]})]})]})}),L&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`rounded-xl shadow-2xl p-6 max-w-3xl w-full max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Hitung Payroll"}),e.jsx("button",{onClick:()=>{v(!1),I(null)},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:_,className:"space-y-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Pilih User *"}),e.jsxs("select",{required:!0,value:H.userId,onChange:p=>f({...H,userId:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih User..."}),r.map(p=>e.jsxs("option",{value:p.id,children:[p.name," (",p.employeeId,")"]},p.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Bulan *"}),e.jsx("input",{type:"month",required:!0,value:H.month,onChange:p=>f({...H,month:p.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsx("button",{type:"submit",className:"w-full px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-colors font-medium",children:"Hitung Payroll"})]}),w&&e.jsxs("div",{className:`border-t pt-4 transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Hasil Perhitungan"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t==="dark"?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Gaji Pokok"}),e.jsxs("div",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[w.currency," ",parseFloat(w.baseSalary).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t==="dark"?"bg-red-900/30":"bg-red-50"}`,children:[e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-red-300":"text-red-600"}`,children:"Total Deduction"}),e.jsxs("div",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-red-200":"text-red-700"}`,children:[w.currency," ",parseFloat(w.deductions).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t==="dark"?"bg-green-900/30":"bg-green-50"}`,children:[e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-green-300":"text-green-600"}`,children:"Total Bonus"}),e.jsxs("div",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-green-200":"text-green-700"}`,children:[w.currency," ",parseFloat(w.bonuses).toLocaleString("id-ID")]})]}),e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t==="dark"?"bg-indigo-900/30":"bg-indigo-50"}`,children:[e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-indigo-300":"text-indigo-600"}`,children:"Gaji Final"}),e.jsxs("div",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-indigo-200":"text-indigo-700"}`,children:[w.currency," ",parseFloat(w.finalSalary).toLocaleString("id-ID")]})]})]}),e.jsxs("div",{className:`p-4 rounded-lg transition-colors ${t==="dark"?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h4",{className:`font-semibold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Detail:"}),e.jsxs("div",{className:`text-sm space-y-1 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("div",{children:["Hari Kerja: ",w.details.workingDays," hari"]}),e.jsxs("div",{children:["Alpha: ",w.details.alphaCount," kali"]}),e.jsxs("div",{children:["Izin: ",w.details.izinCount," kali"]}),e.jsxs("div",{children:["Telat: ",w.details.lateCount," kali"]}),e.jsxs("div",{children:["Istirahat Terlambat: ",w.details.breakLateCount," kali"]}),e.jsxs("div",{children:["Pulang Cepat: ",w.details.earlyLeaveCount," kali"]}),e.jsxs("div",{children:["Laporan Diharapkan: ",w.details.expectedReports]}),e.jsxs("div",{children:["Laporan Tersubmit: ",w.details.submittedReports]}),e.jsxs("div",{children:["Laporan Hilang: ",w.details.missingReports]})]})]})]})]})]})})]})}function Fn(){var W,Q,N;const{theme:t}=Ne(),[r,s]=d.useState(null),[i,n]=d.useState(!1),[a,l]=d.useState("monthly"),[m,C]=d.useState(new Date().toISOString().slice(0,7)),[b,y]=d.useState(new Date().getFullYear().toString()),[j,S]=d.useState(null),[D,c]=d.useState(!1);d.useEffect(()=>{L()},[a,m,b]);async function L(){var k,g;n(!0);try{const u=localStorage.getItem("token");let H=`${U}/api/performance?mode=${a}`;a==="yearly"?H+=`&year=${b}`:H+=`&month=${m}`;const f=await R.get(H,{headers:{Authorization:`Bearer ${u}`}});s(f.data)}catch(u){console.error(u),alert(((g=(k=u.response)==null?void 0:k.data)==null?void 0:g.message)||"Gagal memuat data KPI")}n(!1)}function v(k){return t==="dark"?k>=80?"text-green-300 bg-green-900/30 border-green-700":k>=60?"text-yellow-300 bg-yellow-900/30 border-yellow-700":"text-red-300 bg-red-900/30 border-red-700":k>=80?"text-green-600 bg-green-50 border-green-200":k>=60?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200"}function w(k){return k>=80?"Excellent":k>=60?"Good":"Needs Improvement"}async function I(k){var g,u;try{const H=localStorage.getItem("token");let f=`${U}/api/performance/user/${k}?mode=${a}`;a==="yearly"?f+=`&year=${b}`:f+=`&month=${m}`;const o=await R.get(f,{headers:{Authorization:`Bearer ${H}`}});S(o.data),c(!0)}catch(H){console.error(H),alert(((u=(g=H.response)==null?void 0:g.data)==null?void 0:u.message)||"Gagal memuat detail KPI user")}}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:`text-2xl font-semibold mb-1 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Performance KPI"}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Monitor kinerja dan KPI semua user"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Mode"}),e.jsxs("select",{value:a,onChange:k=>l(k.target.value),className:`p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"monthly",children:"Bulanan"}),e.jsx("option",{value:"yearly",children:"Tahunan"})]})]}),a==="monthly"?e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Bulan"}),e.jsx("input",{type:"month",value:m,onChange:k=>C(k.target.value),className:`p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}):e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Tahun"}),e.jsx("input",{type:"number",value:b,onChange:k=>y(k.target.value),min:"2020",max:"2099",className:`p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-32 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"YYYY"})]}),e.jsx("button",{onClick:L,className:"px-4 py-2 text-sm font-medium bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Refresh"})]})]}),r&&e.jsx("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base font-medium mb-1 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Rata-rata KPI"}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:a==="yearly"?`Tahun ${r.period}`:`Bulan ${new Date(r.period+"-01").toLocaleDateString("id-ID",{month:"long",year:"numeric"})}`})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-3xl font-semibold transition-colors ${t==="dark"?"text-indigo-400":"text-indigo-600"}`,children:r.averageKPI.toFixed(2)}),e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"dari 100"})]})]})}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Daftar User & KPI"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Total: ",((W=r==null?void 0:r.users)==null?void 0:W.length)||0," user"]})]}),i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data KPI..."})]}):((Q=r==null?void 0:r.users)==null?void 0:Q.length)===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Tidak ada data KPI"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:`border-b transition-colors ${t==="dark"?"border-gray-700":"border-gray-200"}`,children:[e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Rank"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Nama"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Posisi"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"KPI Score"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Total Jam Kerja"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Izin"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Cuti"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Laporan"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Status"}),e.jsx("th",{className:`text-left py-3 px-4 font-semibold transition-colors ${t==="dark"?"text-gray-400":"text-gray-700"}`,children:"Aksi"})]})}),e.jsx("tbody",{children:(N=r==null?void 0:r.users)==null?void 0:N.map((k,g)=>e.jsxs("tr",{className:`border-b transition-colors ${t==="dark"?`border-gray-700 hover:bg-gray-700/50 ${k.isBelowAverage?"bg-red-900/20":""}`:`border-gray-100 hover:bg-gray-50 ${k.isBelowAverage?"bg-red-50/50":""}`}`,children:[e.jsx("td",{className:"py-3 px-4",children:e.jsxs("span",{className:`font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["#",g+1]})}),e.jsx("td",{className:"py-3 px-4",children:e.jsxs("div",{children:[e.jsx("div",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:k.name}),e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:k.username})]})}),e.jsx("td",{className:`py-3 px-4 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:k.position||"-"}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold border ${v(k.kpiScore)}`,children:k.kpiScore.toFixed(2)})}),e.jsxs("td",{className:`py-3 px-4 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[k.metrics.totalWorkHours.toFixed(1)," jam"]}),e.jsxs("td",{className:`py-3 px-4 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[k.metrics.izinCount," hari"]}),e.jsxs("td",{className:`py-3 px-4 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[k.metrics.cutiCount," hari"]}),e.jsxs("td",{className:`py-3 px-4 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[k.metrics.reportCount," ",a==="yearly"?"/thn":"/bln"]}),e.jsx("td",{className:"py-3 px-4",children:k.isBelowAverage?e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-red-400":"text-red-600"}`,children:"Di Bawah Rata-rata"}):e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-green-400":"text-green-600"}`,children:"Normal"})}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("button",{onClick:()=>I(k.userId),className:"px-3 py-1.5 text-sm bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:"Detail"})})]},k.userId))})]})})]}),D&&j&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-lg shadow-lg p-6 max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:`text-lg font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Detail KPI - ",j.name]}),e.jsx("button",{onClick:()=>c(!1),className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:`rounded-lg p-4 border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"KPI Score"}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:j.mode==="yearly"||a==="yearly"?`Tahun ${j.period||j.month||b}`:`Bulan ${new Date((j.period||j.month||m)+"-01").toLocaleDateString("id-ID",{month:"long",year:"numeric"})}`})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-3xl font-semibold ${v(j.kpiScore).split(" ")[0]}`,children:j.kpiScore.toFixed(2)}),e.jsx("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:w(j.kpiScore)})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:`border rounded-lg p-4 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Total Jam Kerja"}),e.jsx("div",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.metrics.totalWorkHours.toFixed(1)}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"jam"})]}),e.jsxs("div",{className:`border rounded-lg p-4 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Hari Hadir"}),e.jsx("div",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.metrics.presentDays}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"hari"})]}),e.jsxs("div",{className:`border rounded-lg p-4 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Izin"}),e.jsx("div",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.metrics.izinCount}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"hari"})]}),e.jsxs("div",{className:`border rounded-lg p-4 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Cuti"}),e.jsx("div",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.metrics.cutiCount}),e.jsx("div",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"hari"})]}),e.jsxs("div",{className:`border rounded-lg p-4 col-span-2 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Laporan"}),e.jsxs("div",{className:`text-2xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[j.metrics.reportCount," ",a==="yearly"||j.mode==="yearly"?"/thn":"/bln"]})]})]}),j.breakdown&&e.jsxs("div",{className:`rounded-lg p-4 transition-colors ${t==="dark"?"bg-gray-700":"bg-gray-50"}`,children:[e.jsx("h4",{className:`font-semibold mb-3 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Breakdown KPI"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Jam Kerja (40%)"}),e.jsx("span",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.breakdown.workHoursScore.toFixed(2)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Laporan (30%)"}),e.jsx("span",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.breakdown.reportsScore.toFixed(2)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Izin Penalty (15%)"}),e.jsx("span",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.breakdown.izinPenalty.toFixed(2)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Cuti Penalty (15%)"}),e.jsx("span",{className:`font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:j.breakdown.cutiPenalty.toFixed(2)})]})]})]}),r&&j.kpiScore<r.averageKPI&&e.jsx("div",{className:`border rounded-lg p-4 transition-colors ${t==="dark"?"bg-red-900/30 border-red-700":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium mb-1 transition-colors ${t==="dark"?"text-red-200":"text-red-900"}`,children:"Perhatian"}),e.jsxs("p",{className:`text-sm transition-colors ${t==="dark"?"text-red-300":"text-red-700"}`,children:["KPI user ini (",j.kpiScore.toFixed(2),") berada di bawah rata-rata (",r.averageKPI.toFixed(2),"). Disarankan untuk melakukan monitoring lebih lanjut atau memberikan teguran langsung kepada user."]})]})})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>c(!1),className:`px-4 py-2 text-sm font-medium rounded-lg hover:opacity-80 transition-colors ${t==="dark"?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Tutup"})})]})})]})}function On(){const{theme:t}=Ne(),[r,s]=d.useState(null),[i,n]=d.useState(!1),[a,l]=d.useState("monthly"),[m,C]=d.useState(new Date().toISOString().slice(0,7)),[b,y]=d.useState(new Date().getFullYear().toString());d.useEffect(()=>{j()},[a,m,b]);async function j(){var c,L;n(!0);try{const v=localStorage.getItem("token");if(!JSON.parse(localStorage.getItem("user")||"{}").id){alert("User data tidak ditemukan");return}let I=`${U}/api/performance/me?mode=${a}`;a==="yearly"?I+=`&year=${b}`:I+=`&month=${m}`;const W=await R.get(I,{headers:{Authorization:`Bearer ${v}`}});s(W.data)}catch(v){console.error(v),alert(((L=(c=v.response)==null?void 0:c.data)==null?void 0:L.message)||"Gagal memuat data KPI")}n(!1)}function S(c){return t==="dark"?c>=80?"text-green-300 bg-green-900/30 border-green-700":c>=60?"text-yellow-300 bg-yellow-900/30 border-yellow-700":"text-red-300 bg-red-900/30 border-red-700":c>=80?"text-green-600 bg-green-50 border-green-200":c>=60?"text-yellow-600 bg-yellow-50 border-yellow-200":"text-red-600 bg-red-50 border-red-200"}function D(c){return c>=80?" Excellent":c>=60?" Good":" Needs Improvement"}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Performance ",e.jsx("span",{className:"gradient-text",children:"KPI Saya"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Lihat kinerja dan KPI Anda"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Mode"}),e.jsxs("select",{value:a,onChange:c=>l(c.target.value),className:`p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"monthly",children:"Bulanan"}),e.jsx("option",{value:"yearly",children:"Tahunan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:a==="yearly"?"Tahun":"Bulan"}),a==="yearly"?e.jsx("input",{type:"number",value:b,onChange:c=>y(c.target.value),min:"2020",max:"2099",className:`p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 w-32 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"YYYY"}):e.jsx("input",{type:"month",value:m,onChange:c=>C(c.target.value),className:`p-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsx("button",{onClick:j,className:"btn btn-primary mt-6",children:"Refresh"})]})]}),i?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data KPI..."})]}):r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card-strong transition-colors bg-gradient-to-br from-[#26355D] to-[#1a2440] border-[#AF47D2]/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-lg font-semibold mb-1 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"KPI Score Anda"}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:a==="yearly"?`Tahun ${r.period}`:`Bulan ${new Date(r.period+"-01").toLocaleDateString("id-ID",{month:"long",year:"numeric"})}`})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`text-5xl font-bold ${S(r.kpiScore).split(" ")[0]}`,children:r.kpiScore.toFixed(2)}),e.jsx("div",{className:`text-sm mt-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:D(r.kpiScore)})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Total Jam Kerja"}),e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:r.metrics.totalWorkHours.toFixed(1)}),e.jsx("div",{className:"text-xs mt-1 transition-colors text-gray-500",children:"jam"})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Hari Hadir"}),e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:r.metrics.presentDays}),e.jsx("div",{className:"text-xs mt-1 transition-colors text-gray-500",children:"hari"})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Izin"}),e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:r.metrics.izinCount}),e.jsx("div",{className:"text-xs mt-1 transition-colors text-gray-500",children:"hari"})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Cuti"}),e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:r.metrics.cutiCount}),e.jsx("div",{className:"text-xs mt-1 transition-colors text-gray-500",children:"hari"})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Laporan"}),e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:r.metrics.reportCount}),e.jsxs("div",{className:"text-xs mt-1 transition-colors text-gray-500",children:[r.metrics.reportFrequency==="weekly"?"Mingguan":"Harian","  laporan dibuat"]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:`text-sm mb-1 transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Rata-rata Jam/Hari"}),e.jsx("div",{className:`text-3xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:r.metrics.presentDays>0?(r.metrics.totalWorkHours/r.metrics.presentDays).toFixed(1):"0"}),e.jsx("div",{className:"text-xs mt-1 transition-colors text-gray-500",children:"jam per hari"})]})]}),r.breakdown&&e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Breakdown KPI"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Jam Kerja (40%)"}),e.jsxs("span",{className:`text-sm font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[r.breakdown.workHoursScore.toFixed(2)," / 100"]})]}),e.jsx("div",{className:`w-full rounded-full h-2 transition-colors ${t==="dark"?"bg-gray-700":"bg-gray-200"}`,children:e.jsx("div",{className:"bg-indigo-600 h-2 rounded-full transition-all",style:{width:`${r.breakdown.workHoursScore}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Laporan (30%)"}),e.jsxs("span",{className:`text-sm font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[r.breakdown.reportsScore.toFixed(2)," / 100"]})]}),e.jsx("div",{className:`w-full rounded-full h-2 transition-colors ${t==="dark"?"bg-gray-700":"bg-gray-200"}`,children:e.jsx("div",{className:"bg-green-600 h-2 rounded-full transition-all",style:{width:`${r.breakdown.reportsScore}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Izin Penalty (15%)"}),e.jsxs("span",{className:`text-sm font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[r.breakdown.izinPenalty.toFixed(2)," / 100"]})]}),e.jsx("div",{className:`w-full rounded-full h-2 transition-colors ${t==="dark"?"bg-gray-700":"bg-gray-200"}`,children:e.jsx("div",{className:"bg-yellow-600 h-2 rounded-full transition-all",style:{width:`${r.breakdown.izinPenalty}%`}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:`text-sm font-medium transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Cuti Penalty (15%)"}),e.jsxs("span",{className:`text-sm font-semibold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[r.breakdown.cutiPenalty.toFixed(2)," / 100"]})]}),e.jsx("div",{className:`w-full rounded-full h-2 transition-colors ${t==="dark"?"bg-gray-700":"bg-gray-200"}`,children:e.jsx("div",{className:"bg-orange-600 h-2 rounded-full transition-all",style:{width:`${r.breakdown.cutiPenalty}%`}})})]})]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-blue-900/30 border-blue-700":"bg-blue-50 border-blue-200"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:" Tips Meningkatkan KPI"}),e.jsxs("ul",{className:`space-y-2 text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Pastikan check-in dan check-out tepat waktu untuk menghitung jam kerja dengan akurat"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Buat laporan harian setiap hari kerja untuk meningkatkan score laporan"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Minimalkan penggunaan izin dan cuti untuk mengurangi penalty"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Target KPI di atas 80 untuk mendapatkan rating Excellent"})]})]})]})]}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Tidak ada data KPI"})})]})}function Un(){const{theme:t}=Ne(),[r,s]=d.useState([]),[i,n]=d.useState(!1),[a,l]=d.useState(!1),[m,C]=d.useState(null),[b,y]=d.useState(""),[j,S]=d.useState(""),[D,c]=d.useState(""),[L,v]=d.useState(null),[w,I]=d.useState(null),[W,Q]=d.useState(null),[N,k]=d.useState(null),[g,u]=d.useState(!1),[H,f]=d.useState(!1),[o,B]=d.useState(new Date().toISOString().split("T")[0]);d.useEffect(()=>{ee()},[]);async function ee(){try{const h=localStorage.getItem("token"),E=await R.get(`${U}/api/daily-reports`,{headers:{Authorization:`Bearer ${h}`}});s(E.data||[])}catch(h){console.error(h)}}function M(h){const E=h.target.files[0];if(E){const z=E.type,Z=z.startsWith("image/");if(!Z&&!(z==="application/pdf")){alert("File harus berupa gambar atau PDF");return}if(E.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}if(v(E),Z){const re=new FileReader;re.onloadend=()=>{Q(re.result)},re.readAsDataURL(E)}else Q(null)}}function _(){v(null),Q(null)}function T(h){const E=h.target.files[0];if(E){const z=E.type,Z=z.startsWith("image/");if(!Z&&!(z==="application/pdf")){alert("File harus berupa gambar atau PDF");return}if(E.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}if(I(E),Z){const re=new FileReader;re.onloadend=()=>{k(re.result)},re.readAsDataURL(E)}else k(null)}}function Y(){I(null),k(null)}function oe(h){C(h),S(h.content),c(""),I(null),k(null),l(!0)}async function $(){var h,E,z,Z;if(!j.trim()){alert("Isi laporan tidak boleh kosong");return}if(!D.trim()){alert("Alasan edit wajib diisi");return}f(!0);try{const ne=localStorage.getItem("token"),re={dailyReportId:m.id,newContent:j.trim(),reason:D.trim()};if(w){const V=new FileReader;V.onloadend=async()=>{var A,J;const me=V.result;re.file=me;try{await R.post(`${U}/api/daily-report-edit-requests`,re,{headers:{Authorization:`Bearer ${ne}`}}),l(!1),C(null),S(""),c(""),I(null),k(null),await ee(),alert("Request edit berhasil dikirim")}catch(K){alert(((J=(A=K.response)==null?void 0:A.data)==null?void 0:J.message)||"Gagal mengirim request edit")}finally{f(!1)}},V.readAsDataURL(w)}else try{await R.post(`${U}/api/daily-report-edit-requests`,re,{headers:{Authorization:`Bearer ${ne}`}}),l(!1),C(null),S(""),c(""),I(null),k(null),await ee(),alert("Request edit berhasil dikirim")}catch(V){alert(((E=(h=V.response)==null?void 0:h.data)==null?void 0:E.message)||"Gagal mengirim request edit")}finally{f(!1)}}catch(ne){alert(((Z=(z=ne.response)==null?void 0:z.data)==null?void 0:Z.message)||"Gagal mengirim request edit"),f(!1)}}async function X(){var h,E,z,Z;if(!b.trim()){alert("Isi laporan tidak boleh kosong");return}u(!0);try{const ne=localStorage.getItem("token"),re={content:b.trim(),date:o};if(L){const V=new FileReader;V.onloadend=async()=>{var A,J;const me=V.result;re.file=me;try{await R.post(`${U}/api/daily-reports`,re,{headers:{Authorization:`Bearer ${ne}`}}),y(""),v(null),Q(null),n(!1),await ee(),alert("Laporan berhasil dikirim")}catch(K){alert(((J=(A=K.response)==null?void 0:A.data)==null?void 0:J.message)||"Gagal mengirim laporan")}finally{u(!1)}},V.readAsDataURL(L)}else try{await R.post(`${U}/api/daily-reports`,re,{headers:{Authorization:`Bearer ${ne}`}}),y(""),v(null),Q(null),n(!1),await ee(),alert("Laporan berhasil dikirim")}catch(V){alert(((E=(h=V.response)==null?void 0:h.data)==null?void 0:E.message)||"Gagal mengirim laporan")}finally{u(!1)}}catch(ne){alert(((Z=(z=ne.response)==null?void 0:z.data)==null?void 0:Z.message)||"Gagal mengirim laporan"),u(!1)}}function p(h){return new Date(h).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}function F(h){return h?new Date(h).toLocaleTimeString("id-ID",{hour:"2-digit",minute:"2-digit"}):""}return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:["Laporan ",e.jsx("span",{className:"gradient-text",children:"Harian"})," "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Tulis laporan harian tentang pekerjaan yang telah Anda lakukan"})]}),e.jsx("div",{children:e.jsx("button",{onClick:()=>n(!0),className:"btn btn-primary",children:"Tulis Laporan"})})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:`text-lg font-medium transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Riwayat Laporan"}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Total: ",r.length]})]}),e.jsxs("div",{className:"space-y-4",children:[r.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:`w-16 h-16 mx-auto mb-4 transition-colors ${t==="dark"?"text-gray-600":"text-gray-300"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Belum ada laporan"})]}),r.map(h=>e.jsxs("div",{className:`border rounded-lg p-4 shadow-sm transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-white border-gray-200"}`,children:[e.jsx("div",{className:"flex items-start justify-between gap-4 mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:`font-medium mb-1 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:p(h.date)}),e.jsxs("div",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:["Dikirim pada ",F(h.submittedAt),h.isLate&&e.jsx("span",{className:`ml-2 px-2 py-0.5 rounded-full text-xs font-medium transition-colors ${t==="dark"?"bg-red-900/30 text-red-200":"bg-red-100 text-red-800"}`,children:"Terlambat"})]})]})}),e.jsx("div",{className:`text-sm rounded-lg p-3 border whitespace-pre-wrap mb-3 transition-colors ${t==="dark"?"text-gray-300 bg-gray-600 border-gray-500":"text-gray-700 bg-gray-50 border-gray-200"}`,children:h.content}),h.filePath&&e.jsx("div",{className:"mt-3",children:h.fileType==="image"?e.jsx("img",{src:ke(h.filePath),alt:"Lampiran",className:`max-w-full h-auto rounded-lg border transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`}):e.jsxs("a",{href:ke(h.filePath),target:"_blank",rel:"noopener noreferrer",className:`inline-flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${t==="dark"?"bg-indigo-900/30 text-indigo-300 hover:bg-indigo-900/50":"bg-indigo-50 text-indigo-700 hover:bg-indigo-100"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsxs("span",{children:["Lihat PDF: ",h.fileName]})]})}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsx("button",{onClick:()=>oe(h),className:`px-4 py-2 rounded-lg transition-colors text-sm font-medium ${t==="dark"?"bg-yellow-900/30 text-yellow-200 hover:bg-yellow-900/50":"bg-yellow-50 text-yellow-700 hover:bg-yellow-100"}`,children:"Request Edit"})})]},h.id))]})]}),i&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-xl shadow-2xl p-6 max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Tulis Laporan Harian"}),e.jsx("button",{onClick:()=>{n(!1),y(""),v(null),Q(null)},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Tanggal Laporan"}),e.jsx("input",{type:"date",value:o,onChange:h=>B(h.target.value),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Isi Laporan ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:b,onChange:h=>y(h.target.value),placeholder:"Tuliskan hal-hal yang telah Anda kerjakan hari ini...",rows:8,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Lampiran (Gambar atau PDF) ",e.jsx("span",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"(Opsional)"})]}),W?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:W,alt:"Preview",className:`max-w-full h-auto rounded-lg border mb-2 transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`}),e.jsx("button",{onClick:_,className:"px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm",children:"Hapus File"})]}):L?e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("svg",{className:"w-5 h-5 transition-colors text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("span",{className:`flex-1 text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:L.name}),e.jsx("button",{onClick:_,className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs("label",{className:"block",children:[e.jsx("div",{className:`flex items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer transition-colors ${t==="dark"?"border-gray-600 hover:border-indigo-500":"border-gray-300 hover:border-indigo-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:`w-8 h-8 mx-auto mb-2 transition-colors ${t==="dark"?"text-gray-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Klik untuk upload file"}),e.jsx("p",{className:"text-xs mt-1 transition-colors text-gray-500",children:"Gambar atau PDF (Maks. 5MB)"})]})}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:M,className:"hidden"})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>{n(!1),y(""),v(null),Q(null)},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{onClick:X,disabled:g,className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Mengirim...":"Kirim Laporan"})]})]})}),a&&m&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`w-full max-w-2xl rounded-xl shadow-2xl p-6 max-h-[90vh] overflow-y-auto transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Request Edit Laporan"}),e.jsx("button",{onClick:()=>{l(!1),C(null),S(""),c(""),I(null),k(null)},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Alasan Edit ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:D,onChange:h=>c(h.target.value),placeholder:"Jelaskan alasan mengapa Anda ingin mengedit laporan ini...",rows:3,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["Konten Baru ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:j,onChange:h=>S(h.target.value),placeholder:"Tuliskan konten laporan yang baru...",rows:8,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:["File Baru (Gambar atau PDF) ",e.jsx("span",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"(Opsional)"})]}),N?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:N,alt:"Preview",className:`max-w-full h-auto rounded-lg border mb-2 transition-colors ${t==="dark"?"border-gray-600":"border-gray-200"}`}),e.jsx("button",{onClick:Y,className:"px-3 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors text-sm",children:"Hapus File"})]}):w?e.jsxs("div",{className:`flex items-center gap-2 p-3 rounded-lg border transition-colors ${t==="dark"?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"}`,children:[e.jsx("svg",{className:"w-5 h-5 transition-colors text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),e.jsx("span",{className:`flex-1 text-sm transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:w.name}),e.jsx("button",{onClick:Y,className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}):e.jsxs("label",{className:"block",children:[e.jsx("div",{className:`flex items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer transition-colors ${t==="dark"?"border-gray-600 hover:border-indigo-500":"border-gray-300 hover:border-indigo-500"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("svg",{className:`w-8 h-8 mx-auto mb-2 transition-colors ${t==="dark"?"text-gray-500":"text-gray-400"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Klik untuk upload file baru"}),e.jsx("p",{className:"text-xs mt-1 transition-colors text-gray-500",children:"Gambar atau PDF (Maks. 5MB)"})]})}),e.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:T,className:"hidden"})]})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>{l(!1),C(null),S(""),c(""),I(null),k(null)},className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{onClick:$,disabled:H,className:"px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-lg hover:from-yellow-600 hover:to-orange-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:H?"Mengirim...":"Kirim Request Edit"})]})]})})]})}function zn(){const{theme:t}=Ne(),[r,s]=d.useState(!1),[i,n]=d.useState(!1),[a,l]=d.useState(null),[m,C]=d.useState(null),[b,y]=d.useState(!1),[j,S]=d.useState({password:"",confirmPassword:""}),[D,c]=d.useState({name:"",email:"",phone:"",address:"",birthDate:"",gender:"",maritalStatus:"",nationality:"Indonesia"}),[L,v]=d.useState({employeeId:"",position:"",department:"",division:"",supervisor:"",employmentStatus:"",education:"",institution:"",degree:""});d.useEffect(()=>{w()},[]);async function w(){var N,k,g;s(!0);try{const u=localStorage.getItem("token");if(!u){alert("Token tidak ditemukan. Silakan login kembali.");return}const f=(await R.get(`${U}/api/users/me`,{headers:{Authorization:`Bearer ${u}`}})).data;if(!f){alert("Data user tidak ditemukan");return}c({name:f.name||"",email:f.email||"",phone:f.phone||"",address:f.address||"",birthDate:f.birthDate||"",gender:f.gender||"",maritalStatus:f.maritalStatus||"",nationality:f.nationality||"Indonesia",password:"",confirmPassword:""}),v({employeeId:f.employeeId||"",position:f.position||"",department:f.department||"",division:f.division||"",supervisor:f.supervisor||"",employmentStatus:f.employmentStatus||"",education:f.education||"",institution:f.institution||"",degree:f.degree||""}),f.profilePicture?(C(ke(f.profilePicture)),l(null)):(C(null),l(null));const o={...JSON.parse(localStorage.getItem("user")||"{}"),...f};localStorage.setItem("user",JSON.stringify(o))}catch(u){console.error("Error loading profile:",u);const H=((k=(N=u.response)==null?void 0:N.data)==null?void 0:k.message)||u.message||"Gagal memuat data profile";alert(`Error: ${H}`),((g=u.response)==null?void 0:g.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login")}finally{s(!1)}}function I(N){const k=N.target.files[0];if(k){if(!k.type.startsWith("image/")){alert("File harus berupa gambar");return}if(k.size>5*1024*1024){alert("Ukuran file maksimal 5MB");return}const g=new FileReader;g.onloadend=()=>{l(g.result),C(g.result)},g.readAsDataURL(k)}}function W(){l(""),C(null)}async function Q(N){var k,g,u,H;N.preventDefault(),n(!0);try{const f=localStorage.getItem("token");if(!f){alert("Token tidak ditemukan. Silakan login kembali."),window.location.href="/login",n(!1);return}const o={...D};a?o.profilePicture=a:a===""&&!m&&(o.profilePicture=null),console.log("Sending PUT request to /api/users/me");const B=await R.put(`${U}/api/users/me`,o,{headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});B.data.profilePicture?C(ke(B.data.profilePicture)):C(null),l(null);const ee={...JSON.parse(localStorage.getItem("user")||"{}"),...B.data};localStorage.setItem("user",JSON.stringify(ee)),alert("Profile berhasil diperbarui"),window.location.reload()}catch(f){console.error("Error updating profile:",f);const o=((g=(k=f.response)==null?void 0:k.data)==null?void 0:g.message)||f.message||"Gagal memperbarui profile";if(!localStorage.getItem("token")){alert("Token tidak ditemukan. Silakan login kembali."),window.location.href="/login";return}if(alert(`Error: ${o}`),((u=f.response)==null?void 0:u.status)===401||((H=f.response)==null?void 0:H.status)===403){console.log("Token invalid or expired, redirecting to login"),localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login";return}}finally{n(!1)}}return r?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),e.jsx("p",{className:`ml-3 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Memuat data..."})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:`text-3xl font-bold mb-2 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:[e.jsx("span",{className:"gradient-text",children:"Profile"})," Saya "]}),e.jsx("p",{className:`transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Kelola informasi pribadi dan data diri Anda"})]}),e.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Foto Profile"}),e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"relative",children:m?e.jsx("img",{src:m,alt:"Profile",className:"w-32 h-32 rounded-full object-cover border-4 border-indigo-200 shadow-lg"}):e.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center text-white text-4xl font-bold border-4 border-indigo-200 shadow-lg",children:(D.name||"U").slice(0,1).toUpperCase()})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"px-4 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors cursor-pointer font-medium",children:[m?"Ganti Foto":"Upload Foto",e.jsx("input",{type:"file",accept:"image/*",onChange:I,className:"hidden"})]}),m&&e.jsx("button",{type:"button",onClick:W,className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors font-medium",children:"Hapus Foto"})]}),e.jsx("p",{className:`text-sm mt-2 transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Format: JPG, PNG, GIF (Maks. 5MB)"})]})]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:[e.jsx("h2",{className:`text-xl font-bold mb-4 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Pribadi"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Nama Lengkap *"}),e.jsx("input",{required:!0,type:"text",value:D.name,onChange:N=>c({...D,name:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Email *"}),e.jsx("input",{required:!0,type:"email",value:D.email,onChange:N=>c({...D,email:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"No. Telepon"}),e.jsx("input",{type:"text",value:D.phone,onChange:N=>c({...D,phone:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Tanggal Lahir"}),e.jsx("input",{type:"date",value:D.birthDate,onChange:N=>c({...D,birthDate:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Jenis Kelamin"}),e.jsxs("select",{value:D.gender,onChange:N=>c({...D,gender:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih..."}),e.jsx("option",{value:"Laki-laki",children:"Laki-laki"}),e.jsx("option",{value:"Perempuan",children:"Perempuan"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status Pernikahan"}),e.jsxs("select",{value:D.maritalStatus,onChange:N=>c({...D,maritalStatus:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Pilih..."}),e.jsx("option",{value:"Belum Menikah",children:"Belum Menikah"}),e.jsx("option",{value:"Menikah",children:"Menikah"}),e.jsx("option",{value:"Cerai",children:"Cerai"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Alamat"}),e.jsx("textarea",{value:D.address,onChange:N=>c({...D,address:N.target.value}),rows:3,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Kewarganegaraan"}),e.jsx("input",{type:"text",value:D.nationality,onChange:N=>c({...D,nationality:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300"}`})]})]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800/50 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Pekerjaan"}),e.jsx("span",{className:`text-xs px-3 py-1 rounded-full transition-colors ${t==="dark"?"text-yellow-200 bg-yellow-900/30":"text-gray-500 bg-yellow-100"}`,children:"Hanya Admin yang dapat mengubah"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Employee ID"}),e.jsx("input",{type:"text",value:L.employeeId,disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Posisi"}),e.jsx("input",{type:"text",value:L.position,disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Department"}),e.jsx("input",{type:"text",value:L.department||"-",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Divisi"}),e.jsx("input",{type:"text",value:L.division||"-",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Supervisor"}),e.jsx("input",{type:"text",value:L.supervisor||"-",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Status Karyawan"}),e.jsx("input",{type:"text",value:L.employmentStatus||"-",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]})]})]}),e.jsxs("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800/50 border-gray-700":"bg-gray-50 border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Data Pendidikan"}),e.jsx("span",{className:`text-xs px-3 py-1 rounded-full transition-colors ${t==="dark"?"text-yellow-200 bg-yellow-900/30":"text-gray-500 bg-yellow-100"}`,children:"Hanya Admin yang dapat mengubah"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Pendidikan Terakhir"}),e.jsx("input",{type:"text",value:L.education||"-",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Institusi"}),e.jsx("input",{type:"text",value:L.institution||"-",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Gelar"}),e.jsx("input",{type:"text",value:L.degree||"-",disabled:!0,className:`w-full p-3 border rounded-lg cursor-not-allowed transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-gray-400":"bg-gray-100 border-gray-300 text-gray-600"}`})]})]})]}),e.jsx("div",{className:`card-strong transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:`text-xl font-bold mb-1 transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Ubah Password"}),e.jsx("p",{className:`text-sm transition-colors ${t==="dark"?"text-gray-400":"text-gray-600"}`,children:"Ganti password akun Anda"})]}),e.jsx("button",{type:"button",onClick:()=>y(!0),className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium",children:"Ubah Password"})]})}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:w,className:`px-6 py-3 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{type:"submit",disabled:i,className:"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Menyimpan...":"Simpan Perubahan"})]})]}),b&&e.jsx("div",{className:`fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm p-4 transition-colors ${t==="dark"?"bg-black/80":"bg-black/50"}`,children:e.jsxs("div",{className:`rounded-xl shadow-2xl p-6 max-w-md w-full transition-colors ${t==="dark"?"bg-gray-800 border-gray-700":"bg-white"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:`text-xl font-bold transition-colors ${t==="dark"?"text-white":"text-gray-900"}`,children:"Ubah Password"}),e.jsx("button",{onClick:()=>{y(!1),S({password:"",confirmPassword:""})},className:`transition-colors ${t==="dark"?"text-gray-400 hover:text-gray-200":"text-gray-400 hover:text-gray-600"}`,children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:async N=>{var k,g,u,H;if(N.preventDefault(),j.password!==j.confirmPassword){alert("Password dan konfirmasi password tidak cocok");return}if(!j.password||j.password.length<6){alert("Password minimal 6 karakter");return}n(!0);try{const f=localStorage.getItem("token");if(!f){alert("Token tidak ditemukan. Silakan login kembali."),window.location.href="/login";return}const o=await R.put(`${U}/api/users/me`,{password:j.password},{headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}});alert("Password berhasil diubah"),y(!1),S({password:"",confirmPassword:""}),window.location.reload()}catch(f){console.error("Error updating password:",f);const o=((g=(k=f.response)==null?void 0:k.data)==null?void 0:g.message)||f.message||"Gagal mengubah password";alert(`Error: ${o}`),(((u=f.response)==null?void 0:u.status)===401||((H=f.response)==null?void 0:H.status)===403)&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login")}finally{n(!1)}},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Password Baru"}),e.jsx("input",{required:!0,type:"password",value:j.password,onChange:N=>S({...j,password:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"Masukkan password baru"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 transition-colors ${t==="dark"?"text-gray-300":"text-gray-700"}`,children:"Konfirmasi Password"}),e.jsx("input",{required:!0,type:"password",value:j.confirmPassword,onChange:N=>S({...j,confirmPassword:N.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-colors ${t==="dark"?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300"}`,placeholder:"Konfirmasi password baru"})]}),e.jsx("p",{className:`text-xs transition-colors ${t==="dark"?"text-gray-400":"text-gray-500"}`,children:"Password minimal 6 karakter"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>{y(!1),S({password:"",confirmPassword:""})},className:`px-4 py-2 rounded-lg hover:opacity-80 transition-colors font-medium ${t==="dark"?"text-gray-300 bg-gray-700 hover:bg-gray-600":"text-gray-700 bg-gray-100 hover:bg-gray-200"}`,children:"Batal"}),e.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg hover:from-indigo-600 hover:to-purple-600 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:i?"Menyimpan...":"Simpan Password"})]})]})]})})]})}const Xr=R.create({baseURL:`${U}/api`,headers:{"Content-Type":"application/json"}});Xr.interceptors.request.use(t=>{const r=localStorage.getItem("token");return r&&(t.headers.Authorization=`Bearer ${r}`),t},t=>Promise.reject(t));Xr.interceptors.response.use(t=>t,t=>{var r;return((r=t.response)==null?void 0:r.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/login"),Promise.reject(t)});const vt=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),Kn=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),pr=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});function Hn(){const{theme:t}=Ne(),[r,s]=d.useState({middlewareIP:"",deviceKey:"",secret:""}),[i,n]=d.useState(null),[a,l]=d.useState(!1),[m,C]=d.useState("config"),[b,y]=d.useState([]),[j,S]=d.useState([]),[D,c]=d.useState([]),[L,v]=d.useState([]),[w,I]=d.useState(""),[W,Q]=d.useState({type:"",text:""}),[N,k]=d.useState(!0),[g,u]=d.useState(5e3),[H,f]=d.useState(null),[o,B]=d.useState({personId:"",personName:"",phone:"",gender:"",faceImage:null,faceImagePreview:null}),[ee,M]=d.useState(null),[_,T]=d.useState(!1),[Y,oe]=d.useState({personId:"",image:null,imagePreview:null}),[$,X]=d.useState({personId:"",palmImage:null,palmImagePreview:null,palmId:"",palmNum:"1"});d.useEffect(()=>{const A=localStorage.getItem("deviceConfig");if(A)try{const J=JSON.parse(A);J.ip&&J.password&&!J.middlewareIP?(s({middlewareIP:J.ip||"",deviceKey:J.deviceKey||"",secret:J.password||""}),localStorage.setItem("deviceConfig",JSON.stringify({middlewareIP:J.ip||"",deviceKey:J.deviceKey||"",secret:J.password||""}))):s({middlewareIP:J.middlewareIP||"",deviceKey:J.deviceKey||"",secret:J.secret||""})}catch(J){console.error("Error parsing device config:",J),s({middlewareIP:"",deviceKey:"",secret:""})}else s({middlewareIP:"192.168.31.231",deviceKey:"30EC19CE8B9D2A49",secret:"123456"})},[]),d.useEffect(()=>{const A=r.middlewareIP&&r.middlewareIP.trim()!==""&&r.deviceKey&&r.deviceKey.trim()!==""&&r.secret&&r.secret.trim()!=="";a||(m==="info"&&!i&&A?(console.log("[Auto-load] Loading device info..."),h()):m==="persons"&&b.length===0&&A?(console.log("[Auto-load] Loading persons..."),E()):m==="log"&&j.length===0&&(console.log("[Auto-load] Loading attendance records from database..."),z()))},[m]),d.useEffect(()=>{let A=null;return N&&m==="log"?(console.log("[Auto-Refresh] Enabled for Log tab (interval: "+g/1e3+"s)"),j.length===0&&(console.log("[Auto-Refresh] Initial load..."),z(!1)),A=setInterval(()=>{console.log("[Auto-Refresh] Fetching new scan records (silent mode)..."),z(!0),f(new Date)},g)):m!=="log"?console.log("[Auto-Refresh] Not on Log tab, auto-refresh disabled"):N||console.log("[Auto-Refresh] Manual mode, auto-refresh disabled"),()=>{A&&(console.log("[Auto-Refresh] Cleanup: clearing interval"),clearInterval(A))}},[N,m,g]);const p=(A,J)=>{Q({type:A,text:J}),setTimeout(()=>Q({type:"",text:""}),5e3)},F=()=>{var J,K,ae;const A={middlewareIP:((J=r.middlewareIP)==null?void 0:J.trim())||"",deviceKey:((K=r.deviceKey)==null?void 0:K.trim())||"",secret:((ae=r.secret)==null?void 0:ae.trim())||""};if(!A.middlewareIP||!A.deviceKey||!A.secret){const G=[];A.middlewareIP||G.push("Middleware IP"),A.deviceKey||G.push("Device Key"),A.secret||G.push("Secret"),p("error",`Field wajib diisi: ${G.join(", ")}`);return}s(A),localStorage.setItem("deviceConfig",JSON.stringify(A)),console.log("Device config saved:",{...A,secret:"***"}),p("success","Konfigurasi device berhasil disimpan")},h=async()=>{var A,J;if(!r.middlewareIP||!r.deviceKey||!r.secret){const K=[];(!r.middlewareIP||r.middlewareIP.trim()==="")&&K.push("Middleware IP"),(!r.deviceKey||r.deviceKey.trim()==="")&&K.push("Device Key"),(!r.secret||r.secret.trim()==="")&&K.push("Secret"),p("error",`Silakan lengkapi konfigurasi: ${K.join(", ")}`);return}l(!0);try{const K=localStorage.getItem("token");if(!K){p("error","Token tidak ditemukan. Silakan login ulang."),l(!1);return}const ae={middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim()};console.log("[Frontend] Requesting device info:",{middlewareIP:ae.middlewareIP,deviceKey:ae.deviceKey,secret:"***"});const G=await R.post(`${U}/api/device/info`,ae,{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"},timeout:3e4});console.log("[Frontend] Device info response:",G.data),G.data?(n(G.data),p("success","Informasi device berhasil diambil")):p("error","Tidak ada data yang diterima dari server")}catch(K){console.error("[Frontend] Error getting device info:",K);const ae=((J=(A=K.response)==null?void 0:A.data)==null?void 0:J.message)||K.message||"Gagal mengambil informasi device";p("error",ae),n(null)}l(!1)},E=async()=>{var A,J,K,ae,G,ce;if(!r.middlewareIP||!r.deviceKey||!r.secret){const de=[];(!r.middlewareIP||r.middlewareIP.trim()==="")&&de.push("Middleware IP"),(!r.deviceKey||r.deviceKey.trim()==="")&&de.push("Device Key"),(!r.secret||r.secret.trim()==="")&&de.push("Secret"),p("error",`Silakan lengkapi konfigurasi: ${de.join(", ")}`);return}l(!0);try{const de=localStorage.getItem("token");if(!de){p("error","Token tidak ditemukan. Silakan login ulang."),l(!1);return}const ge={middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim()};console.log("[Frontend] Requesting persons:",{middlewareIP:ge.middlewareIP,deviceKey:ge.deviceKey,secret:"***"});const ue=await R.post(`${U}/api/device/persons`,ge,{headers:{Authorization:`Bearer ${de}`,"Content-Type":"application/json"},timeout:3e4});console.log("[Frontend] Persons response:",{status:ue.status,dataType:Array.isArray(ue.data)?"array":typeof ue.data,dataLength:Array.isArray(ue.data)?ue.data.length:"N/A",data:ue.data}),Array.isArray(ue.data)?(y(ue.data),ue.data.length>0?p("success",`Berhasil memuat ${ue.data.length} person`):p("warning","Tidak ada data person yang ditemukan di device")):ue.data?(y([ue.data]),p("success","Berhasil memuat data person")):(y([]),p("warning","Tidak ada data person yang ditemukan"))}catch(de){console.error("[Frontend] Error loading persons:",{message:de.message,response:(A=de.response)==null?void 0:A.data,status:(J=de.response)==null?void 0:J.status,statusText:(K=de.response)==null?void 0:K.statusText});let ge="Gagal memuat data person";de.response?(ge=((ae=de.response.data)==null?void 0:ae.message)||((G=de.response.data)==null?void 0:G.msg)||de.response.statusText||ge,(ce=de.response.data)!=null&&ce.code&&(ge+=` (Code: ${de.response.data.code})`)):de.request?ge="Tidak dapat terhubung ke server. Pastikan backend berjalan.":ge=de.message||ge,p("error",ge),y([])}l(!1)},z=async(A=!1)=>{var J,K,ae,G,ce,de,ge,ue,Ae;console.log("[Frontend] loadAttendanceRecords called:",{silent:A,activeTab:m}),A||l(!0);try{const O=localStorage.getItem("token");if(!O){console.error("[Frontend] No token found"),A||p("error","Token tidak ditemukan. Silakan login ulang."),l(!1);return}const se={...r.deviceKey&&r.deviceKey.trim()&&{deviceKey:r.deviceKey.trim()},limit:500,offset:0};console.log("[Frontend] Requesting scan records from database:",se);const ie=await R.post(`${U}/api/device/scan/records`,se,{headers:{Authorization:`Bearer ${O}`,"Content-Type":"application/json"},timeout:3e4});console.log("[Frontend] Scan records response:",{status:ie.status,total:((J=ie.data)==null?void 0:J.total)||0,recordsLength:((ae=(K=ie.data)==null?void 0:K.records)==null?void 0:ae.length)||0,sampleData:((ce=(G=ie.data)==null?void 0:G.records)==null?void 0:ce[0])||"No data"}),ie.data&&ie.data.records&&Array.isArray(ie.data.records)?(console.log("[Frontend] Setting attendanceRecords:",ie.data.records.length,"records"),S(ie.data.records),A||(ie.data.records.length>0?p("success",`Berhasil memuat ${ie.data.records.length} log scan (Total: ${ie.data.total})`):p("warning","Tidak ada data log scan. Pastikan device sudah dikonfigurasi untuk mengirim callback."))):(console.warn("[Frontend] No records in response or invalid format"),S([]),A||p("warning","Tidak ada data log scan"))}catch(O){if(console.error("[Frontend] Error loading scan records:",O),console.error("[Frontend] Error details:",{message:O.message,response:(de=O.response)==null?void 0:de.data,status:(ge=O.response)==null?void 0:ge.status}),!A){const se=((Ae=(ue=O.response)==null?void 0:ue.data)==null?void 0:Ae.message)||O.message||"Gagal memuat data log scan";p("error",se)}S([])}A||l(!1)},Z=async()=>{var A,J;if(!r.middlewareIP||!r.deviceKey||!r.secret){const K=[];r.middlewareIP||K.push("Middleware IP"),r.deviceKey||K.push("Device Key"),r.secret||K.push("Secret"),p("error",`Silakan lengkapi konfigurasi: ${K.join(", ")}`);return}if(confirm("Apakah Anda yakin ingin menyinkronkan semua user ke device? Operasi ini mungkin memakan waktu.")){l(!0);try{const K=localStorage.getItem("token"),ae=await R.post(`${U}/api/device/sync-users`,{middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret},{headers:{Authorization:`Bearer ${K}`}});p("success",ae.data.message||"Sinkronisasi user berhasil"),E()}catch(K){console.error(K),p("error",((J=(A=K.response)==null?void 0:A.data)==null?void 0:J.message)||"Gagal menyinkronkan user")}l(!1)}},ne=async A=>{var J,K;if(!A){p("error","Person SN tidak ditemukan");return}if(confirm(`Apakah Anda yakin ingin menghapus person dengan SN: ${A}?`)){if(!r.middlewareIP||!r.deviceKey||!r.secret){p("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}l(!0);try{const ae=localStorage.getItem("token");if(!ae){p("error","Token tidak ditemukan. Silakan login ulang."),l(!1);return}const G={middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),personSn:A.trim()};console.log("[Frontend] Deleting person:",{...G,secret:"***"}),await R.post(`${U}/api/device/person/delete`,G,{headers:{Authorization:`Bearer ${ae}`,"Content-Type":"application/json"},timeout:3e4}),p("success","Person berhasil dihapus"),E()}catch(ae){console.error(ae),p("error",((K=(J=ae.response)==null?void 0:J.data)==null?void 0:K.message)||"Gagal menghapus person")}l(!1)}},re=A=>{const J=A.target.files[0];if(J){if(!J.type.startsWith("image/")){p("error","File harus berupa gambar");return}if(J.size>2*1024*1024){p("error","Ukuran file maksimal 2MB. Silakan kompres gambar terlebih dahulu.");return}const K=new FileReader;K.onloadend=()=>{const ae=K.result,G=new Image;G.onload=()=>{const ce=document.createElement("canvas");let de=G.width,ge=G.height;const ue=800;de>ge&&de>ue?(ge=ge*ue/de,de=ue):ge>ue&&(de=de*ue/ge,ge=ue),ce.width=de,ce.height=ge,ce.getContext("2d").drawImage(G,0,0,de,ge);const O=ce.toDataURL("image/jpeg",.8);O.length*3/4>1.5*1024*1024&&p("warning","Gambar masih cukup besar. Mungkin menyebabkan error. Coba kompres lebih kecil."),B({...o,faceImage:O,faceImagePreview:O})},G.onerror=()=>{p("error","Gagal memproses gambar")},G.src=ae},K.readAsDataURL(J)}},V=async()=>{var K,ae,G;if(!r.middlewareIP||!r.deviceKey||!r.secret){p("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}const A=o.personId?o.personId.trim():"",J=o.personName?o.personName.trim():"";if(!A||A===""){p("error","Person ID (SN) wajib diisi dan tidak boleh kosong");return}if(!J||J===""){p("error","Person Name wajib diisi dan tidak boleh kosong");return}l(!0);try{const ce=localStorage.getItem("token");if(!ce){p("error","Token tidak ditemukan. Silakan login ulang."),l(!1);return}console.log("[Frontend] Validating person data before send:",{personId:A,personIdLength:A.length,personName:J,personNameLength:J.length});let de=null;if(o.faceImage&&((o.faceImage.includes(",")?o.faceImage.split(",")[1]:o.faceImage).length*3/4>1.5*1024*1024?(p("warning","Foto wajah terlalu besar dan akan dilewati untuk menghindari error. Silakan daftarkan wajah secara terpisah."),de=null):de=o.faceImage),!A||A===""){p("error","Person ID (SN) tidak boleh kosong"),l(!1);return}const ge={middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),personSn:A,name:J,...o.phone&&o.phone.trim()&&{phone:o.phone.trim()},...o.gender&&o.gender.trim()&&{gender:o.gender.trim()},...de&&{faceBase64:de}};if(!ge.personSn||ge.personSn.trim()===""){p("error","Person SN tidak boleh kosong. Silakan isi Employee ID dengan benar."),l(!1);return}console.log("[Frontend] Adding person via merge:",{middlewareIP:ge.middlewareIP,deviceKey:ge.deviceKey,secret:"***",personSn:ge.personSn,personSnLength:ge.personSn.length,name:ge.name,hasPhone:!!ge.phone,hasGender:!!ge.gender,hasFace:!!ge.faceBase64});const ue=await R.post(`${U}/api/device/person/merge`,ge,{headers:{Authorization:`Bearer ${ce}`,"Content-Type":"application/json"},timeout:3e4});p("success",ue.data.message||"User berhasil ditambahkan/diperbarui"),B({personId:"",personName:"",phone:"",gender:"",faceImage:null,faceImagePreview:null}),E()}catch(ce){if(console.error("[Frontend] Error adding person:",ce),((K=ce.response)==null?void 0:K.status)===413)o.faceImage?p("error","Request terlalu besar (413). Foto wajah terlalu besar. Silakan coba lagi tanpa foto wajah atau kompres foto lebih kecil."):p("error","Request terlalu besar (413). Silakan kurangi data yang dikirim.");else{const de=((G=(ae=ce.response)==null?void 0:ae.data)==null?void 0:G.message)||ce.message||"Gagal menambahkan user";p("error",de)}}l(!1)},me=async()=>{var A,J;if(!r.middlewareIP||!r.deviceKey||!r.secret){p("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}if(!o.personId||!o.personName){p("error","Person ID dan Person Name wajib diisi");return}l(!0);try{const K=localStorage.getItem("token");if(!K){p("error","Token tidak ditemukan. Silakan login ulang."),l(!1);return}const ae={middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),personSn:o.personId.trim(),name:o.personName.trim(),...o.phone&&o.phone.trim()&&{phone:o.phone.trim()},...o.gender&&o.gender.trim()&&{gender:o.gender.trim()}};console.log("[Frontend] Updating person via merge:",{...ae,secret:"***"});const G=await R.post(`${U}/api/device/person/merge`,ae,{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"},timeout:3e4});p("success",G.data.message||"Person berhasil diperbarui"),T(!1),M(null),B({personId:"",personName:"",phone:"",gender:"",faceImage:null,faceImagePreview:null}),E()}catch(K){console.error("[Frontend] Error updating person:",K);const ae=((J=(A=K.response)==null?void 0:A.data)==null?void 0:J.message)||K.message||"Gagal memperbarui person";p("error",ae)}l(!1)};return e.jsxs("div",{className:`p-4 md:p-6 min-h-screen transition-colors duration-300 ${t==="dark"?"bg-[#1a2440]":"bg-gray-50"}`,children:[e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:`mb-4 md:mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:[e.jsx("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-1 md:mb-2",children:"Device Management (Cloud Middleware)"}),e.jsx("p",{className:"text-xs md:text-sm opacity-70",children:"Kelola koneksi dan sinkronisasi dengan face recognition device melalui middleware server"})]}),W.text&&e.jsxs("div",{className:`mb-3 md:mb-4 p-3 md:p-4 rounded-lg flex items-center gap-2 text-sm md:text-base ${W.type==="success"?"bg-green-100 text-green-800 border border-green-300":"bg-red-100 text-red-800 border border-red-300"}`,children:[W.type==="success"?e.jsx(Kn,{}):e.jsx(pr,{}),e.jsx("span",{children:W.text})]}),e.jsx("div",{className:`mb-4 md:mb-6 border-b ${t==="dark"?"border-white/10":"border-gray-200"}`,children:e.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-purple-500 scrollbar-track-transparent",children:e.jsx("div",{className:"flex gap-1 md:gap-2 min-w-max pb-1",children:[{key:"config",label:"Konfigurasi",shortLabel:"Config",compact:"Config"},{key:"info",label:"Info Device",shortLabel:"Info",compact:"Info"},{key:"persons",label:"Daftar Person",shortLabel:"Daftar",compact:"Daftar"},{key:"add-user",label:"Add User",shortLabel:"Add User",compact:"Add"},{key:"log",label:"Log Scan",shortLabel:"Log",compact:"Log"}].map(A=>e.jsxs("button",{onClick:()=>C(A.key),className:`px-3 md:px-4 py-2 font-medium text-xs md:text-sm transition-all whitespace-nowrap flex-shrink-0 ${m===A.key?t==="dark"?"text-white border-b-2 border-purple-500 bg-purple-500/10":"text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50":t==="dark"?"text-white/60 hover:text-white hover:bg-white/5":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,title:A.label,children:[e.jsx("span",{className:"hidden md:inline",children:A.shortLabel}),e.jsx("span",{className:"md:hidden",children:A.compact})]},A.key))})})}),e.jsxs("div",{className:`rounded-lg md:rounded-xl shadow-lg p-4 md:p-6 transition-colors ${t==="dark"?"bg-[#26355D]":"bg-white"}`,children:[m==="config"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Middleware Server IP Address"}),e.jsx("input",{type:"text",value:r.middlewareIP,onChange:A=>s({...r,middlewareIP:A.target.value}),placeholder:"192.168.1.100",className:`w-full px-3 md:px-4 py-2 rounded-lg border transition-colors text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"IP address server tempat middleware berjalan (port 8190)"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Device SN (Serial Number) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.deviceKey,onChange:A=>s({...r,deviceKey:A.target.value}),placeholder:"30EC19CE8B9D2A49",maxLength:16,className:`w-full px-3 md:px-4 py-2 rounded-lg border transition-colors text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Serial number device (16 digit) - Contoh: 30EC19CE8B9D2A49"}),e.jsx("p",{className:`text-xs mt-1 font-semibold ${t==="dark"?"text-yellow-400":"text-yellow-600"}`,children:" Catatan: Device SN berbeda dengan Person SN. Device SN adalah ID device, Person SN adalah ID karyawan."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Secret (Password) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",value:r.secret,onChange:A=>s({...r,secret:A.target.value}),placeholder:"123456",className:`w-full px-3 md:px-4 py-2 rounded-lg border transition-colors text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white placeholder-white/50":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Password server yang diset pada device - Contoh: 123456"})]}),e.jsx("div",{className:"flex gap-2 md:gap-3",children:e.jsx("button",{onClick:F,className:"px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm md:text-base",children:"Simpan Konfigurasi"})})]}),m==="info"&&e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Device Information"}),e.jsxs("button",{onClick:h,disabled:a,className:"px-3 md:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(vt,{}),"Refresh"]})]}),i?e.jsx("div",{className:`grid grid-cols-1 sm:grid-cols-2 gap-3 md:gap-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:Object.entries(i).map(([A,J])=>e.jsxs("div",{className:`p-3 rounded-lg ${t==="dark"?"bg-white/5":"bg-gray-50"}`,children:[e.jsx("div",{className:"text-xs opacity-70 mb-1 break-words",children:A}),e.jsx("div",{className:"font-medium text-sm md:text-base break-words",children:String(J)})]},A))}):e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Klik tombol Refresh untuk mengambil informasi device"})]}),m==="persons"&&e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Person List"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[e.jsx("button",{onClick:Z,disabled:a,className:"px-3 md:px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 text-sm md:text-base",children:"Sync Users"}),e.jsxs("button",{onClick:()=>E(),disabled:a,className:"px-3 md:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2 text-sm md:text-base",children:[e.jsx(vt,{}),"Refresh"]})]})]}),b.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:e.jsxs("table",{className:`min-w-full divide-y ${t==="dark"?"divide-white/10 text-white":"divide-gray-200 text-gray-900"}`,children:[e.jsx("thead",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Person SN"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Name"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold hidden sm:table-cell",children:"Type"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold hidden md:table-cell",children:"Face Count"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-white/5":"divide-gray-100"}`,children:b.map((A,J)=>e.jsxs("tr",{className:t==="dark"?"hover:bg-white/5":"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm whitespace-nowrap",children:A.personSn||"-"}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm",children:A.name||"-"}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm hidden sm:table-cell",children:A.personType||"-"}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm hidden md:table-cell",children:A.faceCount||0}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm",children:e.jsxs("div",{className:"flex gap-1 md:gap-2",children:[e.jsx("button",{onClick:()=>{var K;M(A),B({personId:A.personSn||"",personName:A.name||"",phone:A.phone||"",gender:A.gender||"",personType:((K=A.personType)==null?void 0:K.toString())||"0"}),T(!0)},className:"px-2 md:px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs md:text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>ne(A.personSn),className:"px-2 md:px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-xs md:text-sm",children:"Hapus"})]})})]},J))})]})})}),e.jsxs("div",{className:`text-sm mt-4 pt-4 border-t ${t==="dark"?"border-white/10 text-white/70":"border-gray-200 text-gray-600"}`,children:["Total: ",b.length," person"]})]}):e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:a?"Memuat data...":"Tidak ada data person. Klik Refresh untuk memuat data."})]}),m==="add-user"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Tambah User Baru"}),e.jsx("p",{className:`text-xs md:text-sm mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Tambah user baru ke device. Minimal isi Employee ID dan Nama. Upload foto wajah untuk langsung aktifkan facial recognition."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Person SN (Employee ID) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.personId,onChange:A=>B({...o,personId:A.target.value}),placeholder:"EMP001",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Nomor unik karyawan/user (wajib) - Contoh: EMP001, EMP002, dll"}),e.jsx("p",{className:`text-xs mt-1 font-semibold ${t==="dark"?"text-blue-400":"text-blue-600"}`,children:" Catatan: Person SN berbeda dengan Device SN. Person SN adalah ID karyawan, Device SN adalah ID device (30EC19CE8B9D2A49)."})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Nama Lengkap ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.personName,onChange:A=>B({...o,personName:A.target.value}),placeholder:"Nama Lengkap",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Nama user (wajib)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Nomor HP (Opsional)"}),e.jsx("input",{type:"text",value:o.phone,onChange:A=>B({...o,phone:A.target.value}),placeholder:"081234567890",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Gender (Opsional)"}),e.jsxs("select",{value:o.gender,onChange:A=>B({...o,gender:A.target.value}),className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"",children:"Pilih Gender"}),e.jsx("option",{value:"M",children:"Male"}),e.jsx("option",{value:"F",children:"Female"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Foto Wajah (Opsional)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:re,className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),o.faceImagePreview&&e.jsxs("div",{className:"mt-3",children:[e.jsx("img",{src:o.faceImagePreview,alt:"Preview",className:"max-w-xs rounded-lg border border-gray-300"}),e.jsx("button",{type:"button",onClick:()=>B({...o,faceImage:null,faceImagePreview:null}),className:"mt-2 px-3 py-1 bg-red-600 text-white rounded text-sm hover:bg-red-700",children:"Hapus Foto"})]}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Upload foto wajah untuk langsung mendaftarkan wajah ke device. Jika tidak diisi, user bisa daftarkan wajah nanti di device."})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 md:gap-3 pt-2",children:[e.jsx("button",{onClick:V,disabled:a||!o.personId||!o.personName,className:"px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 text-sm md:text-base",children:a?"Menambahkan...":"Tambah User"}),e.jsx("button",{onClick:()=>{B({personId:"",personName:"",phone:"",gender:"",faceImage:null,faceImagePreview:null})},className:"px-4 md:px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm md:text-base",children:"Reset Form"})]})]}),m==="log"&&e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:`p-3 md:p-4 rounded-lg border ${t==="dark"?"bg-blue-500/10 border-blue-500/30":"bg-blue-50 border-blue-200"}`,children:[e.jsx("h4",{className:`text-sm md:text-base font-semibold mb-2 ${t==="dark"?"text-blue-300":"text-blue-900"}`,children:" Konfigurasi Callback URL"}),e.jsx("p",{className:`text-xs md:text-sm mb-3 ${t==="dark"?"text-blue-200/80":"text-blue-800"}`,children:"Agar device dapat mengirim log scan secara real-time, set callback URL berikut di device melalui middleware:"}),e.jsxs("div",{className:`p-2 md:p-3 rounded bg-black/10 font-mono text-xs md:text-sm break-all ${t==="dark"?"text-blue-200":"text-blue-900"}`,children:[U,"/api/device/scan"]}),e.jsxs("p",{className:`text-xs mt-2 ${t==="dark"?"text-blue-200/70":"text-blue-700"}`,children:[e.jsx("strong",{children:"Device IP 192.168.31.49:10010:"})," Backend sudah dikonfigurasi untuk menerima data dari device ini."]}),e.jsxs("p",{className:`text-xs mt-2 ${t==="dark"?"text-blue-200/70":"text-blue-700"}`,children:[e.jsx("strong",{children:"Endpoint untuk set di device:"})," POST http://",r.middlewareIP||"MIDDLEWARE_IP",":8190/api/device/setSevConfig",e.jsx("br",{}),e.jsx("strong",{children:"Body:"})," deviceKey=",r.deviceKey||"DEVICE_KEY","&secret=",r.secret||"SECRET","&sevUploadRecRecordUrl=",U,"/api/device/scan&sevUploadRecSnapshotEnable=1"]}),e.jsx("button",{onClick:async()=>{var A,J;if(!r.middlewareIP||!r.deviceKey||!r.secret){p("error","Silakan lengkapi konfigurasi middleware terlebih dahulu di tab Config");return}l(!0);try{const K=localStorage.getItem("token"),ae=`${U}/api/device/scan`,G=await R.post(`${U}/api/device/set-callback-url`,{middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),callbackUrl:ae},{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"},timeout:3e4});p("success",G.data.message||"Callback URL berhasil dikonfigurasi di device")}catch(K){console.error("[Frontend] Error setting callback URL:",K);const ae=((J=(A=K.response)==null?void 0:A.data)==null?void 0:J.message)||K.message||"Gagal mengkonfigurasi callback URL";p("error",ae)}l(!1)},disabled:a||!r.middlewareIP||!r.deviceKey||!r.secret,className:"mt-3 px-3 md:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 text-xs md:text-sm",children:a?"Mengkonfigurasi...":"Set Callback URL ke Device"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Log Scan Biometrik (Real-time)"}),N&&m==="log"&&e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-full bg-green-100 border border-green-300",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Auto-refresh ON"})]})]}),e.jsxs("p",{className:`text-xs ${t==="dark"?"text-white/60":"text-gray-500"}`,children:["Data log scan yang diterima langsung dari device.",H&&e.jsxs("span",{className:"ml-1",children:["Last updated: ",H.toLocaleTimeString("id-ID")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:g,onChange:A=>u(parseInt(A.target.value)),className:`px-2 py-2 text-xs rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"3000",children:"3s"}),e.jsx("option",{value:"5000",children:"5s"}),e.jsx("option",{value:"10000",children:"10s"}),e.jsx("option",{value:"30000",children:"30s"}),e.jsx("option",{value:"60000",children:"60s"})]}),e.jsx("button",{onClick:()=>k(!N),className:`px-3 py-2 rounded-lg transition-colors flex items-center gap-2 text-xs font-medium ${N?"bg-green-600 hover:bg-green-700 text-white":t==="dark"?"bg-gray-600 hover:bg-gray-700 text-white":"bg-gray-300 hover:bg-gray-400 text-gray-900"}`,children:N?" Auto":" Manual"}),e.jsxs("button",{onClick:z,disabled:a,className:"px-3 md:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(vt,{className:a?"animate-spin":""}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),j.length>0?e.jsx("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:e.jsxs("table",{className:`min-w-full divide-y ${t==="dark"?"divide-white/10 text-white":"divide-gray-200 text-gray-900"}`,children:[e.jsx("thead",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Waktu Scan"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Person SN"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Nama"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold hidden sm:table-cell",children:"Metode"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold hidden md:table-cell",children:"Status"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold hidden lg:table-cell",children:"Device"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-white/5":"divide-gray-100"}`,children:j.map((A,J)=>{let K="-";A.faceFlag===1?K="Face":A.palmFlag===1?K="Palm":A.cardFlag===1?K="Card":A.fingerFlag===1&&(K="Finger");let ae="-",G="bg-gray-100 text-gray-800";A.resultFlag===1?(ae="Success",G="bg-green-100 text-green-800"):A.resultFlag===2?(ae="Failed",G="bg-red-100 text-red-800"):A.resultFlag===3&&(ae="No Permission",G="bg-yellow-100 text-yellow-800"),A.strangerFlag===1&&(ae="Stranger",G="bg-orange-100 text-orange-800");const ce=A.recordTimeTs?new Date(A.recordTimeTs).toLocaleString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):A.recordTime?new Date(parseInt(A.recordTime)).toLocaleString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return e.jsxs("tr",{className:t==="dark"?"hover:bg-white/5":"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm whitespace-nowrap",children:ce}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm whitespace-nowrap",children:A.personSn||"-"}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm",children:A.personName||"-"}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm hidden sm:table-cell",children:K}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm hidden md:table-cell",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs ${G}`,children:ae})}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm hidden lg:table-cell",children:A.deviceKey||"-"})]},A.id||J)})})]})})}):e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:a?"Memuat data...":e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{children:"Tidak ada data log scan."}),e.jsxs("p",{className:"text-xs",children:["Pastikan device sudah dikonfigurasi untuk mengirim callback ke:",e.jsx("br",{}),e.jsxs("code",{className:`px-2 py-1 rounded ${t==="dark"?"bg-white/10":"bg-gray-100"}`,children:[U,"/api/device/scan"]})]}),e.jsx("p",{className:"text-xs mt-2",children:'Gunakan tombol "Set Callback URL ke Device" di atas untuk mengkonfigurasi secara otomatis.'})]})})]}),!1,!1,!1,!1,!1,!1,!1,a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 flex items-center gap-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600"}),e.jsx("span",{children:"Memproses..."})]})})]})]}),_&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:`w-full max-w-md rounded-lg shadow-xl ${t==="dark"?"bg-[#26355D]":"bg-white"} p-4 md:p-6`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 md:mb-6",children:[e.jsx("h3",{className:`text-lg md:text-xl font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Edit Person"}),e.jsx("button",{onClick:()=>{T(!1),M(null),B({personId:"",personName:"",phone:"",gender:""})},className:`p-2 rounded-lg transition-colors ${t==="dark"?"hover:bg-white/10 text-white":"hover:bg-gray-100 text-gray-600"}`,children:e.jsx(pr,{})})]}),e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Person ID (SN) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.personId,onChange:A=>B({...o,personId:A.target.value}),placeholder:"EMP-20241201-001",disabled:!0,className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-white/5 border-white/20 text-white/70":"bg-gray-50 border-gray-300 text-gray-500"} focus:outline-none cursor-not-allowed`}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Person ID tidak dapat diubah"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Person Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:o.personName,onChange:A=>B({...o,personName:A.target.value}),placeholder:"Nama Lengkap",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Phone (Opsional)"}),e.jsx("input",{type:"text",value:o.phone,onChange:A=>B({...o,phone:A.target.value}),placeholder:"081234567890",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Gender (Opsional)"}),e.jsxs("select",{value:o.gender,onChange:A=>B({...o,gender:A.target.value}),className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"",children:"Pilih Gender"}),e.jsx("option",{value:"M",children:"Male"}),e.jsx("option",{value:"F",children:"Female"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 md:gap-3 mt-4 md:mt-6",children:[e.jsx("button",{onClick:me,disabled:a||!o.personId||!o.personName,className:"flex-1 px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 text-sm md:text-base",children:a?"Menyimpan...":"Update Person"}),e.jsx("button",{onClick:()=>{T(!1),M(null),B({personId:"",personName:"",phone:"",gender:""})},className:"flex-1 px-4 md:px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm md:text-base",children:"Batal"})]})]})})]})}const wt=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),qn=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),Wn=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),_n=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"})});function Vn(){const{theme:t}=Ne(),[r,s]=d.useState({middlewareIP:"",deviceKey:"",secret:""}),[i,n]=d.useState(!1),[a,l]=d.useState("config"),[m,C]=d.useState({type:"",text:""}),[b,y]=d.useState([]),[j,S]=d.useState([]),[D,c]=d.useState(""),[L,v]=d.useState({}),[w,I]=d.useState(new Set),[W,Q]=d.useState(!1),[N,k]=d.useState({personSn:"",palmId:"",palmNum:"1",feature:"",palmImage:null,palmImagePreview:null}),[g,u]=d.useState([]);d.useEffect(()=>{const $=localStorage.getItem("deviceConfig");if($)try{const X=JSON.parse($);s({middlewareIP:X.middlewareIP||"192.168.31.231",deviceKey:X.deviceKey||"30EC19CE8B9D2A49",secret:X.secret||"123456"})}catch(X){console.error("Error parsing device config:",X),s({middlewareIP:"192.168.31.231",deviceKey:"30EC19CE8B9D2A49",secret:"123456"})}else s({middlewareIP:"192.168.31.231",deviceKey:"30EC19CE8B9D2A49",secret:"123456"})},[]);const H=($,X)=>{C({type:$,text:X}),setTimeout(()=>C({type:"",text:""}),5e3)},f=()=>{var X,p,F;const $={middlewareIP:((X=r.middlewareIP)==null?void 0:X.trim())||"",deviceKey:((p=r.deviceKey)==null?void 0:p.trim())||"",secret:((F=r.secret)==null?void 0:F.trim())||""};if(!$.middlewareIP||!$.deviceKey||!$.secret){const h=[];$.middlewareIP||h.push("Middleware IP"),$.deviceKey||h.push("Device Key"),$.secret||h.push("Secret"),H("error",`${h.join(", ")} wajib diisi`);return}localStorage.setItem("deviceConfig",JSON.stringify($)),s($),H("success","Konfigurasi device berhasil disimpan")},o=async()=>{var $,X;if(!r.middlewareIP||!r.deviceKey||!r.secret){H("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}if(!N.personSn||!N.palmId||!N.feature){H("error","Person SN, Palm ID, dan Feature wajib diisi");return}n(!0);try{const p=localStorage.getItem("token"),F=await R.post(`${U}/api/palm/register`,{middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),personSn:N.personSn.trim(),palmId:N.palmId.trim(),palmNum:parseInt(N.palmNum),feature:N.feature.trim()},{headers:{Authorization:`Bearer ${p}`}});H("success",F.data.message||"Palm berhasil didaftarkan"),k({personSn:"",palmId:"",palmNum:"1",feature:"",palmImage:null,palmImagePreview:null})}catch(p){console.error(p),H("error",((X=($=p.response)==null?void 0:$.data)==null?void 0:X.message)||"Gagal mendaftarkan palm")}n(!1)},B=async()=>{var $,X;if(!r.middlewareIP||!r.deviceKey||!r.secret){H("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}if(g.length===0){H("error","Silakan tambahkan minimal 1 palm untuk batch register");return}n(!0);try{const p=localStorage.getItem("token"),F=await R.post(`${U}/api/palm/batch-register`,{middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),palmMergeList:g},{headers:{Authorization:`Bearer ${p}`}});H("success",F.data.message||"Batch palm berhasil didaftarkan"),u([])}catch(p){console.error(p),H("error",((X=($=p.response)==null?void 0:$.data)==null?void 0:X.message)||"Gagal batch register palm")}n(!1)},ee=async($,X)=>{var p,F;if(!r.middlewareIP||!r.deviceKey||!r.secret){H("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}if(confirm(`Apakah Anda yakin ingin menghapus palm ${X} untuk person ${$}?`)){n(!0);try{const h=localStorage.getItem("token"),E=await R.post(`${U}/api/palm/delete`,{middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),personSn:$.trim(),palmId:X.trim()},{headers:{Authorization:`Bearer ${h}`}});H("success",E.data.message||"Palm berhasil dihapus"),a==="persons"?Y():M()}catch(h){console.error(h),H("error",((F=(p=h.response)==null?void 0:p.data)==null?void 0:F.message)||"Gagal menghapus palm")}n(!1)}},M=async($=null)=>{var p,F;if(!r.middlewareIP||!r.deviceKey||!r.secret){H("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}const X=$||N.personSn;if(!X){H("error","Silakan isi Person SN untuk mencari palm");return}n(!0);try{const h=localStorage.getItem("token"),E=await R.post(`${U}/api/palm/find`,{middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),personSn:X.trim()},{headers:{Authorization:`Bearer ${h}`}});E.data&&Array.isArray(E.data.data)?(y(E.data.data),H("success",`Berhasil memuat ${E.data.data.length} palm data`)):(y([]),H("warning","Tidak ada data palm ditemukan"))}catch(h){console.error(h),H("error",((F=(p=h.response)==null?void 0:p.data)==null?void 0:F.message)||"Gagal memuat data palm"),y([])}n(!1)},_=()=>{if(!N.personSn||!N.palmId||!N.feature){H("error","Person SN, Palm ID, dan Feature wajib diisi");return}const $={personSn:N.personSn.trim(),palmId:N.palmId.trim(),palmNum:parseInt(N.palmNum),feature:N.feature.trim()};u([...g,$]),k({personSn:"",palmId:"",palmNum:"1",feature:"",palmImage:null,palmImagePreview:null}),H("success","Palm ditambahkan ke batch list")},T=$=>{const X=g.filter((p,F)=>F!==$);u(X)},Y=async()=>{var $,X,p,F,h;if(!r.middlewareIP||!r.deviceKey||!r.secret){H("error","Silakan lengkapi konfigurasi middleware terlebih dahulu");return}n(!0),S([]),v({});try{const E=localStorage.getItem("token"),z=await R.post(`${U}/api/device/persons`,{middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim()},{headers:{Authorization:`Bearer ${E}`}});if(console.log("[Device2] Person list RAW response:",z.data),console.log("[Device2] Person list length:",($=z.data)==null?void 0:$.length),Array.isArray(z.data)&&z.data.length>0){console.log("[Device2] First person data:",z.data[0]),S(z.data),n(!1),Q(!0),H("info",`Memuat data palm untuk ${z.data.length} person...`);const Z={};let ne=0;for(const re of z.data){const V=re.sn||re.personSn;console.log(`[Device2] Loading palm for person: ${V} (${re.name})`);try{const me=await R.post(`${U}/api/palm/find`,{middlewareIP:r.middlewareIP.trim(),deviceKey:r.deviceKey.trim(),secret:r.secret.trim(),personSn:V},{headers:{Authorization:`Bearer ${E}`}});console.log(`[Device2] Palm response for ${V}:`,me.data),me.data&&Array.isArray(me.data.data)?(Z[V]=me.data.data,console.log(`[Device2] Found ${me.data.data.length} palms for ${V}`)):(Z[V]=[],console.log(`[Device2] No palm data for ${V}`)),ne++}catch(me){console.error(`[Device2] Error loading palm for ${V}:`,me),console.error("[Device2] Error details:",(X=me.response)==null?void 0:X.data),Z[V]=[]}}console.log("[Device2] Final palm data map:",Z),v(Z),Q(!1),H("success",`Berhasil memuat ${z.data.length} person (${ne} dengan data palm)`)}else S([]),v({}),H("warning","Tidak ada data person di device")}catch(E){console.error("[Device2] Error loading person list:",E),console.error("[Device2] Error response:",(p=E.response)==null?void 0:p.data),H("error",((h=(F=E.response)==null?void 0:F.data)==null?void 0:h.message)||"Gagal memuat data person"),S([]),v({}),n(!1),Q(!1)}},oe=$=>{const X=new Set(w);X.has($)?X.delete($):X.add($),I(X)};return e.jsx("div",{className:`p-4 md:p-6 min-h-screen transition-colors duration-300 ${t==="dark"?"bg-[#1a2440]":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:`mb-4 md:mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:[e.jsxs("h1",{className:"text-xl md:text-2xl lg:text-3xl font-bold mb-1 md:mb-2 flex items-center gap-2",children:[e.jsx(_n,{}),"Device 2 - Palm Management"]}),e.jsx("p",{className:"text-xs md:text-sm opacity-70",children:"Kelola palm print/palm vein melalui middleware server"})]}),m.text&&e.jsxs("div",{className:`mb-3 md:mb-4 p-3 md:p-4 rounded-lg flex items-center gap-2 text-sm md:text-base ${m.type==="success"?"bg-green-100 text-green-800 border border-green-300":m.type==="warning"?"bg-yellow-100 text-yellow-800 border border-yellow-300":m.type==="info"?"bg-blue-100 text-blue-800 border border-blue-300":"bg-red-100 text-red-800 border border-red-300"}`,children:[m.type==="success"?e.jsx(qn,{}):m.type==="info"?e.jsx(wt,{}):e.jsx(Wn,{}),e.jsx("span",{children:m.text})]}),e.jsx("div",{className:`mb-4 md:mb-6 border-b ${t==="dark"?"border-white/10":"border-gray-200"}`,children:e.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-purple-500 scrollbar-track-transparent",children:e.jsx("div",{className:"flex gap-1 md:gap-2 min-w-max pb-1",children:[{key:"config",label:"Konfigurasi"},{key:"persons",label:"Daftar Person"},{key:"register",label:"Register Palm"},{key:"batch",label:"Batch Register"},{key:"search",label:"Cari Palm"}].map($=>e.jsx("button",{onClick:()=>l($.key),className:`px-3 md:px-4 py-2 font-medium text-xs md:text-sm transition-all whitespace-nowrap flex-shrink-0 ${a===$.key?t==="dark"?"text-white border-b-2 border-purple-500 bg-purple-500/10":"text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50":t==="dark"?"text-white/60 hover:text-white hover:bg-white/5":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:$.label},$.key))})})}),e.jsxs("div",{className:`rounded-lg md:rounded-xl shadow-lg p-4 md:p-6 transition-colors ${t==="dark"?"bg-[#26355D]":"bg-white"}`,children:[a==="config"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Middleware Server IP Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.middlewareIP,onChange:$=>s({...r,middlewareIP:$.target.value}),placeholder:"192.168.31.231",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Device SN (Serial Number) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:r.deviceKey,onChange:$=>s({...r,deviceKey:$.target.value}),placeholder:"30EC19CE8B9D2A49",maxLength:16,className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Secret (Password) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",value:r.secret,onChange:$=>s({...r,secret:$.target.value}),placeholder:"123456",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsx("button",{onClick:f,className:"px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm md:text-base",children:"Simpan Konfigurasi"})]}),a==="persons"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Daftar Person"}),e.jsxs("button",{onClick:Y,disabled:i||W,className:"px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(wt,{}),i?"Memuat Person...":W?"Memuat Palm...":"Refresh"]})]}),j.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:`min-w-full divide-y ${t==="dark"?"divide-white/10 text-white":"divide-gray-200 text-gray-900"}`,children:[e.jsx("thead",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Person SN"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Nama"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Gender"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Phone"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Palm Data"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Action"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-white/5":"divide-gray-100"}`,children:j.map(($,X)=>{console.log(`[Device2 Render] Person ${X}:`,$);const p=$.sn||$.personSn,F=L[p]||[],h=w.has(p);return e.jsxs(dt.Fragment,{children:[e.jsxs("tr",{className:t==="dark"?"hover:bg-white/5":"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 py-2 text-sm font-medium",children:p||"-"}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.name||"-"}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.gender===1?"Male":$.gender===2?"Female":"-"}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.mobile||$.phone||"-"}),e.jsx("td",{className:"px-3 py-2 text-sm",children:W?e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-600 animate-pulse",children:"Loading..."}):e.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${F.length>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:[F.length," palm"]})}),e.jsx("td",{className:"px-3 py-2 text-sm",children:F.length>0?e.jsx("button",{onClick:()=>oe(p),className:"text-purple-600 hover:text-purple-800 font-medium",children:h?"Sembunyikan":"Lihat Detail"}):e.jsx("span",{className:`text-xs ${t==="dark"?"text-white/40":"text-gray-400"}`,children:"No palm data"})})]}),h&&F.length>0&&e.jsx("tr",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsx("td",{colSpan:"6",className:"px-3 py-3",children:e.jsxs("div",{className:"pl-8",children:[e.jsxs("h4",{className:`text-sm font-semibold mb-2 ${t==="dark"?"text-white":"text-gray-900"}`,children:["Palm Data untuk ",$.name,":"]}),e.jsxs("table",{className:`min-w-full text-xs ${t==="dark"?"text-white/80":"text-gray-700"}`,children:[e.jsx("thead",{children:e.jsxs("tr",{className:t==="dark"?"bg-white/5":"bg-gray-100",children:[e.jsx("th",{className:"px-2 py-1 text-left",children:"Palm ID"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Hand"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Create Time"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Feature"}),e.jsx("th",{className:"px-2 py-1 text-left",children:"Action"})]})}),e.jsx("tbody",{children:F.map((E,z)=>{var Z;return e.jsxs("tr",{className:t==="dark"?"border-t border-white/5":"border-t border-gray-200",children:[e.jsx("td",{className:"px-2 py-1",children:E.palmId}),e.jsx("td",{className:"px-2 py-1",children:E.palmNum===1?" Left":E.palmNum===2?" Right":E.palmNum}),e.jsx("td",{className:"px-2 py-1",children:E.createTime?new Date(E.createTime).toLocaleString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}),e.jsxs("td",{className:"px-2 py-1 truncate max-w-xs",title:E.feature,children:[(Z=E.feature)==null?void 0:Z.substring(0,30),"..."]}),e.jsx("td",{className:"px-2 py-1",children:e.jsx("button",{onClick:()=>ee(p,E.palmId),className:"text-red-600 hover:text-red-800 font-medium",children:"Hapus"})})]},z)})})]})]})})})]},p||X)})})]}),e.jsxs("div",{className:`mt-3 text-sm ${t==="dark"?"text-white/60":"text-gray-600"}`,children:["Total: ",j.length," person"]})]}):e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:i?"Memuat data...":"Tidak ada data person. Klik Refresh untuk memuat data."})]}),a==="register"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Register Palm Print/Palm Vein"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Person SN ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:N.personSn,onChange:$=>k({...N,personSn:$.target.value}),placeholder:"EMP001",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Palm ID ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:N.palmId,onChange:$=>k({...N,palmId:$.target.value}),placeholder:"001",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Palm Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{value:N.palmNum,onChange:$=>k({...N,palmNum:$.target.value}),className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"1",children:"1 - Left Hand"}),e.jsx("option",{value:"2",children:"2 - Right Hand"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Feature (Base64) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:N.feature,onChange:$=>k({...N,feature:$.target.value}),placeholder:"Rk1SACAyMAAAAAF6AAAA/AFEAMUAxQEAAABm...",rows:4,className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),e.jsx("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:"Feature value dalam format base64"})]})]}),e.jsx("button",{onClick:o,disabled:i,className:"px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 text-sm md:text-base",children:i?"Mendaftarkan...":"Register Palm"})]}),a==="batch"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Batch Register Palm"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Person SN"}),e.jsx("input",{type:"text",value:N.personSn,onChange:$=>k({...N,personSn:$.target.value}),placeholder:"EMP001",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Palm ID"}),e.jsx("input",{type:"text",value:N.palmId,onChange:$=>k({...N,palmId:$.target.value}),placeholder:"001",className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Palm Number"}),e.jsxs("select",{value:N.palmNum,onChange:$=>k({...N,palmNum:$.target.value}),className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"1",children:"1 - Left Hand"}),e.jsx("option",{value:"2",children:"2 - Right Hand"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Feature (Base64)"}),e.jsx("textarea",{value:N.feature,onChange:$=>k({...N,feature:$.target.value}),placeholder:"Rk1SACAyMAAAAAF6AAAA/AFEAMUAxQEAAABm...",rows:3,className:`w-full px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]})]}),e.jsx("button",{onClick:_,className:"px-4 md:px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm md:text-base",children:"Tambah ke Batch List"}),g.length>0&&e.jsxs("div",{className:"mt-6",children:[e.jsxs("h4",{className:`text-sm md:text-base font-semibold mb-3 ${t==="dark"?"text-white":"text-gray-900"}`,children:["Batch List (",g.length," items)"]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:`min-w-full divide-y ${t==="dark"?"divide-white/10 text-white":"divide-gray-200 text-gray-900"}`,children:[e.jsx("thead",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Person SN"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Palm ID"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Palm Num"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Feature"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Action"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-white/5":"divide-gray-100"}`,children:g.map(($,X)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-sm",children:$.personSn}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.palmId}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.palmNum===1?"Left":"Right"}),e.jsxs("td",{className:"px-3 py-2 text-sm truncate max-w-xs",children:[$.feature.substring(0,30),"..."]}),e.jsx("td",{className:"px-3 py-2 text-sm",children:e.jsx("button",{onClick:()=>T(X),className:"text-red-600 hover:text-red-800",children:"Hapus"})})]},X))})]})}),e.jsx("button",{onClick:B,disabled:i,className:"mt-4 px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 text-sm md:text-base",children:i?"Mendaftarkan...":`Batch Register (${g.length} items)`})]})]}),a==="search"&&e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Cari Palm Data"}),e.jsx("div",{className:`p-3 rounded-lg border ${t==="dark"?"bg-blue-500/10 border-blue-500/30":"bg-blue-50 border-blue-200"}`,children:e.jsxs("p",{className:`text-xs md:text-sm ${t==="dark"?"text-blue-200/80":"text-blue-800"}`,children:[" ",e.jsx("strong",{children:"Tip:"})," Tidak tahu Person SN? Buka tab ",e.jsx("strong",{children:'"Daftar Person"'})," untuk melihat semua person yang terdaftar dan langsung cari palm mereka."]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:N.personSn,onChange:$=>k({...N,personSn:$.target.value}),placeholder:"Masukkan Person SN (e.g., EMP001)",className:`flex-1 px-3 md:px-4 py-2 rounded-lg border text-sm md:text-base ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),e.jsxs("button",{onClick:()=>M(),disabled:i,className:"px-4 md:px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(wt,{}),"Cari"]})]}),b.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:`min-w-full divide-y ${t==="dark"?"divide-white/10 text-white":"divide-gray-200 text-gray-900"}`,children:[e.jsx("thead",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Person SN"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Palm ID"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Palm Num"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Create Time"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Feature"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-semibold",children:"Action"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-white/5":"divide-gray-100"}`,children:b.map(($,X)=>{var p;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-sm",children:$.personSn}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.palmId}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.palmNum===1?"Left Hand":"Right Hand"}),e.jsx("td",{className:"px-3 py-2 text-sm",children:$.createTime?new Date($.createTime).toLocaleString("id-ID"):"-"}),e.jsxs("td",{className:"px-3 py-2 text-sm truncate max-w-xs",children:[(p=$.feature)==null?void 0:p.substring(0,30),"..."]}),e.jsx("td",{className:"px-3 py-2 text-sm",children:e.jsx("button",{onClick:()=>ee($.personSn,$.palmId),className:"text-red-600 hover:text-red-800",children:"Hapus"})})]},X)})})]})}):e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:i?"Memuat data...":"Tidak ada data palm. Masukkan Person SN dan klik Cari."})]})]})]})})}const Jn=()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"})}),Gn=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),Qn=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),Xe=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})});function Yn(){const{theme:t}=Ne(),r={middlewareIP:"192.168.31.231",deviceKey:"30EC19CE8B9D2A49",secret:"123456",deviceIP:"192.168.31.49"},[s,i]=d.useState("dashboard"),[n,a]=d.useState(!1),[l,m]=d.useState({type:"",text:""}),[C,b]=d.useState(null),[y,j]=d.useState("unknown"),[S,D]=d.useState([]),[c,L]=d.useState([]),[v,w]=d.useState(!0),[I,W]=d.useState(5e3),[Q,N]=d.useState(null),[k,g]=d.useState({personSn:"",name:"",gender:"",phone:"",deptName:"",idNumber:"",password:""}),[u,H]=d.useState({personSn:"",bioType:"face",feature:"",image:null,imagePreview:null,palmNum:"1",cardNumber:""}),[f,o]=d.useState([]),[B,ee]=d.useState(!1);d.useEffect(()=>{s==="dashboard"?_():s==="log"&&c.length===0?(console.log("[Auto-load] Loading attendance records..."),T(!1)):s==="biometric"&&(console.log("[Auto-load] Loading available users for biometric registration..."),Y())},[s]),d.useEffect(()=>{s==="biometric"&&Y()},[u.bioType]),d.useEffect(()=>{let h=null;return v&&s==="log"&&(console.log("[Auto-Refresh] Enabled for Log tab (interval: "+I/1e3+"s)"),h=setInterval(()=>{console.log("[Auto-Refresh] Fetching new scan records (silent mode)..."),T(!0),N(new Date)},I)),()=>{h&&(console.log("[Auto-Refresh] Cleanup: clearing interval"),clearInterval(h))}},[v,s,I]);const M=(h,E)=>{m({type:h,text:E}),setTimeout(()=>m({type:"",text:""}),5e3)},_=async()=>{var h,E;a(!0),j("checking");try{const z=localStorage.getItem("token"),Z=await R.post(`${U}/api/device/info`,{middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret},{headers:{Authorization:`Bearer ${z}`}});Z.data&&(b(Z.data),j("connected"),M("success","Device terhubung dengan baik!"))}catch(z){console.error(z),j("disconnected"),M("error",((E=(h=z.response)==null?void 0:h.data)==null?void 0:E.message)||"Gagal terhubung ke device"),b(null)}a(!1)},T=async(h=!1)=>{var E,z,Z,ne,re,V,me,A,J;console.log("[Frontend] loadAttendanceRecords called:",{silent:h,activeTab:s}),h||a(!0);try{const K=localStorage.getItem("token");if(!K){console.error("[Frontend] No token found"),h||M("error","Token tidak ditemukan. Silakan login ulang."),a(!1);return}const ae={deviceKey:r.deviceKey,limit:500,offset:0};console.log("[Frontend] Requesting scan records from database:",ae);const G=await R.post(`${U}/api/device/scan/records`,ae,{headers:{Authorization:`Bearer ${K}`,"Content-Type":"application/json"},timeout:3e4});console.log("[Frontend] Scan records response:",{status:G.status,total:((E=G.data)==null?void 0:E.total)||0,recordsLength:((Z=(z=G.data)==null?void 0:z.records)==null?void 0:Z.length)||0,sampleData:((re=(ne=G.data)==null?void 0:ne.records)==null?void 0:re[0])||"No data"}),G.data&&G.data.records&&Array.isArray(G.data.records)?(console.log("[Frontend] Setting attendanceRecords:",G.data.records.length,"records"),L(G.data.records),h||(G.data.records.length>0?M("success",`Berhasil memuat ${G.data.records.length} log scan (Total: ${G.data.total})`):M("warning","Tidak ada data log scan."))):(console.warn("[Frontend] No records in response or invalid format"),L([]),h||M("warning","Tidak ada data log scan"))}catch(K){if(console.error("[Frontend] Error loading scan records:",K),console.error("[Frontend] Error details:",{message:K.message,response:(V=K.response)==null?void 0:V.data,status:(me=K.response)==null?void 0:me.status}),!h){const ae=((J=(A=K.response)==null?void 0:A.data)==null?void 0:J.message)||K.message||"Gagal memuat data log scan";M("error",ae)}L([])}h||a(!1)},Y=async()=>{var h,E;ee(!0);try{const z=localStorage.getItem("token");console.log("[Biometric] Loading all users from device...");const Z=await R.post(`${U}/api/device/persons`,{middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret},{headers:{Authorization:`Bearer ${z}`}});if(!Array.isArray(Z.data)||Z.data.length===0){console.log("[Biometric] No users found on device"),o([]),ee(!1);return}console.log(`[Biometric] Found ${Z.data.length} users. Checking biometric data...`);const ne=await Promise.all(Z.data.map(async V=>{const me=V.sn||V.personSn;let A=!1,J=!1;if(u.bioType==="face")try{const K=await R.post(`${U}/api/device/face/find`,{middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret,personSn:me},{headers:{Authorization:`Bearer ${z}`}});A=K.data&&(Array.isArray(K.data)?K.data.length>0:!!K.data.faceId)}catch{A=!1}if(u.bioType==="palm")try{const K=await R.post(`${U}/api/palm/find`,{middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret,personSn:me},{headers:{Authorization:`Bearer ${z}`}});J=K.data&&(Array.isArray(K.data)?K.data.length>0:!!K.data.palmId)}catch{J=!1}return{...V,personSn:me,hasFace:A,hasPalm:J}}));let re=[];u.bioType==="face"?(re=ne.filter(V=>!V.hasFace),console.log(`[Biometric] ${re.length} users without Face data`)):u.bioType==="palm"?(re=ne.filter(V=>!V.hasPalm),console.log(`[Biometric] ${re.length} users without Palm data`)):re=ne,o(re)}catch(z){console.error("[Biometric] Error loading available users:",z),M("error",((E=(h=z.response)==null?void 0:h.data)==null?void 0:E.message)||"Gagal memuat daftar user"),o([])}ee(!1)},oe=async()=>{var h,E;a(!0);try{const z=localStorage.getItem("token"),Z=await R.post(`${U}/api/device/persons`,{middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret},{headers:{Authorization:`Bearer ${z}`}});Array.isArray(Z.data)?(D(Z.data),M("success",`Berhasil memuat ${Z.data.length} user dari device`)):(D([]),M("warning","Tidak ada data user"))}catch(z){console.error(z),M("error",((E=(h=z.response)==null?void 0:h.data)==null?void 0:E.message)||"Gagal memuat data user"),D([])}a(!1)},$=async()=>{var z,Z,ne;const h=k.personSn?k.personSn.trim():"",E=k.name?k.name.trim():"";if(!h||h===""){M("error","Person SN (Employee ID) wajib diisi dan tidak boleh kosong");return}if(!E||E===""){M("error","Nama wajib diisi dan tidak boleh kosong");return}console.log("[Biometric] Adding user - validation passed:",{personSn:h,personSnLength:h.length,name:E,nameLength:E.length}),a(!0);try{const re=localStorage.getItem("token"),V={middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret,personSn:h,name:E};k.gender&&k.gender.trim()&&(V.gender=k.gender.trim()),k.phone&&k.phone.trim()&&(V.phone=k.phone.trim()),k.deptName&&k.deptName.trim()&&(V.deptName=k.deptName.trim()),k.idNumber&&k.idNumber.trim()&&(V.idNumber=k.idNumber.trim()),k.password&&k.password.trim()&&(V.password=k.password.trim()),console.log("[Biometric] Sending request to backend:",{endpoint:"/api/device/person/merge",middlewareIP:V.middlewareIP,deviceKey:V.deviceKey,secret:"***",personSn:V.personSn,name:V.name,optionalFields:{gender:V.gender||"N/A",phone:V.phone||"N/A",deptName:V.deptName||"N/A",idNumber:V.idNumber||"N/A",password:V.password?"***":"N/A"}});const me=await R.post(`${U}/api/device/person/merge`,V,{headers:{Authorization:`Bearer ${re}`,"Content-Type":"application/json"},timeout:3e4});console.log("[Biometric] Add user response:",me.data),M("success",me.data.message||"User berhasil ditambahkan ke device!"),g({personSn:"",name:"",gender:"",phone:"",deptName:"",idNumber:"",password:""}),s==="users"&&oe()}catch(re){console.error("[Biometric] Add user error:",re),console.error("[Biometric] Error response:",(z=re.response)==null?void 0:z.data);const V=((ne=(Z=re.response)==null?void 0:Z.data)==null?void 0:ne.message)||re.message||"Gagal menambahkan user";M("error",V)}a(!1)},X=async()=>{var h,E,z;if(!u.personSn||!u.personSn.trim()){M("error","Silakan pilih user terlebih dahulu dari dropdown");return}if(u.bioType==="face"&&!u.feature&&!u.image){M("error","Silakan upload foto wajah atau masukkan feature");return}if(u.bioType==="palm"&&!u.feature&&!u.image){M("error","Silakan upload foto telapak tangan atau masukkan feature");return}if(u.bioType==="card"&&!u.cardNumber){M("error","Nomor kartu wajib diisi");return}console.log("[Biometric Registration] Starting registration:",{personSn:u.personSn,bioType:u.bioType,hasFeature:!!u.feature,hasImage:!!u.image}),a(!0);try{const Z=localStorage.getItem("token");let ne="",re={middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret,personSn:u.personSn.trim()};u.bioType==="face"?(ne="/api/device/face/register",re.image=u.feature||u.image,console.log("[Biometric Registration] Face endpoint:",ne)):u.bioType==="palm"?(ne="/api/palm/register",re.palmId=`PALM_${u.personSn}_${Date.now()}`,re.palmNum=parseInt(u.palmNum),re.feature=u.feature||u.image,console.log("[Biometric Registration] Palm endpoint:",ne,{palmId:re.palmId,palmNum:re.palmNum})):u.bioType==="card"&&(ne="/api/device/person/merge",re.cardNumber=u.cardNumber,console.log("[Biometric Registration] Card endpoint:",ne)),console.log("[Biometric Registration] Sending request to:",`${U}${ne}`);const V=await R.post(`${U}${ne}`,re,{headers:{Authorization:`Bearer ${Z}`,"Content-Type":"application/json"},timeout:3e4});console.log("[Biometric Registration] Response:",V.data);const me=u.bioType==="face"?"Face":u.bioType==="palm"?"Palm":"Card";M("success",V.data.message||`${me} berhasil didaftarkan!`),H({personSn:"",bioType:u.bioType,feature:"",image:null,imagePreview:null,palmNum:"1",cardNumber:""}),Y()}catch(Z){console.error("[Biometric Registration] Error:",Z),console.error("[Biometric Registration] Error response:",(h=Z.response)==null?void 0:h.data);const ne=((z=(E=Z.response)==null?void 0:E.data)==null?void 0:z.message)||Z.message||"Gagal mendaftarkan biometric";M("error",ne)}a(!1)},p=h=>{const E=h.target.files[0];if(E){if(!E.type.startsWith("image/")){M("error","File harus berupa gambar");return}if(E.size>2*1024*1024){M("error","Ukuran file maksimal 2MB");return}const z=new FileReader;z.onloadend=()=>{const Z=z.result,ne=new Image;ne.onload=()=>{const re=document.createElement("canvas");let V=ne.width,me=ne.height;const A=800;V>me&&V>A?(me=me*A/V,V=A):me>A&&(V=V*A/me,me=A),re.width=V,re.height=me,re.getContext("2d").drawImage(ne,0,0,V,me);const K=re.toDataURL("image/jpeg",.8);H({...u,image:K,imagePreview:K})},ne.src=Z},z.readAsDataURL(E)}},F=async h=>{var E,z;if(confirm(`Apakah Anda yakin ingin menghapus user dengan SN: ${h}?`)){a(!0);try{const Z=localStorage.getItem("token");await R.post(`${U}/api/device/person/delete`,{middlewareIP:r.middlewareIP,deviceKey:r.deviceKey,secret:r.secret,personSn:h},{headers:{Authorization:`Bearer ${Z}`}}),M("success","User berhasil dihapus"),oe()}catch(Z){console.error(Z),M("error",((z=(E=Z.response)==null?void 0:E.data)==null?void 0:z.message)||"Gagal menghapus user")}a(!1)}};return e.jsx("div",{className:`p-4 md:p-6 min-h-screen transition-colors duration-300 ${t==="dark"?"bg-[#1a2440]":"bg-gray-50"}`,children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:`mb-4 md:mb-6 ${t==="dark"?"text-white":"text-gray-900"}`,children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(Jn,{}),e.jsx("h1",{className:"text-2xl md:text-3xl font-bold",children:"Biometric Management"})]}),e.jsx("p",{className:"text-sm md:text-base opacity-70",children:"Kelola device biometric, user, dan registrasi face/palm/card"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-xs md:text-sm opacity-60",children:[e.jsxs("span",{children:["Device: ",r.deviceIP]}),e.jsx("span",{children:""}),e.jsxs("span",{children:["Middleware: ",r.middlewareIP,":",8190]}),e.jsx("span",{children:""}),e.jsxs("span",{children:["SN: ",r.deviceKey]})]})]}),l.text&&e.jsxs("div",{className:`mb-4 p-3 md:p-4 rounded-lg flex items-center gap-2 text-sm md:text-base ${l.type==="success"?"bg-green-100 text-green-800 border border-green-300":l.type==="warning"?"bg-yellow-100 text-yellow-800 border border-yellow-300":"bg-red-100 text-red-800 border border-red-300"}`,children:[l.type==="success"?e.jsx(Gn,{}):e.jsx(Qn,{}),e.jsx("span",{children:l.text})]}),e.jsx("div",{className:`mb-4 md:mb-6 border-b ${t==="dark"?"border-white/10":"border-gray-200"}`,children:e.jsx("div",{className:"overflow-x-auto scrollbar-thin scrollbar-thumb-purple-500 scrollbar-track-transparent",children:e.jsx("div",{className:"flex gap-2 min-w-max pb-1",children:[{key:"dashboard",label:"Dashboard",icon:""},{key:"adduser",label:"Add User",icon:""},{key:"biometric",label:"Register Biometric",icon:""},{key:"users",label:"User List",icon:""},{key:"log",label:"Log",icon:""}].map(h=>e.jsxs("button",{onClick:()=>{i(h.key),h.key==="users"&&oe(),h.key==="log"&&c.length===0&&T(!1)},className:`px-4 py-2 font-medium text-sm transition-all whitespace-nowrap flex items-center gap-2 ${s===h.key?t==="dark"?"text-white border-b-2 border-purple-500 bg-purple-500/10":"text-indigo-600 border-b-2 border-indigo-600 bg-indigo-50":t==="dark"?"text-white/60 hover:text-white hover:bg-white/5":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,children:[e.jsx("span",{children:h.icon}),e.jsx("span",{children:h.label})]},h.key))})})}),e.jsxs("div",{className:`rounded-lg shadow-lg p-4 md:p-6 transition-colors ${t==="dark"?"bg-[#26355D]":"bg-white"}`,children:[s==="dashboard"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:`text-xl font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Device Connection Status"}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:`relative w-32 h-32 rounded-full flex items-center justify-center border-4 ${y==="connected"?"border-green-500 bg-green-50":y==="disconnected"?"border-red-500 bg-red-50":"border-gray-300 bg-gray-50 animate-pulse"}`,children:e.jsx("div",{className:`text-4xl ${y==="connected"?"text-green-500":y==="disconnected"?"text-red-500":"text-gray-400"}`,children:y==="connected"?"":y==="disconnected"?"":"?"})})}),e.jsx("p",{className:`text-lg font-medium mb-2 ${y==="connected"?"text-green-600":y==="disconnected"?"text-red-600":t==="dark"?"text-white/60":"text-gray-600"}`,children:y==="connected"?" Device Connected":y==="disconnected"?" Device Disconnected":" Checking Connection..."}),e.jsxs("button",{onClick:_,disabled:n,className:"mt-4 px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center gap-2 mx-auto",children:[e.jsx(Xe,{}),n?"Checking...":"Check Connection"]})]}),C&&e.jsxs("div",{className:`mt-6 p-4 rounded-lg border ${t==="dark"?"border-white/10 bg-white/5":"border-gray-200 bg-gray-50"}`,children:[e.jsx("h3",{className:`text-lg font-semibold mb-3 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Device Information"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:Object.entries(C).map(([h,E])=>e.jsxs("div",{className:t==="dark"?"text-white/80":"text-gray-700",children:[e.jsxs("span",{className:"font-medium",children:[h,":"]})," ",e.jsx("span",{children:typeof E=="object"?JSON.stringify(E):E})]},h))})]})]}),s==="adduser"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:`text-xl font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Tambah User Baru"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Person SN (Employee ID) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:k.personSn,onChange:h=>g({...k,personSn:h.target.value}),placeholder:"EMP001",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Nama Lengkap ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:k.name,onChange:h=>g({...k,name:h.target.value}),placeholder:"Nama Karyawan",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Gender"}),e.jsxs("select",{value:k.gender,onChange:h=>g({...k,gender:h.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"",children:"Pilih Gender"}),e.jsx("option",{value:"1",children:"Male"}),e.jsx("option",{value:"2",children:"Female"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Nomor HP"}),e.jsx("input",{type:"text",value:k.phone,onChange:h=>g({...k,phone:h.target.value}),placeholder:"08123456789",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Departemen"}),e.jsx("input",{type:"text",value:k.deptName,onChange:h=>g({...k,deptName:h.target.value}),placeholder:"IT Department",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"ID Number (KTP)"}),e.jsx("input",{type:"text",value:k.idNumber,onChange:h=>g({...k,idNumber:h.target.value}),placeholder:"1234567890123456",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"PIN Device"}),e.jsx("input",{type:"text",value:k.password,onChange:h=>g({...k,password:h.target.value}),placeholder:"123456",maxLength:6,className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]})]}),e.jsx("button",{onClick:$,disabled:n,className:"w-full md:w-auto px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:n?"Menambahkan...":" Tambah User ke Device"})]}),s==="biometric"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:`text-xl font-semibold mb-4 ${t==="dark"?"text-white":"text-gray-900"}`,children:"Register Biometric (Face / Palm / Card)"}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Tipe Biometric ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:[{value:"face",label:"Face",icon:""},{value:"palm",label:"Palm",icon:""},{value:"card",label:"Card",icon:""}].map(h=>e.jsxs("button",{onClick:()=>H({...u,bioType:h.value,feature:"",image:null,imagePreview:null}),className:`px-4 py-3 rounded-lg border-2 transition-all flex flex-col items-center gap-2 ${u.bioType===h.value?"border-purple-500 bg-purple-500/10":t==="dark"?"border-white/20 hover:border-white/40":"border-gray-300 hover:border-gray-400"}`,children:[e.jsx("span",{className:"text-2xl",children:h.icon}),e.jsx("span",{className:`font-medium ${t==="dark"?"text-white":"text-gray-900"}`,children:h.label})]},h.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Pilih User ",e.jsx("span",{className:"text-red-500",children:"*"})]}),B?e.jsx("div",{className:`px-4 py-3 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"}`,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"animate-spin"}),e.jsx("span",{children:"Memuat daftar user..."})]})}):f.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("select",{value:u.personSn,onChange:h=>H({...u,personSn:h.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"",children:"-- Pilih User --"}),f.map(h=>{const E=h.personSn||h.sn,z=`${E} - ${h.name||"No Name"}`;return e.jsx("option",{value:E,children:z},E)})]}),e.jsxs("p",{className:`text-xs mt-1 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:[u.bioType==="face"&&e.jsxs(e.Fragment,{children:[" Menampilkan ",f.length," user yang belum memiliki Face ID"]}),u.bioType==="palm"&&e.jsxs(e.Fragment,{children:[" Menampilkan ",f.length," user yang belum memiliki Palm data"]}),u.bioType==="card"&&e.jsxs(e.Fragment,{children:[" Menampilkan ",f.length," user untuk registrasi Card"]})]})]}):e.jsxs("div",{className:`px-4 py-3 rounded-lg border ${t==="dark"?"bg-orange-500/10 border-orange-500/30":"bg-orange-50 border-orange-200"}`,children:[e.jsxs("p",{className:`text-sm ${t==="dark"?"text-orange-300":"text-orange-800"}`,children:[u.bioType==="face"&&e.jsx(e.Fragment,{children:" Semua user sudah memiliki Face ID. Tidak ada user yang perlu didaftarkan."}),u.bioType==="palm"&&e.jsx(e.Fragment,{children:" Semua user sudah memiliki Palm data. Tidak ada user yang perlu didaftarkan."}),u.bioType==="card"&&e.jsx(e.Fragment,{children:' Tidak ada user tersedia. Tambahkan user terlebih dahulu di tab "Add User".'})]}),e.jsx("button",{onClick:Y,className:`mt-2 px-3 py-1 rounded text-xs font-medium ${t==="dark"?"bg-orange-500/20 hover:bg-orange-500/30 text-orange-300":"bg-orange-100 hover:bg-orange-200 text-orange-800"}`,children:" Refresh Daftar User"})]})]}),(u.bioType==="face"||u.bioType==="palm")&&e.jsxs(e.Fragment,{children:[u.bioType==="palm"&&e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Tangan"}),e.jsxs("select",{value:u.palmNum,onChange:h=>H({...u,palmNum:h.target.value}),className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"1",children:" Kiri (Left)"}),e.jsx("option",{value:"2",children:" Kanan (Right)"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Upload ",u.bioType==="face"?"Foto Wajah":"Foto Telapak Tangan"]}),e.jsx("input",{type:"file",accept:"image/*",onChange:p,className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`}),u.imagePreview&&e.jsx("div",{className:"mt-3",children:e.jsx("img",{src:u.imagePreview,alt:"Preview",className:"max-w-xs rounded-lg border"})})]}),e.jsx("div",{className:`text-center ${t==="dark"?"text-white/60":"text-gray-500"}`,children:e.jsx("span",{children:"  ATAU  "})}),e.jsxs("div",{children:[e.jsx("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:"Feature String"}),e.jsx("textarea",{value:u.feature,onChange:h=>H({...u,feature:h.target.value}),placeholder:"Rk1SACAyMAAAAAF6AAAA/AFEAMUAxQ...",rows:4,className:`w-full px-4 py-2 rounded-lg border font-mono text-sm ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]})]}),u.bioType==="card"&&e.jsxs("div",{children:[e.jsxs("label",{className:`block text-sm font-medium mb-2 ${t==="dark"?"text-white":"text-gray-700"}`,children:["Nomor Kartu ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:u.cardNumber,onChange:h=>H({...u,cardNumber:h.target.value}),placeholder:"1234567890",className:`w-full px-4 py-2 rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`})]}),e.jsx("button",{onClick:X,disabled:n,className:"w-full md:w-auto px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:n?"Mendaftarkan...":` Register ${u.bioType==="face"?"Face":u.bioType==="palm"?"Palm":"Card"}`})]}),s==="users"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:`text-xl font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Daftar User di Device"}),e.jsxs("button",{onClick:oe,disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center gap-2",children:[e.jsx(Xe,{}),"Refresh"]})]}),S.length>0?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:`min-w-full divide-y ${t==="dark"?"divide-white/10 text-white":"divide-gray-200 text-gray-900"}`,children:[e.jsx("thead",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Person SN"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Nama"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Gender"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Phone"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Dept"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold",children:"Actions"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-white/5":"divide-gray-100"}`,children:S.map((h,E)=>{const z=h.sn||h.personSn;return e.jsxs("tr",{className:t==="dark"?"hover:bg-white/5":"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:z||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:h.name||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:h.gender===1?"Male":h.gender===2?"Female":"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:h.mobile||h.phone||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:h.deptName||"-"}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("button",{onClick:()=>F(z),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors text-xs",children:"Hapus"})})]},z||E)})})]}),e.jsxs("div",{className:`mt-3 text-sm ${t==="dark"?"text-white/60":"text-gray-600"}`,children:["Total: ",S.length," users"]})]}):e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:n?"Memuat data...":"Tidak ada data user. Klik Refresh untuk memuat data."})]}),s==="log"&&e.jsxs("div",{className:"space-y-3 md:space-y-4",children:[e.jsxs("div",{className:`p-3 md:p-4 rounded-lg border ${t==="dark"?"bg-blue-500/10 border-blue-500/30":"bg-blue-50 border-blue-200"}`,children:[e.jsx("h4",{className:`text-sm md:text-base font-semibold mb-2 ${t==="dark"?"text-blue-300":"text-blue-900"}`,children:" Real-time Biometric Scan Logs"}),e.jsx("p",{className:`text-xs md:text-sm ${t==="dark"?"text-blue-200/80":"text-blue-800"}`,children:"Data log scan biometrik yang diterima dari device secara real-time. Auto-refresh setiap 5 detik."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("h3",{className:`text-base md:text-lg font-semibold ${t==="dark"?"text-white":"text-gray-900"}`,children:"Log Scan Biometrik (Real-time)"}),v&&s==="log"&&e.jsxs("div",{className:"flex items-center gap-2 px-2 py-1 rounded-full bg-green-100 border border-green-300",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Auto-refresh ON"})]})]}),e.jsxs("p",{className:`text-xs ${t==="dark"?"text-white/60":"text-gray-500"}`,children:["Data log scan yang diterima langsung dari device.",Q&&e.jsxs("span",{className:"ml-1",children:["Last updated: ",Q.toLocaleTimeString("id-ID")]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:I,onChange:h=>W(parseInt(h.target.value)),className:`px-2 py-2 text-xs rounded-lg border ${t==="dark"?"bg-[#1a2440] border-white/20 text-white":"bg-white border-gray-300 text-gray-900"} focus:outline-none focus:ring-2 focus:ring-purple-500`,children:[e.jsx("option",{value:"3000",children:"3s"}),e.jsx("option",{value:"5000",children:"5s"}),e.jsx("option",{value:"10000",children:"10s"}),e.jsx("option",{value:"30000",children:"30s"}),e.jsx("option",{value:"60000",children:"60s"})]}),e.jsx("button",{onClick:()=>w(!v),className:`px-3 py-2 rounded-lg transition-colors flex items-center gap-2 text-xs font-medium ${v?"bg-green-600 hover:bg-green-700 text-white":t==="dark"?"bg-gray-600 hover:bg-gray-700 text-white":"bg-gray-300 hover:bg-gray-400 text-gray-900"}`,children:v?" Auto":" Manual"}),e.jsxs("button",{onClick:()=>T(!1),disabled:n,className:"px-3 md:px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 flex items-center gap-2 text-sm md:text-base",children:[e.jsx(Xe,{className:n?"animate-spin":""}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]})]})]}),c.length>0?e.jsxs("div",{className:"overflow-x-auto -mx-4 md:mx-0",children:[e.jsx("div",{className:"inline-block min-w-full align-middle",children:e.jsxs("table",{className:`min-w-full divide-y ${t==="dark"?"divide-white/10 text-white":"divide-gray-200 text-gray-900"}`,children:[e.jsx("thead",{className:t==="dark"?"bg-white/5":"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Waktu Scan"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Person SN"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold",children:"Nama"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold hidden sm:table-cell",children:"Metode"}),e.jsx("th",{className:"px-3 md:px-4 py-2 md:py-3 text-left text-xs md:text-sm font-semibold hidden md:table-cell",children:"Status"})]})}),e.jsx("tbody",{className:`divide-y ${t==="dark"?"divide-white/5":"divide-gray-100"}`,children:c.map((h,E)=>{let z="-",Z="";h.faceFlag===1?(z="Face",Z=""):h.palmFlag===1?(z="Palm",Z=""):h.cardFlag===1?(z="Card",Z=""):h.fingerFlag===1&&(z="Finger",Z="");let ne="-",re="bg-gray-100 text-gray-800",V="";h.resultFlag===1?(ne="Success",re="bg-green-100 text-green-800",V=""):h.resultFlag===2?(ne="Failed",re="bg-red-100 text-red-800",V=""):h.resultFlag===3&&(ne="No Permission",re="bg-yellow-100 text-yellow-800",V=""),h.strangerFlag===1&&(ne="Stranger",re="bg-orange-100 text-orange-800",V="");const me=h.recordTimeTs?new Date(h.recordTimeTs).toLocaleString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):h.recordTime?new Date(parseInt(h.recordTime)).toLocaleString("id-ID",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-";return e.jsxs("tr",{className:t==="dark"?"hover:bg-white/5":"hover:bg-gray-50",children:[e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm whitespace-nowrap",children:me}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm whitespace-nowrap font-medium",children:h.personSn||"-"}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm",children:h.personName||"-"}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm hidden sm:table-cell",children:e.jsxs("span",{className:"flex items-center gap-1",children:[Z," ",z]})}),e.jsx("td",{className:"px-3 md:px-4 py-2 md:py-3 text-sm hidden md:table-cell",children:e.jsxs("span",{className:`px-2 py-1 rounded text-xs flex items-center gap-1 w-fit ${re}`,children:[V," ",ne]})})]},h.id||E)})})]})}),e.jsxs("div",{className:`mt-3 text-sm ${t==="dark"?"text-white/60":"text-gray-600"}`,children:["Total: ",c.length," records"]})]}):e.jsx("div",{className:`text-center py-8 ${t==="dark"?"text-white/60":"text-gray-500"}`,children:n?"Memuat data...":e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-lg",children:" Tidak ada data log scan."}),e.jsx("p",{className:"text-xs",children:"Data scan akan muncul otomatis saat user melakukan scan di device."}),e.jsxs("p",{className:"text-xs",children:["Device: ",e.jsx("code",{className:`px-2 py-1 rounded ${t==="dark"?"bg-white/10":"bg-gray-100"}`,children:r.deviceIP})]})]})})]})]})]})})}function Xn({children:t}){const[r,s]=d.useState(!0),[i,n]=d.useState(!1);return d.useEffect(()=>{async function a(){const l=localStorage.getItem("token");if(!l){localStorage.removeItem("user"),n(!1),s(!1);return}try{const m=await R.get(`${U}/api/users/me`,{headers:{Authorization:`Bearer ${l}`}});m.data?(localStorage.setItem("user",JSON.stringify(m.data)),n(!0)):(localStorage.removeItem("token"),localStorage.removeItem("user"),n(!1))}catch(m){console.error("Token validation failed:",m),localStorage.removeItem("token"),localStorage.removeItem("user"),n(!1)}finally{s(!1)}}a()},[]),r?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Memvalidasi sesi..."})]})}):i?t:e.jsx(br,{to:"/login",replace:!0})}function Zn(){return e.jsx(_s,{children:e.jsxs(da,{children:[e.jsx(fe,{path:"/login",element:e.jsx(Ys,{})}),e.jsxs(fe,{path:"/",element:e.jsx(Xn,{children:e.jsx(kn,{})}),children:[e.jsx(fe,{index:!0,element:e.jsx(ln,{})}),e.jsx(fe,{path:"attendance",element:e.jsx(dn,{})}),e.jsx(fe,{path:"leave",element:e.jsx(vn,{})}),e.jsx(fe,{path:"daily-report",element:e.jsx(Un,{})}),e.jsx(fe,{path:"settings",element:e.jsx(wn,{})}),e.jsx(fe,{path:"reports",element:e.jsx(Nn,{})}),e.jsx(fe,{path:"payroll",element:e.jsx($n,{})}),e.jsx(fe,{path:"performance",element:e.jsx(On,{})}),e.jsx(fe,{path:"calendar",element:e.jsx(Sn,{})}),e.jsx(fe,{path:"notifications",element:e.jsx(In,{})}),e.jsx(fe,{path:"profile",element:e.jsx(zn,{})}),e.jsx(fe,{path:"admin/attendance",element:e.jsx(Cn,{})}),e.jsx(fe,{path:"admin/leave",element:e.jsx(An,{})}),e.jsx(fe,{path:"admin/attendance-requests",element:e.jsx(Dn,{})}),e.jsx(fe,{path:"admin/daily-report",element:e.jsx(Tn,{})}),e.jsx(fe,{path:"admin/daily-report-edit-requests",element:e.jsx(En,{})}),e.jsx(fe,{path:"admin/users",element:e.jsx(xn,{})}),e.jsx(fe,{path:"admin/payroll",element:e.jsx(Bn,{})}),e.jsx(fe,{path:"admin/performance",element:e.jsx(Fn,{})}),e.jsx(fe,{path:"admin/biometric",element:e.jsx(Yn,{})}),e.jsx(fe,{path:"admin/device",element:e.jsx(Hn,{})}),e.jsx(fe,{path:"admin/device2",element:e.jsx(Vn,{})})]}),e.jsx(fe,{path:"*",element:e.jsx(br,{to:"/login",replace:!0})})]})})}const ei=d.createContext(),ti=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ri=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),ai=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),si=()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),ni=()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})});function ii({toast:t,onClose:r}){const[s,i]=d.useState(!1);d.useEffect(()=>{setTimeout(()=>i(!0),10);const l=setTimeout(()=>{i(!1),setTimeout(()=>r(),300)},4e3);return()=>clearTimeout(l)},[r]);const a=(()=>{switch(t.type){case"success":return{bg:"bg-green-50 border-green-200",icon:e.jsx(ti,{className:"text-green-600"}),titleColor:"text-green-800",messageColor:"text-green-700"};case"error":return{bg:"bg-red-50 border-red-200",icon:e.jsx(ri,{className:"text-red-600"}),titleColor:"text-red-800",messageColor:"text-red-700"};case"warning":return{bg:"bg-yellow-50 border-yellow-200",icon:e.jsx(si,{className:"text-yellow-600"}),titleColor:"text-yellow-800",messageColor:"text-yellow-700"};default:return{bg:"bg-blue-50 border-blue-200",icon:e.jsx(ai,{className:"text-blue-600"}),titleColor:"text-blue-800",messageColor:"text-blue-700"}}})();return e.jsx("div",{className:`${a.bg} border rounded-xl shadow-lg p-4 min-w-[320px] max-w-md backdrop-blur-sm transform transition-all duration-300 ${s?"translate-x-0 opacity-100":"translate-x-full opacity-0"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.icon}),e.jsxs("div",{className:"flex-1 min-w-0",children:[t.title&&e.jsx("div",{className:`font-semibold text-sm ${a.titleColor} mb-1`,children:t.title}),e.jsx("div",{className:`text-sm ${a.messageColor}`,children:t.message})]}),e.jsx("button",{onClick:()=>{i(!1),setTimeout(()=>r(),300)},className:`flex-shrink-0 p-1 rounded-lg hover:bg-black/5 transition-colors ${a.messageColor}`,children:e.jsx(ni,{})})]})})}function oi({children:t}){const[r,s]=d.useState([]);function i(a){const m={id:Date.now()+Math.random(),type:"info",...a};s(C=>[...C,m])}function n(a){s(l=>l.filter(m=>m.id!==a))}return e.jsxs(ei.Provider,{value:{push:i},children:[t,e.jsx("div",{className:"fixed right-4 bottom-4 space-y-3 z-[100] pointer-events-none",children:r.map(a=>e.jsx("div",{className:"pointer-events-auto",children:e.jsx(ii,{toast:a,onClose:()=>n(a.id)})},a.id))})]})}kr(document.getElementById("root")).render(e.jsx(dt.StrictMode,{children:e.jsx(ca,{children:e.jsx(oi,{children:e.jsx(Zn,{})})})}));
